function visibleResume(){muted||manualPause||Howler.unmute()}function visiblePause(){Howler.mute()}function initSplash(){gameState="splash",com.funtomic.GameOps.KiziAPI_preloaderEnded(),resizeCanvas(),1!=audioType||muted||music.play(),1==audioType&&(musicTween&&musicTween.kill(),musicTween=TweenLite.to(music,1,{volume:.75,ease:"Linear.easeNone"})),userInput.addHitArea("mute",butEventHandler,null,"rect",{aRect:[640,0,canvas.width,58]},!0),oUserCareerData=saveDataHandler.getCareerData(),aUserGarageData=saveDataHandler.getGarageData(),aPinDisplay=saveDataHandler.getPinData(),pinPage=Math.floor(aPinDisplay.length/pinsPerMap-.1),oPrevCareerData={careerStage:aPinDisplay[0].careerStage,careerRace:aPinDisplay[0].careerRace,posId:aPinDisplay[0].posId},curShopCarId=Math.min(aCarBaseData.length-1,oUserCareerData.curCarId+1);for(var a=0;a<aPinDisplay.length;a++)if(aPinDisplay[a].selected){curPinSelectedId=aPinDisplay[a].posId;break}firstNitroStage=0;for(var a=0;a<aUserGarageData.length;a++)aUserGarageData[a].nitroUpgrade>0&&(firstNitroStage=2);initRaceSelect()}function initCreditsScreen(){gameState="credits";var a={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut},b={oImgData:assetLib.getData("uiButs"),aPos:[95,40],id:oImageIds.clearDataBut,noMove:!0};userInput.addHitArea("backFromCredits",butEventHandler,null,"image",a),userInput.addHitArea("clearData",butEventHandler,null,"image",b);var c=new Array(a,b);panel=new Elements.Panel(gameState,c),panel.startTween2(),previousTime=(new Date).getTime(),updateCreditsScreenEvent()}function initStats(){gameState="stats",background=new Elements.Background("raceSelectBg"),background.renderState="none";var a={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut},b={oImgData:assetLib.getData("uiButs"),aPos:[95,40],id:oImageIds.clearDataBut,noMove:!0};userInput.addHitArea("backFromStats",butEventHandler,null,"image",a),userInput.addHitArea("clearData",butEventHandler,null,"image",b);var c=new Array(a,b);panel=new Elements.Panel(gameState,c),panel.startTween2(),previousTime=(new Date).getTime(),updateStatsScreenEvent()}function initRaceSelect(a){"undefined"==typeof a&&(a=!0),gameState="raceSelect",background=new Elements.Background("mapBg"),background.setMapPos(),background.renderState="map",firstRun=1==oUserCareerData.careerStage&&1==oUserCareerData.careerRace?!0:!1;var b=new Array;if(!firstRun){var c={oImgData:assetLib.getData("uiButs"),aPos:[102,414],id:oImageIds.shopBut,noMove:!0},d={oImgData:assetLib.getData("uiButs"),aPos:[273,414],id:oImageIds.upgradeBut,noMove:!0},e={oImgData:assetLib.getData("uiButs"),aPos:[445,414],id:oImageIds.garageBut,noMove:!0},f={oImgData:assetLib.getData("uiButs"),aPos:[617,414],id:oImageIds.statsBut,noMove:!0};userInput.addHitArea("gotoGarageFromRaceSelect",butEventHandler,null,"image",e),userInput.addHitArea("gotoUpgradeFromRaceSelect",butEventHandler,null,"image",d),userInput.addHitArea("gotoShopFromRaceSelect",butEventHandler,null,"image",c),userInput.addHitArea("gotoStatsFromRaceSelect",butEventHandler,null,"image",f),b.push(e,c,d,f)}if(pinPage>0){var g={oImgData:assetLib.getData("uiButs"),aPos:[32,214],id:oImageIds.leftBut,noMove:!0};userInput.addHitArea("mapLeftBut",butEventHandler,null,"image",g),b.push(g)}if(pinPage<Math.floor(aPinDisplay.length/pinsPerMap-.1)){var h={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width-32,214],id:oImageIds.rightBut,noMove:!0};userInput.addHitArea("mapRightBut",butEventHandler,null,"image",h),b.push(h)}for(var i=pinPage*pinsPerMap;pinPage*pinsPerMap+pinsPerMap>i&&!(i>=aPinDisplay.length);i++)if(aPinDisplay[i].state>0){var j=aPinDisplay[i].posId;userInput.addHitArea("pinSelect",butEventHandler,{arrayId:i,state:aPinDisplay[i].state,posId:j},"rect",{aRect:[aPinPos[j].x-26,aPinPos[j].y-45,aPinPos[j].x+26,aPinPos[j].y+20]},!1)}panel=new Elements.Panel(gameState,b),a&&panel.startTween1(),newPinPage&&(panel.newMapMessage(),newPinPage=!1,playSound("buy")),previousTime=(new Date).getTime(),updateRaceSelectEvent()}function initRacePreview(){gameState="racePreview";var a=setRaceSelectButs();userCar=new Elements.Car(!0,aUserGarageData[oUserCareerData.curCarId]),enemyCar=new Elements.Car(!1,getEnemy()),accPedalIsDown=!1,aEffects=new Array,aFireworks=new Array,panel=new Elements.Panel(gameState,a),panel.oRaceData=getRaceData(),scrollGround=new Elements.ScrollGround,swayX=0,panel.startTween1(),previousTime=(new Date).getTime(),updateRacePreviewEvent()}function setRaceSelectButs(){var a=new Array,b={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut,noMove:!0};if(userInput.addHitArea("gotoMapFromRacePreview",butEventHandler,null,"image",b),a.push(b),"career"==raceType||"prevCareer"==raceType){var c={oImgData:assetLib.getData("uiButs"),aPos:[614,380],id:oImageIds.raceBut};userInput.addHitArea("gotoRaceStart",butEventHandler,null,"image",c),userCar=new Elements.Car(!1,getEnemy()),a.push(c)}else{var d;"quickRaceEasy"==raceType?d={easy:oImageIds.easyOnBut,medium:oImageIds.mediumOffBut,hard:oImageIds.hardOffBut}:"quickRaceMedium"==raceType?d={easy:oImageIds.easyOffBut,medium:oImageIds.mediumOnBut,hard:oImageIds.hardOffBut}:"quickRaceHard"==raceType&&(d={easy:oImageIds.easyOffBut,medium:oImageIds.mediumOffBut,hard:oImageIds.hardOnBut});var c={oImgData:assetLib.getData("uiButs"),aPos:[614,380],id:oImageIds.raceBut},e={oImgData:assetLib.getData("uiButs"),aPos:[507,175],id:d.easy,noMove:!0},f={oImgData:assetLib.getData("uiButs"),aPos:[582,175],id:d.medium,noMove:!0},g={oImgData:assetLib.getData("uiButs"),aPos:[657,175],id:d.hard,noMove:!0};userInput.addHitArea("gotoRaceStart",butEventHandler,null,"image",c),userInput.addHitArea("easyQuickRace",butEventHandler,null,"image",e),userInput.addHitArea("mediumQuickRace",butEventHandler,null,"image",f),userInput.addHitArea("hardQuickRace",butEventHandler,null,"image",g),a.push(c,e,f,g)}return a}function updateMapPins(a){if("career"==raceType&&pinPage==Math.floor(aPinDisplay.length/pinsPerMap-.1)){for(var b=!0,c=pinPage*pinsPerMap;c<aPinDisplay.length;c++)1==aPinDisplay[c].state&&(aPinDisplay[c].state=2),0==aPinDisplay[c].state&&(b=!1,aPinDisplay[c].state=1),1==aPinDisplay[c].selected&&(1==oUserCareerData.careerStage&&2==oUserCareerData.careerRace?(aPinDisplay[c].state=3,aPinDisplay[c].selected=!1,aPinDisplay[c].careerStage=a.careerStage,aPinDisplay[c].careerRace=a.careerRace):(aPinDisplay[c].state=4,aPinDisplay[c].selected=!1)),2==aPinDisplay[c].state&&(b=!1);1==oUserCareerData.careerStage&&2==oUserCareerData.careerRace&&(aPinDisplay[1].selected=!0,b=!1),aPinDisplay.length/pinsPerMap<Math.ceil(aPinDisplay.length/pinsPerMap)&&(aPinDisplay.push({posId:getEmptyPinPos(),state:0,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),b=!1);for(var c=0;c<aPinDisplay.length;c++)if(2==aPinDisplay[c].state){aPinDisplay[c].selected=!0,curPinSelectedId=aPinDisplay[c].posId;break}b&&(pinPage++,aPinDisplay.push({posId:getEmptyPinPos(),state:3,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),aPinDisplay.push({posId:getEmptyPinPos(),state:1,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),aPinDisplay.push({posId:getEmptyPinPos(),state:1,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),aPinDisplay.push({posId:getEmptyPinPos(),state:1,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),aPinDisplay.push({posId:getEmptyPinPos(),state:1,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),aPinDisplay.push({posId:getEmptyPinPos(),state:0,selected:!1,careerStage:getNextPinCareerData().careerStage,careerRace:getNextPinCareerData().careerRace}),newPinPage=!0)}saveDataHandler.setPinData()}function getNextPinCareerData(){var a={careerStage:aPinDisplay[aPinDisplay.length-1].careerStage,careerRace:aPinDisplay[aPinDisplay.length-1].careerRace};return++a.careerRace>getMaxRaces(a)&&(a.careerStage++,a.careerRace=1),a}function getDifficulty(a){return Math.floor((getRating(getPrevEnemy(a))-150)/150)}function getEmptyPinPos(){for(var a=Math.floor(Math.random()*aPinPos.length),b=!1;!b;){b=!0;for(var c=pinPage*pinsPerMap;c<aPinDisplay.length;c++)if(aPinDisplay[c].posId==a){b=!1,a=Math.floor(Math.random()*aPinPos.length);break}}return a}function initRace(){if(gameState="race",videoRaceEndShown=!1,oGearChanges={perfect:0,good:0,regular:0,perfectStart:null},"career"==raceType||"prevCareer"==raceType){for(var a=oUserCareerData.careerRace,b=0;b<oUserCareerData.careerStage-1;b++)a+=getRaceNumInStage(b+1);"career"==raceType?com.funtomic.GameOps.levelStarted(a):com.funtomic.GameOps.levelStarted(0)}else com.funtomic.GameOps.levelStarted(0);1==audioType&&(musicTween.kill(),musicTween=TweenLite.to(music,.5,{volume:1,ease:"Linear.easeNone"})),playSound("engineStart"),setRaceProgress(),userInput.addHitArea("accPedal",butEventHandler,{multiTouch:!0},"rect",{aRect:[558,126,684,290]},!0),userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,60,58]},!0),scrollGround=new Elements.ScrollGround,userCar=new Elements.Car(!0,aUserGarageData[oUserCareerData.curCarId]),enemyCar=new Elements.Car(!1,getEnemy()),accPedalIsDown=!1,aEffects=new Array,aFireworks=new Array,hud=new Elements.Hud,1==oUserCareerData.careerStage&&1==oUserCareerData.careerRace&&firstRun&&(hud.pauseStartTimer=!0),previousTime=(new Date).getTime(),updateRaceEvent()}function initGarage(){gameState="garage",background=new Elements.Background("garage"),background.renderState="none",aFireworks=new Array,aUserGarageData.length>1&&userInput.addHitArea("sellCar",butEventHandler,null,"rect",{aRect:[446,215,582,278]},!0);var b,a={oImgData:assetLib.getData("uiButs"),aPos:[614,380],id:oImageIds.mapBut};b=newCarBought?{oImgData:assetLib.getData("uiButs"),aPos:[445,414],id:oImageIds.customiseBut,noMove:!1}:{oImgData:assetLib.getData("uiButs"),aPos:[445,414],id:oImageIds.customiseBut,noMove:!0};var c={oImgData:assetLib.getData("uiButs"),aPos:[273,414],id:oImageIds.upgradeBut,noMove:!0},d={oImgData:assetLib.getData("uiButs"),aPos:[102,414],id:oImageIds.shopBut,noMove:!0},e={oImgData:assetLib.getData("uiButs"),aPos:[32,245],id:oImageIds.leftBut,noMove:!0},f={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width-32,245],id:oImageIds.rightBut,noMove:!0};userInput.addHitArea("gotoRaceSelectFromGarage",butEventHandler,null,"image",a),userInput.addHitArea("gotoCustomiseFromGarage",butEventHandler,null,"image",b),userInput.addHitArea("gotoUpgradeFromGarage",butEventHandler,null,"image",c),userInput.addHitArea("gotoShopFromGarage",butEventHandler,null,"image",d),userInput.addHitArea("garageScrollLeft",butEventHandler,null,"image",e),userInput.addHitArea("garageScrollRight",butEventHandler,null,"image",f);var g=new Array(a,b,c,d,e,f);panel=new Elements.Panel(gameState,g),panel.oRaceData=getRaceData(),scrollGround=new Elements.ScrollGround,userCar=new Elements.Car(!0,aUserGarageData[oUserCareerData.curCarId]),panel.startTween1(),previousTime=(new Date).getTime(),updateGarageEvent()}function initShop(a){gameState="shop",background=new Elements.Background("garage"),background.renderState="none",aFireworks=new Array,userInput.addHitArea("shopBuy",butEventHandler,null,"rect",{aRect:[471,345,680,430]},!0);var b={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut,noMove:!0},c={oImgData:assetLib.getData("uiButs"),aPos:[32,245],id:oImageIds.leftBut,noMove:!0},d={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width-32,245],id:oImageIds.rightBut,noMove:!0};"garage"==a?userInput.addHitArea("backToGarageFromShop",butEventHandler,null,"image",b):"map"==a&&userInput.addHitArea("backToMapFromShop",butEventHandler,null,"image",b),userInput.addHitArea("shopScrollLeft",butEventHandler,null,"image",c),userInput.addHitArea("shopScrollRight",butEventHandler,null,"image",d);var e=new Array(b,c,d);userCar=new Elements.Car(!0,aCarBaseData[curShopCarId]),panel=new Elements.Panel(gameState,e),panel.oRaceData=getRaceData(),scrollGround=new Elements.ScrollGround,panel.startTween1(),previousTime=(new Date).getTime(),updateShopEvent()}function initUpgrade(a){gameState="upgrade",updateVideoStatus(),background=new Elements.Background("garage"),background.renderState="none",aFireworks=new Array,userInput.addHitArea("upgradeBuy",butEventHandler,null,"rect",{aRect:[471,345,680,430]},!0),userInput.addHitArea("autoUpgradeBuy",butEventHandler,null,"rect",{aRect:[272,367,429,433]},!0),userInput.addHitArea("engineTab",butEventHandler,null,"rect",{aRect:[24,66,154,125]},!0),userInput.addHitArea("accTab",butEventHandler,null,"rect",{aRect:[155,66,283,125]},!0),userInput.addHitArea("wheelsTab",butEventHandler,null,"rect",{aRect:[284,66,414,125]},!0),userInput.addHitArea("weightTab",butEventHandler,null,"rect",{aRect:[415,66,545,125]},!0),userInput.addHitArea("nitroTab",butEventHandler,null,"rect",{aRect:[546,66,679,125]},!0);var b={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut,noMove:!0};"garage"==a?userInput.addHitArea("backToGarageFromUpgrade",butEventHandler,null,"image",b):"map"==a&&userInput.addHitArea("backToMapFromUpgrade",butEventHandler,null,"image",b);var c=new Array(b);changeUpgradeTab(upgradeTab),panel=new Elements.Panel(gameState,c),panel.oRaceData=getRaceData(),panel.startTween1(),previousTime=(new Date).getTime(),updateUpgradeEvent()}function initCustomise(){gameState="customise",updateVideoStatus(),background=new Elements.Background("garage"),background.renderState="none",userInput.addHitArea("colourTab",butEventHandler,null,"rect",{aRect:[150,69,282,123]},!0),userInput.addHitArea("rimsTab",butEventHandler,null,"rect",{aRect:[283,69,417,123]},!0),userInput.addHitArea("shadowTab",butEventHandler,null,"rect",{aRect:[418,69,552,123]},!0),userInput.addHitArea("customiseSelect",butEventHandler,{id:0},"rect",{aRect:[81,141,156,216]},!1),userInput.addHitArea("customiseSelect",butEventHandler,{id:1},"rect",{aRect:[176,141,251,216]},!1),userInput.addHitArea("customiseSelect",butEventHandler,{id:2},"rect",{aRect:[269,141,348,216]},!1),userInput.addHitArea("customiseSelect",butEventHandler,{id:3},"rect",{aRect:[363,141,440,216]},!1),userInput.addHitArea("customiseSelect",butEventHandler,{id:4},"rect",{aRect:[452,141,531,216]},!1),userInput.addHitArea("customiseSelect",butEventHandler,{id:5},"rect",{aRect:[545,141,623,216]},!1),userInput.addHitArea("customiseBuy",butEventHandler,null,"rect",{aRect:[471,345,680,430]},!0);var a={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.backBut,noMove:!0},b={oImgData:assetLib.getData("uiButs"),aPos:[32,180],id:oImageIds.leftBut,noMove:!0},c={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width-32,180],id:oImageIds.rightBut,noMove:!0};userInput.addHitArea("backToGarageFromCustomise",butEventHandler,null,"image",a),userInput.addHitArea("customiseScrollLeft",butEventHandler,null,"image",b),userInput.addHitArea("customiseScrollRight",butEventHandler,null,"image",c);var d=new Array(a,b,c);oCustomiseSaveData={colour:aUserGarageData[oUserCareerData.curCarId].colour,rims:aUserGarageData[oUserCareerData.curCarId].rims,shadow:aUserGarageData[oUserCareerData.curCarId].shadow},changeCustomiseTab(customiseTab),scrollGround=new Elements.ScrollGround,userCar=new Elements.Car(!0,aUserGarageData[oUserCareerData.curCarId]),panel=new Elements.Panel(gameState,d),panel.oRaceData=getRaceData(),panel.startTween1(),previousTime=(new Date).getTime(),updateCustomiseEvent()}function initRaceComplete(){var a=getRaceData();updateVideoStatus();var b,c;if("career"==raceType||"prevCareer"==raceType){var d=oUserCareerData.careerRace;b="career";for(var e=0;e<oUserCareerData.careerStage-1;e++)d+=getRaceNumInStage(e+1);c="career"==raceType?d:0}else b="quick",c=0;1==audioType&&(musicTween.kill(),musicTween=TweenLite.to(music,1,{volume:.75,ease:"Linear.easeNone"}));var f=oRaceProgress.enemyFinishTime-oRaceProgress.userFinishTime;firstRun=!1,oRaceProgress.userNitroBoost=0,1==firstNitroStage&&(firstNitroStage=2),f>=0&&(25>f?oRaceProgress.timeBonus=Math.round(oRaceProgress.reward/10):50>f?oRaceProgress.timeBonus=Math.round(oRaceProgress.reward/7):100>f?oRaceProgress.timeBonus=Math.round(oRaceProgress.reward/5):200>f?oRaceProgress.timeBonus=Math.round(oRaceProgress.reward/3):oRaceProgress.timeBonus=Math.round(oRaceProgress.reward/2));var g;if(oRaceProgress.userFinishTime>oRaceProgress.enemyFinishTime)g=!1,oRaceProgress.reward=Math.round(oRaceProgress.reward/4);else{g=!0;var h={careerRace:oUserCareerData.careerRace,careerStage:oUserCareerData.careerStage};"career"==raceType?(++oUserCareerData.careerRace>getMaxRaces()&&(oUserCareerData.careerStage++,oUserCareerData.careerRace=1),updateMapPins(h)):"prevCareer"==raceType&&updateMapPins(h),oUserCareerData.racesWon++}oUserCareerData.totalDistance+=1e3*oRaceProgress.raceLength,oRaceProgress.totalReward=Math.round((oRaceProgress.reward+oRaceProgress.timeBonus+getCutomBonus()+50*Math.floor(oUserCareerData.levelNum/100))*oRaceProgress.startMultiplier*oRaceProgress.gearShiftMultiplier),oUserCareerData.cash+=oRaceProgress.totalReward,oUserCareerData.totalWinnings+=oRaceProgress.totalReward;var i=oUserCareerData.levelNum;oUserCareerData.levelNum=Math.round(oUserCareerData.levelNum+oRaceProgress.totalReward/12/Math.floor(oUserCareerData.levelNum/100)),Math.floor(oUserCareerData.levelNum/100)>Math.floor(i/100)&&(oRaceProgress.newLevel=!0),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),com.funtomic.GameOps.levelEnded(c,g);var j={user_level:Math.floor(oUserCareerData.levelNum/100),stage:c,reward:oRaceProgress.totalReward,race_rating:a.rating,distance:a.distance,won:g,gear_regular:oGearChanges.regular,gear_good:oGearChanges.good,gear_perfect:oGearChanges.perfect,time:Math.round(oRaceProgress.userFinishTime),great_start:oGearChanges.perfectStart,race_type:b,car_level:oUserCareerData.curCarId+1};com.funtomic.GameOps.reportEvent("race_end",j),initRaceCompleteDisplay()}function initRaceCompleteDisplay(){gameState="raceComplete",userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userInput.removeHitArea("pause"),background=new Elements.Background("raceSelectBg"),background.renderState="none";var a;a=1==oUserCareerData.careerRace&&1==oUserCareerData.careerStage?{oImgData:assetLib.getData("uiButs"),aPos:[614,380],id:oImageIds.raceBut,noMove:!1}:{oImgData:assetLib.getData("uiButs"),aPos:[614,380],id:oImageIds.mapBut,noMove:!1};var b,c=new Array(a);userInput.addHitArea("gotoRaceSelectFromComplete",butEventHandler,null,"image",a),shouldShowUpgradeTip()?(a.noMove=!0,b={oImgData:assetLib.getData("uiButs"),aPos:[442,414],id:oImageIds.upgradeBut,noMove:!1},userInput.addHitArea("gotoUpgradeFromComplete",butEventHandler,null,"image",b),c.push(b)):(1!=oUserCareerData.careerRace&&2!=oUserCareerData.careerRace||1!=oUserCareerData.careerStage)&&(b={oImgData:assetLib.getData("uiButs"),aPos:[102,414],id:oImageIds.garageBut,noMove:!0},userInput.addHitArea("gotoGarageFromComplete",butEventHandler,null,"image",b),c.push(b)),canShowRaceEndVideoBonusPrompt()&&userInput.addHitArea("raceEndVideoChosen",butEventHandler,null,"rect",{aRect:[370,234,554,323]},!0),changeUpgradeTab(upgradeTab),panel=new Elements.Panel(gameState,c),panel.oRaceData=getRaceData(),panel.startTween1(),previousTime=(new Date).getTime(),updateRaceCompleteEvent()}function butEventHandler(a,b){switch(firstTouchAfterLoading&&(firstTouchAfterLoading=!1),a){case"langSelect":curLang=b.lang,ctx.clearRect(0,0,canvas.width,canvas.height),userInput.removeHitArea("langSelect"),preAssetLib=new Utils.AssetLoader(curLang,[{id:"preloadImage",file:"images/"+curLang+"/preloadImage.jpg"}],ctx,canvas.width,canvas.height,!1),preAssetLib.onReady(initLoadAssets);break;case"credits":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromStart"),userInput.removeHitArea("moreGames"),userInput.removeHitArea("credits"),userInput.removeHitArea("gotoGarageFromStart"),initCreditsScreen();break;case"clearData":playSound("click"),saveDataHandler.resetData(),oUserCareerData=saveDataHandler.getCareerData(),aUserGarageData=saveDataHandler.getGarageData(),aPinDisplay=saveDataHandler.getPinData(),pinPage=Math.floor(aPinDisplay.length/pinsPerMap-.1),oPrevCareerData={careerStage:aPinDisplay[0].careerStage,careerRace:aPinDisplay[0].careerRace,posId:aPinDisplay[0].posId},userInput.removeHitArea("clearData"),userInput.removeHitArea("backFromStats"),initRaceSelect();break;case"backFromStats":playSound("click"),userInput.removeHitArea("backFromStats"),userInput.removeHitArea("clearData"),initRaceSelect();break;case"moreGames":case"moreGamesPause":playSound("click");break;case"sellCar":playSound("buy"),oUserCareerData.cash+=getSellCost();var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1,reward:getSellCost()};com.funtomic.GameOps.reportEvent("sell_car",c),aUserGarageData.splice(oUserCareerData.curCarId,1),oUserCareerData.curCarId=aUserGarageData.length-1,saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),userInput.removeHitArea("gotoRaceSelectFromGarage"),userInput.removeHitArea("gotoCustomiseFromGarage"),userInput.removeHitArea("gotoUpgradeFromGarage"),userInput.removeHitArea("gotoShopFromGarage"),userInput.removeHitArea("sellCar"),userInput.removeHitArea("garageScrollLeft"),userInput.removeHitArea("garageScrollRight"),newCarBought=!1,initGarage();for(var d=0;3>d;d++)addFirework(100*Math.random()+480,50*Math.random()+215,.5*Math.random()+1);break;case"gotoGarageFromStart":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromStart"),userInput.removeHitArea("moreGames"),userInput.removeHitArea("credits"),userInput.removeHitArea("gotoGarageFromStart"),initGarage();break;case"gotoRaceSelectFromStart":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromStart"),userInput.removeHitArea("moreGames"),userInput.removeHitArea("credits"),userInput.removeHitArea("gotoGarageFromStart"),initRaceSelect();break;case"doNothing":break;case"pinSelect":playSound("click"),userInput.removeHitArea("pinSelect"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("gotoGarageFromRaceSelect"),userInput.removeHitArea("gotoUpgradeFromRaceSelect"),userInput.removeHitArea("gotoShopFromRaceSelect"),userInput.removeHitArea("gotoStatsFromRaceSelect"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),curPinSelectedId=b.posId;for(var d=0;d<aPinDisplay.length;d++)aPinDisplay[d].selected=!1;aPinDisplay[b.arrayId].selected=!0,1==b.state||2==b.state?(raceType="career",oPrevCareerData={careerStage:aPinDisplay[b.arrayId].careerStage,careerRace:aPinDisplay[b.arrayId].careerRace,posId:aPinDisplay[b.arrayId].posId}):4==b.state?(raceType="prevCareer",oPrevCareerData={careerStage:aPinDisplay[b.arrayId].careerStage,careerRace:aPinDisplay[b.arrayId].careerRace,posId:aPinDisplay[b.arrayId].posId}):3==b.state&&(raceType=getUpgradeTotal()<3?"quickRaceEasy":getUpgradeTotal()<19?"quickRaceMedium":"quickRaceHard"),panel.oRaceData=getRaceData(),panel.aButs=setRaceSelectButs(),panel.panelType=gameState,initRacePreview();break;case"gotoMapFromRacePreview":playSound("click"),userInput.removeHitArea("gotoMapFromRacePreview"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initRaceSelect();break;case"easyQuickRace":if("quickRaceEasy"==raceType)return;playSound("click"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),raceType="quickRaceEasy",panel.oRaceData=getRaceData(),panel.aButs=setRaceSelectButs(),panel.panelType=gameState;break;case"mediumQuickRace":if("quickRaceMedium"==raceType)return;playSound("click"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),raceType="quickRaceMedium",panel.oRaceData=getRaceData(),panel.aButs=setRaceSelectButs(),panel.panelType=gameState;break;case"hardQuickRace":if("quickRaceHard"==raceType)return;playSound("click"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),raceType="quickRaceHard",panel.oRaceData=getRaceData(),panel.aButs=setRaceSelectButs(),panel.panelType=gameState;break;case"gotoRaceStart":playSound("click"),userInput.removeHitArea("gotoMapFromRacePreview"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initRace();break;case"gotoGarageFromRaceSelect":playSound("click"),userInput.removeHitArea("pinSelect"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("gotoGarageFromRaceSelect"),userInput.removeHitArea("gotoUpgradeFromRaceSelect"),userInput.removeHitArea("gotoShopFromRaceSelect"),userInput.removeHitArea("gotoStatsFromRaceSelect"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initGarage();break;case"gotoStatsFromRaceSelect":playSound("click"),userInput.removeHitArea("pinSelect"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("gotoGarageFromRaceSelect"),userInput.removeHitArea("gotoUpgradeFromRaceSelect"),userInput.removeHitArea("gotoShopFromRaceSelect"),userInput.removeHitArea("gotoStatsFromRaceSelect"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initStats();break;case"gotoUpgradeFromRaceSelect":playSound("click"),userInput.removeHitArea("pinSelect"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("gotoGarageFromRaceSelect"),userInput.removeHitArea("gotoUpgradeFromRaceSelect"),userInput.removeHitArea("gotoShopFromRaceSelect"),userInput.removeHitArea("gotoStatsFromRaceSelect"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initUpgrade("map");break;case"gotoShopFromRaceSelect":playSound("click"),userInput.removeHitArea("pinSelect"),userInput.removeHitArea("gotoRaceStart"),userInput.removeHitArea("gotoGarageFromRaceSelect"),userInput.removeHitArea("gotoUpgradeFromRaceSelect"),userInput.removeHitArea("gotoShopFromRaceSelect"),userInput.removeHitArea("gotoStatsFromRaceSelect"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("easyQuickRace"),userInput.removeHitArea("mediumQuickRace"),userInput.removeHitArea("hardQuickRace"),initShop("map");break;case"mapLeftBut":playSound("click"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("pinSelect"),pinPage--,initRaceSelect(!1);break;case"mapRightBut":playSound("click"),userInput.removeHitArea("mapLeftBut"),userInput.removeHitArea("mapRightBut"),userInput.removeHitArea("pinSelect"),pinPage++,initRaceSelect(!1);break;case"gotoRaceSelectFromGarage":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromGarage"),userInput.removeHitArea("gotoCustomiseFromGarage"),userInput.removeHitArea("gotoUpgradeFromGarage"),userInput.removeHitArea("gotoShopFromGarage"),userInput.removeHitArea("sellCar"),newCarBought=!1,userInput.removeHitArea("garageScrollLeft"),userInput.removeHitArea("garageScrollRight"),initRaceSelect();break;case"gotoCustomiseFromGarage":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromGarage"),userInput.removeHitArea("gotoCustomiseFromGarage"),userInput.removeHitArea("gotoUpgradeFromGarage"),userInput.removeHitArea("gotoShopFromGarage"),userInput.removeHitArea("sellCar"),newCarBought=!1,userInput.removeHitArea("garageScrollLeft"),userInput.removeHitArea("garageScrollRight"),initCustomise();break;case"gotoUpgradeFromGarage":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromGarage"),userInput.removeHitArea("gotoCustomiseFromGarage"),userInput.removeHitArea("gotoUpgradeFromGarage"),userInput.removeHitArea("gotoShopFromGarage"),userInput.removeHitArea("sellCar"),newCarBought=!1,userInput.removeHitArea("garageScrollLeft"),userInput.removeHitArea("garageScrollRight"),initUpgrade("garage");break;case"gotoShopFromGarage":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromGarage"),userInput.removeHitArea("gotoCustomiseFromGarage"),userInput.removeHitArea("gotoUpgradeFromGarage"),userInput.removeHitArea("gotoShopFromGarage"),userInput.removeHitArea("sellCar"),newCarBought=!1,userInput.removeHitArea("garageScrollLeft"),userInput.removeHitArea("garageScrollRight"),initShop("garage");break;case"garageScrollLeft":playSound("click"),panel.garageScrollEvent("left"),newCarBought=!1;break;case"garageScrollRight":playSound("click"),panel.garageScrollEvent("right"),newCarBought=!1;break;case"shopScrollLeft":playSound("click"),panel.shopScrollEvent("left");break;case"shopScrollRight":playSound("click"),panel.shopScrollEvent("right");break;case"shopBuy":for(var e=!1,d=0;d<aUserGarageData.length;d++)aUserGarageData[d].body==aCarBaseData[curShopCarId].body&&(e=!0);if(!e&&aCarBaseData[curShopCarId].cost<=oUserCareerData.cash){playSound("buy"),aUserGarageData.push(cloneObject(aCarBaseData[curShopCarId])),oUserCareerData.cash-=aCarBaseData[curShopCarId].cost,oUserCareerData.curCarId=aUserGarageData.length-1,oUserCareerData.carsOwned++,saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),userInput.removeHitArea("shopBuy"),userInput.removeHitArea("backToGarageFromShop"),userInput.removeHitArea("backToMapFromShop"),userInput.removeHitArea("shopScrollLeft"),userInput.removeHitArea("shopScrollRight"),oUserCareerData.cash>aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.startCost&&(newCarBought=!0);var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1,cost:aCarBaseData[curShopCarId].cost};com.funtomic.GameOps.reportEvent("purchase_car",c),initGarage();for(var d=0;10>d;d++)addFirework(600*Math.random()+50,350*Math.random()+50,.5*Math.random()+1)}break;case"backToGarageFromShop":playSound("click"),userInput.removeHitArea("shopBuy"),userInput.removeHitArea("backToGarageFromShop"),userInput.removeHitArea("backToMapFromShop"),userInput.removeHitArea("shopScrollLeft"),userInput.removeHitArea("shopScrollRight"),initGarage();break;case"backToMapFromShop":playSound("click"),userInput.removeHitArea("shopBuy"),userInput.removeHitArea("backToGarageFromShop"),userInput.removeHitArea("backToMapFromShop"),userInput.removeHitArea("shopScrollLeft"),userInput.removeHitArea("shopScrollRight"),initRaceSelect();break;case"backToGarageFromUpgrade":playSound("click"),userInput.removeHitArea("backToGarageFromUpgrade"),userInput.removeHitArea("backToMapFromUpgrade"),userInput.removeHitArea("engineTab"),userInput.removeHitArea("accTab"),userInput.removeHitArea("wheelsTab"),userInput.removeHitArea("weightTab"),userInput.removeHitArea("nitroTab"),userInput.removeHitArea("upgradeBuy"),userInput.removeHitArea("autoUpgradeBuy"),initGarage();break;case"backToMapFromUpgrade":playSound("click"),userInput.removeHitArea("backToGarageFromUpgrade"),userInput.removeHitArea("backToMapFromUpgrade"),userInput.removeHitArea("engineTab"),userInput.removeHitArea("accTab"),userInput.removeHitArea("wheelsTab"),userInput.removeHitArea("weightTab"),userInput.removeHitArea("nitroTab"),userInput.removeHitArea("upgradeBuy"),userInput.removeHitArea("autoUpgradeBuy"),initRaceSelect();break;case"engineTab":playSound("click"),changeUpgradeTab("engine");
break;case"accTab":playSound("click"),changeUpgradeTab("acc");break;case"wheelsTab":playSound("click"),changeUpgradeTab("wheels");break;case"weightTab":playSound("click"),changeUpgradeTab("weight");break;case"nitroTab":playSound("click"),changeUpgradeTab("nitro");break;case"upgradeBuy":var e=!1;if(5==aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]&&(e=!0),!e&&curUpgradeCost<=oUserCareerData.cash){playSound("buy");var f=getAutoUpgradeCost(),g=!1;f<=oUserCareerData.cash&&0!=f&&(g=!0);var h;switch(upgradeTab){case"engine":aUserGarageData[oUserCareerData.curCarId].engineUpgrade++,h=aUserGarageData[oUserCareerData.curCarId].engineUpgrade;break;case"acc":aUserGarageData[oUserCareerData.curCarId].accUpgrade++,h=aUserGarageData[oUserCareerData.curCarId].accUpgrade;break;case"wheels":aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade++,h=aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade;break;case"weight":aUserGarageData[oUserCareerData.curCarId].weightUpgrade++,h=aUserGarageData[oUserCareerData.curCarId].weightUpgrade;break;case"nitro":aUserGarageData[oUserCareerData.curCarId].nitroUpgrade++,h=aUserGarageData[oUserCareerData.curCarId].nitroUpgrade,0==firstNitroStage&&(firstNitroStage=1)}var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1,upgrade_type:upgradeTab,upgrade_stage:h,upgrade_all_potential:g};com.funtomic.GameOps.reportEvent("upgrade",c);for(var d=0;3>d;d++)addFirework(200*Math.random()+475,100*Math.random()+340,.5*Math.random()+1);oUserCareerData.cash-=curUpgradeCost,saveDataHandler.updateStats(aUserGarageData),changeUpgradeTab(upgradeTab),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),updateVideoStatus()}break;case"autoUpgradeBuy":var e=!1,f=getAutoUpgradeCost();if(f<=oUserCareerData.cash&&0!=f){playSound("buy"),aUserGarageData[oUserCareerData.curCarId].engineUpgrade<5&&aUserGarageData[oUserCareerData.curCarId].engineUpgrade++,aUserGarageData[oUserCareerData.curCarId].accUpgrade<5&&aUserGarageData[oUserCareerData.curCarId].accUpgrade++,aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade<5&&aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade++,aUserGarageData[oUserCareerData.curCarId].weightUpgrade<5&&aUserGarageData[oUserCareerData.curCarId].weightUpgrade++,aUserGarageData[oUserCareerData.curCarId].nitroUpgrade<5&&(aUserGarageData[oUserCareerData.curCarId].nitroUpgrade++,0==firstNitroStage&&(firstNitroStage=1));for(var d=0;3>d;d++)addFirework(200*Math.random()+275,100*Math.random()+340,.5*Math.random()+1);oUserCareerData.cash-=f,saveDataHandler.updateStats(aUserGarageData),changeUpgradeTab(upgradeTab);var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1};com.funtomic.GameOps.reportEvent("upgrade_all",c),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),updateVideoStatus()}else if(canShowVideo&&0!=f){playSound("click"),oUserCareerData.cash+=1e3,saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData(),com.funtomic.GameOps.KiziAPI_showIncentivizedVideo(videoUpgradeCallback);var c={place:"Upgrade",present_type:"coins",type_amount:1e3};com.funtomic.GameOps.reportEvent("incentivized_video_ad_set",c)}break;case"customiseSelect":if("colour"==customiseTab&&b.id>4)return;if(playSound("click"),curCustomiseButHighlight=b.id+curRimScroll,"colour"==customiseTab){userCar.oCarTypeData.colour=b.id;for(var i=0;i<aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aColoursOwned[i]){oCustomiseSaveData.colour=userCar.oCarTypeData.colour;break}}else if("rims"==customiseTab){userCar.oCarTypeData.rims=b.id+curRimScroll;for(var i=0;i<aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aRimsOwned[i]){oCustomiseSaveData.rims=userCar.oCarTypeData.rims;break}}else if("shadow"==customiseTab){userCar.oCarTypeData.shadow=b.id;for(var i=0;i<aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aNeonOwned[i]){oCustomiseSaveData.shadow=userCar.oCarTypeData.shadow;break}}break;case"backToGarageFromCustomise":playSound("click"),userInput.removeHitArea("backToGarageFromCustomise"),userInput.removeHitArea("colourTab"),userInput.removeHitArea("rimsTab"),userInput.removeHitArea("shadowTab"),userInput.removeHitArea("customiseBuy"),userInput.removeHitArea("customiseSelect"),userInput.removeHitArea("customiseScrollRight"),userInput.removeHitArea("customiseScrollLeft"),aUserGarageData[oUserCareerData.curCarId].colour=oCustomiseSaveData.colour,aUserGarageData[oUserCareerData.curCarId].rims=oCustomiseSaveData.rims,aUserGarageData[oUserCareerData.curCarId].shadow=oCustomiseSaveData.shadow,initGarage();break;case"colourTab":playSound("click"),changeCustomiseTab("colour");break;case"rimsTab":playSound("click"),changeCustomiseTab("rims");break;case"shadowTab":playSound("click"),changeCustomiseTab("shadow");break;case"customiseScrollLeft":"rims"==customiseTab&&(playSound("click"),panel.customiseScrollEvent("left"));break;case"customiseScrollRight":"rims"==customiseTab&&(playSound("click"),panel.customiseScrollEvent("right"));break;case"customiseBuy":var e=!1;if(isVideoCustomise(curCustomiseButHighlight))switch(customiseTab){case"colour":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aColoursOwned[i]){j=!0;break}j||oCustomiseSaveData.colour==curCustomiseButHighlight||(e=!0);break;case"rims":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aRimsOwned[i]){j=!0;break}j||oCustomiseSaveData.rims==curCustomiseButHighlight||(e=!0);break;case"shadow":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aNeonOwned[i]){j=!0;break}j||oCustomiseSaveData.shadow==curCustomiseButHighlight||(e=!0)}else switch(customiseTab){case"colour":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aColoursOwned[i]){j=!0;break}!j&&oCustomiseSaveData.colour!=curCustomiseButHighlight&&curCustomiseCost<=oUserCareerData.cash&&(oCustomiseSaveData.colour=aUserGarageData[oUserCareerData.curCarId].colour,e=!0,aUserGarageData[oUserCareerData.curCarId].aColoursOwned.push(oCustomiseSaveData.colour));break;case"rims":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aRimsOwned[i]){j=!0;break}!j&&oCustomiseSaveData.rims!=curCustomiseButHighlight&&curCustomiseCost<=oUserCareerData.cash&&(oCustomiseSaveData.rims=aUserGarageData[oUserCareerData.curCarId].rims,e=!0,aUserGarageData[oUserCareerData.curCarId].aRimsOwned.push(oCustomiseSaveData.rims));break;case"shadow":for(var j=!1,i=0;i<aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length;i++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aNeonOwned[i]){j=!0;break}!j&&oCustomiseSaveData.shadow!=curCustomiseButHighlight&&curCustomiseCost<=oUserCareerData.cash&&(oCustomiseSaveData.shadow=aUserGarageData[oUserCareerData.curCarId].shadow,e=!0,aUserGarageData[oUserCareerData.curCarId].aNeonOwned.push(oCustomiseSaveData.shadow))}if(e&&isVideoCustomise(curCustomiseButHighlight)&&canShowVideo){playSound("click"),com.funtomic.GameOps.KiziAPI_showIncentivizedVideo(videoCustomiseCallback);var c={place:"Customization",present_type:customiseTab,type_amount:1};com.funtomic.GameOps.reportEvent("incentivized_video_ad_set",c)}else if(e&&!isVideoCustomise(curCustomiseButHighlight)){playSound("buy"),oUserCareerData.cash-=curCustomiseCost;var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1,upgrade_type:customiseTab,cost:curCustomiseCost};com.funtomic.GameOps.reportEvent("customize",c),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData()}break;case"gotoRaceSelectFromComplete":playSound("click"),userInput.removeHitArea("gotoRaceSelectFromComplete"),userInput.removeHitArea("gotoGarageFromComplete"),userInput.removeHitArea("gotoUpgradeFromComplete"),canShowRaceEndVideoBonusPrompt()&&!videoRaceEndShown&&(raceEndBonusId=0),1==oUserCareerData.careerRace&&1==oUserCareerData.careerStage?initRace():(com.funtomic.GameOps.KiziAPI_isMidrollPending()&&com.funtomic.GameOps.KiziAPI_displayMidroll(),initRaceSelect());break;case"gotoUpgradeFromComplete":playSound("click"),canShowRaceEndVideoBonusPrompt()&&!videoRaceEndShown&&(raceEndBonusId=0),userInput.removeHitArea("gotoRaceSelectFromComplete"),userInput.removeHitArea("gotoGarageFromComplete"),userInput.removeHitArea("gotoUpgradeFromComplete"),initUpgrade("garage");break;case"gotoGarageFromComplete":playSound("click"),canShowRaceEndVideoBonusPrompt()&&!videoRaceEndShown&&(raceEndBonusId=0),userInput.removeHitArea("gotoRaceSelectFromComplete"),userInput.removeHitArea("gotoGarageFromComplete"),userInput.removeHitArea("gotoUpgradeFromComplete"),com.funtomic.GameOps.KiziAPI_isMidrollPending()&&com.funtomic.GameOps.KiziAPI_displayMidroll(),initGarage();break;case"mute":manualPause||(playSound("click"),toggleMute());break;case"accPedal":b.isDown?(playSound("rev"+Math.floor(2*Math.random())),accPedalIsDown=!0,hud.accPedalTween&&hud.accPedalTween.kill(),hud.accPedalHeight=.9,hud.accPedalY=134,userCar.revRock(),addExhaust(userCar),addSmoke(userCar),hud.pauseStartTimer=!1):(accPedalIsDown=!1,hud.accPedalTween=TweenLite.to(hud,.5,{accPedalHeight:1,accPedalY:120,ease:"Bounce.easeOut"}));break;case"gearChange":oRaceProgress.userRevs>userCar.oCarTypeData.revMeterRot-.15&&oRaceProgress.userGear<userCar.oCarTypeData.gearNum&&userChangeGear();break;case"nitroBoost":if(0==hud.nitroPosY&&!oRaceProgress.userBoostTriggered){oRaceProgress.userBoostTriggered=!0,TweenLite.to(hud,.5,{nitroPosY:200,ease:"Back.easeIn"}),userInput.removeHitArea("nitroBoost"),playSound("startSpin"+Math.floor(3*Math.random())),playSound("nitro"),addSmoke(userCar);for(var d=0;3>d;d++)addFirework(200*Math.random(),200*Math.random()+275,.5*Math.random()+1);userNitroTween=TweenLite.to(oRaceProgress,8*userCar.oCarTypeData.nitro,{userNitroBoost:1,ease:"Cubic.easeOut",onComplete:userNitroEndEvent})}break;case"pause":case"resumeFromPause":playSound("click"),toggleManualPause();break;case"quitFromPause":playSound("click"),hasVideoBoost=!1,toggleManualPause(),userInput.removeHitArea("pause"),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("moreGamesPause"),userInput.removeHitArea("restartFromPause"),userInput.removeHitArea("clearData"),userNitroTween&&userNitroTween.kill(),userRevTween&&userRevTween.kill(),enemyRevTween&&enemyRevTween.kill(),initRaceSelect();break;case"restartFromPause":if(playSound("click"),hasVideoBoost=!1,com.funtomic.GameOps.KiziAPI_isIncentivizedVideoAvailable())userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("pause"),userInput.removeHitArea("restartFromPause"),initVideoBoostOffer();else{toggleManualPause();var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1};com.funtomic.GameOps.reportEvent("restart",c),userInput.removeHitArea("pause"),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("moreGamesPause"),userInput.removeHitArea("restartFromPause"),userNitroTween&&userNitroTween.kill(),userRevTween&&userRevTween.kill(),enemyRevTween&&enemyRevTween.kill(),initRace()}break;case"quitFromVideoBoostOffer":playSound("click"),toggleManualPause(),userInput.removeHitArea("pause"),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userInput.removeHitArea("quitFromVideoBoostOffer"),userInput.removeHitArea("restartFromVideoBoostOffer"),userInput.removeHitArea("chooseVideoBoostOffer"),userNitroTween&&userNitroTween.kill(),userRevTween&&userRevTween.kill(),enemyRevTween&&enemyRevTween.kill(),initRaceSelect();break;case"restartFromVideoBoostOffer":playSound("click"),toggleManualPause();var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1};com.funtomic.GameOps.reportEvent("restart",c),userInput.removeHitArea("pause"),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userInput.removeHitArea("quitFromVideoBoostOffer"),userInput.removeHitArea("restartFromVideoBoostOffer"),userInput.removeHitArea("chooseVideoBoostOffer"),userNitroTween&&userNitroTween.kill(),userRevTween&&userRevTween.kill(),enemyRevTween&&enemyRevTween.kill(),initRace();break;case"chooseVideoBoostOffer":playSound("click"),ctx.fillStyle="rgba(0, 0, 0, 1)",ctx.fillRect(0,0,canvas.width,canvas.height),userInput.removeHitArea("quitFromVideoBoostOffer"),userInput.removeHitArea("restartFromVideoBoostOffer"),userInput.removeHitArea("chooseVideoBoostOffer"),hasVideoBoost=!0,window.setTimeout(initAfterVideo,2e3),com.funtomic.GameOps.KiziAPI_showIncentivizedVideo(videoBoostCallback);var c={place:"Start Boost",present_type:"Start Boost",type_amount:1};com.funtomic.GameOps.reportEvent("incentivized_video_ad_set",c);break;case"restartAfterVideo":playSound("click"),userInput.removeHitArea("restartAfterVideo"),toggleManualPause();var c={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1};com.funtomic.GameOps.reportEvent("restart",c),userInput.removeHitArea("pause"),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost"),userNitroTween&&userNitroTween.kill(),userRevTween&&userRevTween.kill(),enemyRevTween&&enemyRevTween.kill(),initRace();break;case"raceEndVideoChosen":com.funtomic.GameOps.KiziAPI_showIncentivizedVideo(videoRaceEndCallback),userInput.removeHitArea("raceEndVideoChosen"),oUserCareerData.cash+=getRaceEndVideoBonus(),oRaceProgress.totalReward+=getRaceEndVideoBonus(),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData();var c={place:"End race bonus",present_type:"End race bonus",type_amount:10*(raceEndBonusId+1)};com.funtomic.GameOps.reportEvent("incentivized_video_ad_set",c),raceEndBonusId=Math.min(raceEndBonusId+1,4),videoRaceEndShown=!0}}function getRaceEndVideoBonus(){var a=Math.round((raceEndBonusId+2)/10*oRaceProgress.reward);return a}function canShowRaceEndVideoBonusPrompt(){return!canShowVideo||"career"!=raceType||1==oUserCareerData.careerRace&&1==oUserCareerData.careerStage?!1:!0}function updateVideoStatus(){canShowVideo=com.funtomic.GameOps.KiziAPI_isIncentivizedVideoAvailable()?!0:!1}function isVideoCustomise(a){var b=!1;switch(customiseTab){case"rims":(3==a||7==a||11==a||15==a||19==a)&&(b=!0);break;case"colour":4==a&&(b=!0);break;case"shadow":5==a&&(b=!0)}return b}function initAfterVideo(){var a={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2,canvas.height/2+25],id:oImageIds.readyToRaceBut};userInput.addHitArea("restartAfterVideo",butEventHandler,null,"image",a);var b=new Array(a);panel=new Elements.Panel("videoBoostOffer",b),panel.render(ctx)}function initVideoBoostOffer(){var a={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.quitBut},b={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2+85,canvas.height/2+25],id:oImageIds.noThanksBut},c={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2-85,canvas.height/2+25],id:oImageIds.getBoostBut};userInput.addHitArea("quitFromVideoBoostOffer",butEventHandler,null,"image",a),userInput.addHitArea("restartFromVideoBoostOffer",butEventHandler,null,"image",b),userInput.addHitArea("chooseVideoBoostOffer",butEventHandler,null,"image",c);var d=new Array(a,b,c);panel=new Elements.Panel("videoBoostOffer",d),panel.render(ctx)}function videoRaceEndCallback(a){if(a){var b={place:"End race bonus",present_type:"End race bonus",type_amount:10*(raceEndBonusId+1),is_fully_watched:!0};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}else{raceEndBonusId=Math.max(raceEndBonusId-1,0),oUserCareerData.cash-=getRaceEndVideoBonus(),oRaceProgress.totalReward-=getRaceEndVideoBonus(),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData();var b={place:"End race bonus",present_type:"End race bonus",type_amount:10*(raceEndBonusId+1),is_fully_watched:!1};videoRaceEndShown=!1,userInput.addHitArea("raceEndVideoChosen",butEventHandler,null,"rect",{aRect:[370,234,554,323]},!0),com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}}function videoBoostCallback(a){if(a){var b={place:"Start Boost",present_type:"Start Boost",type_amount:1,is_fully_watched:!0};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}else{var b={place:"Start Boost",present_type:"Start Boost",type_amount:1,is_fully_watched:!1};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b),hasVideoBoost=!1}updateVideoStatus()}function videoUpgradeCallback(a){if(a){var b={place:"Upgrade",present_type:"coins",type_amount:1e3,is_fully_watched:!0};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}else{oUserCareerData.cash-=1e3,saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData();var b={place:"Upgrade",present_type:"coins",type_amount:1e3,is_fully_watched:!1};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}updateVideoStatus()}function videoCustomiseCallback(a){if(a){switch(customiseTab){case"colour":oCustomiseSaveData.colour=aUserGarageData[oUserCareerData.curCarId].colour,aUserGarageData[oUserCareerData.curCarId].aColoursOwned.push(oCustomiseSaveData.colour);break;case"rims":oCustomiseSaveData.rims=aUserGarageData[oUserCareerData.curCarId].rims,aUserGarageData[oUserCareerData.curCarId].aRimsOwned.push(oCustomiseSaveData.rims);break;case"shadow":oCustomiseSaveData.shadow=aUserGarageData[oUserCareerData.curCarId].shadow,aUserGarageData[oUserCareerData.curCarId].aNeonOwned.push(oCustomiseSaveData.shadow)}var b={place:"Customization",present_type:customiseTab,type_amount:1,is_fully_watched:!0};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b);var b={user_level:Math.floor(oUserCareerData.levelNum/100),car_level:oUserCareerData.curCarId+1,upgrade_type:customiseTab,cost:curCustomiseCost};com.funtomic.GameOps.reportEvent("customize",b),saveDataHandler.setCareerData(),saveDataHandler.setGarageData(),saveDataHandler.saveData()}else{var b={place:"Customization",present_type:customiseTab,type_amount:1,is_fully_watched:!1};com.funtomic.GameOps.reportEvent("incentivized_video_ad_watched",b)}updateVideoStatus()}function getUpgradeTotal(){return aUserGarageData[oUserCareerData.curCarId].engineUpgrade+aUserGarageData[oUserCareerData.curCarId].accUpgrade+aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade+aUserGarageData[oUserCareerData.curCarId].weightUpgrade+aUserGarageData[oUserCareerData.curCarId].nitroUpgrade}function addExhaust(a){if(!(aEffects.length>10)){var b=new Elements.Exhaust(assetLib.getData("exhaust"));b.x=a.x+(a.aPartsPosData[a.oCarTypeData.body].xExhaust-56*(2*a.oCarTypeData.engine+.5))*a.scale,b.y=a.y+(a.aPartsPosData[a.oCarTypeData.body].yExhaust+a.aPartsPosData[a.oCarTypeData.body].yGround)*a.scale,b.scaleX=b.scaleY=a.scale*(2*a.oCarTypeData.engine)+.5,aEffects.push(b)}}function addFirework(a,b,c){if("undefined"==typeof c&&(c=1),!(aFireworks.length>10)){var d=new Elements.Firework(assetLib.getData("firework"));d.x=a,d.y=b,d.scaleX=d.scaleY=c,aFireworks.push(d)}}function addSmoke(a){if(!(aEffects.length>10)){var b=new Elements.Smoke(assetLib.getData("smoke"));b.x=a.x+(a.aPartsPosData[a.oCarTypeData.body].xExhaust-80)*a.scale,b.y=a.y+(a.aPartsPosData[a.oCarTypeData.body].yExhaust+a.aPartsPosData[a.oCarTypeData.body].yGround)*a.scale,b.scaleX=b.scaleY=3*a.scale,aEffects.push(b)}}function shouldShowUpgradeTip(){return aUserGarageData[oUserCareerData.curCarId].engineUpgrade<4&&aUserGarageData[oUserCareerData.curCarId].accUpgrade<4&&aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade<4&&aUserGarageData[oUserCareerData.curCarId].weightUpgrade<4&&aUserGarageData[oUserCareerData.curCarId].nitroUpgrade<4&&oUserCareerData.cash>3*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.startCost&&oRaceProgress.userFinishTime>oRaceProgress.enemyFinishTime}function userNitroEndEvent(){userNitroTween&&userNitroTween.kill(),userNitroTween=TweenLite.to(oRaceProgress,4*userCar.oCarTypeData.nitro,{userNitroBoost:0,ease:"Cubic.easeIn"})}function enemyNitroEndEvent(){enemyNitroTween&&enemyNitroTween.kill(),enemyNitroTween=TweenLite.to(oRaceProgress,4*enemyCar.oCarTypeData.nitro,{enemyNitroBoost:0,ease:"Cubic.easeIn"})}function setRaceProgress(){oRaceProgress={enemyProgress:0,enemySpeed:0,enemyRevs:0,enemyGear:0,enemyWheelSpin:0,enemyGearAccuracy:0,enemyAccState:0,enemyReverseRevs:0,enemyFinishTime:0,enemyNitroBoost:0,enemyNitroBoostTime:.6*Math.random()+.05,userProgress:0,userSpeed:0,userRevs:0,userGear:0,userWheelSpin:0,userGearAccuracy:0,userAccState:0,userReverseRevs:0,userFinishTime:0,userNitroBoost:0,time:0,raceLength:getRaceData().distance/1e3,reward:getRaceData().reward,background:getRaceData().background,startMultiplier:1,gearShiftMultiplierTotal:0,gearsShifted:0,gearShiftmultiplier:1,timeBonus:0,totalReward:0,newLevel:!1,userBoostTriggered:!1,enemyBoostTriggered:!1}}function cloneObject(a){var b=a.constructor();for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function changeUpgradeTab(a){upgradeTab=a,curUpgradeCost=getUpgradeCost(upgradeTab)}function getAutoUpgradeCost(){var a=0;return aUserGarageData[oUserCareerData.curCarId].engineUpgrade<5&&(a+=getUpgradeCost("engine")),aUserGarageData[oUserCareerData.curCarId].accUpgrade<5&&(a+=getUpgradeCost("acc")),aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade<5&&(a+=getUpgradeCost("wheels")),aUserGarageData[oUserCareerData.curCarId].weightUpgrade<5&&(a+=getUpgradeCost("weight")),aUserGarageData[oUserCareerData.curCarId].nitroUpgrade<5&&(a+=getUpgradeCost("nitro")),a}function getUpgradeCost(a){var b;switch(a){case"engine":b=aUserGarageData[oUserCareerData.curCarId].engineUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.startCost;break;case"acc":b=aUserGarageData[oUserCareerData.curCarId].accUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.startCost;break;case"wheels":b=aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.startCost;break;case"weight":b=aUserGarageData[oUserCareerData.curCarId].weightUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].weight.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].weight.startCost;break;case"nitro":b=aUserGarageData[oUserCareerData.curCarId].nitroUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].nitro.increaseAmount+aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].nitro.startCost}return b}function changeCustomiseTab(a){switch(customiseTab=a,curRimScroll=0,aUserGarageData[oUserCareerData.curCarId].colour=oCustomiseSaveData.colour,aUserGarageData[oUserCareerData.curCarId].rims=oCustomiseSaveData.rims,aUserGarageData[oUserCareerData.curCarId].shadow=oCustomiseSaveData.shadow,customiseTab){case"colour":curCustomiseCost=aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.startCost,curCustomiseButHighlight=aUserGarageData[oUserCareerData.curCarId].colour;break;case"rims":curCustomiseCost=aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.startCost,curCustomiseButHighlight=0;break;case"shadow":curCustomiseCost=aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.startCost,curCustomiseButHighlight=aUserGarageData[oUserCareerData.curCarId].shadow}}function raceStarted(){if(!hud.clockIsOn){if(hud.clockIsOn=!0,playSound("startSpin"+Math.floor(3*Math.random())),playSound("driveOff"),playSound("engineHum"),Math.abs(oRaceProgress.userRevs-userCar.oCarTypeData.revMeterRot)<=.075||hasVideoBoost){oRaceProgress.userGearAccuracy=.1,hud.addMessage("greatStart"),playSound("perfectGear");for(var a=0;5>a;a++)addFirework(600*Math.random()+50,100*Math.random()+60,1*Math.random()+1);oGearChanges.perfectStart=!0,hasVideoBoost&&(oRaceProgress.userSpeed=10,hasVideoBoost=!1)}else oRaceProgress.userGearAccuracy=.1+Math.min(1.5,10*Math.abs(oRaceProgress.userRevs-userCar.oCarTypeData.revMeterRot)-.5),oGearChanges.perfectStart=!1;oRaceProgress.startMultiplier=Math.max(1,Math.round(10*(1.5-(oRaceProgress.userGearAccuracy-.1)))/10),TweenLite.to(hud,.3,{startTimerX:-700,ease:"Cubic.easeIn",delay:1}),oRaceProgress.enemyRevs=enemyCar.oCarTypeData.revMeterRot+.2*Math.random()-.1,Math.abs(oRaceProgress.enemyRevs-enemyCar.oCarTypeData.revMeterRot)<=.05?oRaceProgress.enemyGearAccuracy=.1:oRaceProgress.enemyGearAccuracy=.1+Math.min(1.5,10*Math.abs(oRaceProgress.enemyRevs-enemyCar.oCarTypeData.revMeterRot)-.5),userInput.removeHitArea("accPedal"),TweenLite.to(hud,.5,{gearPosY:0,ease:"Back.easeOut",delay:.2}),TweenLite.to(hud,.5,{nitroPosY:0,ease:"Back.easeOut"}),userInput.addHitArea("gearChange",butEventHandler,null,"rect",{aRect:[524,324,680,canvas.height]},!0),userInput.addKey("gearChange",butEventHandler,null,32),userCar.oCarTypeData.nitro>0&&userInput.addHitArea("nitroBoost",butEventHandler,null,"rect",{aRect:[58,341,148,433]},!0),oRaceProgress.userGear=1,oRaceProgress.enemyGear=1,userCar.revRock(-1,2*((1-userCar.oCarTypeData.gearBox)/2+.2)),enemyCar.revRock(-1,2*((1-enemyCar.oCarTypeData.gearBox)/2+.2)),TweenLite.to(userCar.oCarTypeData,.2,{revMeterRot:userCar.oCarTypeData.aGearRatios[oRaceProgress.userGear],ease:"Quad.easeInOut"}),enemyCar.oCarTypeData.revMeterRot=enemyCar.oCarTypeData.aGearRatios[oRaceProgress.enemyGear],oRaceProgress.userWheelSpin=1,oRaceProgress.enemyWheelSpin=1,userRevTween=TweenLite.to(oRaceProgress,(1-userCar.oCarTypeData.gearBox)/2+.2,{userRevs:.2,ease:"Quad.easeOut",onComplete:userRevEvent}),enemyRevTween=TweenLite.to(oRaceProgress,(1-enemyCar.oCarTypeData.gearBox)/2+.2,{enemyRevs:.2,ease:"Quad.easeOut",onComplete:enemyRevEvent}),oRaceProgress.userAccState=0,oRaceProgress.enemyAccState=0}}function userRevEvent(){if(userRevTween&&userRevTween.kill(),oRaceProgress.userWheelSpin>0){var a=(.1+(1-userCar.oCarTypeData.grip))*Math.max(0,1-(oRaceProgress.userGear-1)/(userCar.oCarTypeData.gearNum/1.5));a*=oRaceProgress.userGearAccuracy,userRevTween=TweenLite.to(oRaceProgress,a,{userWheelSpin:0,ease:"Quad.easeIn",onComplete:userRevEvent})}else userCar.revRock(-2,(.5+3*(oRaceProgress.userGear/userCar.oCarTypeData.gearNum+oRaceProgress.userGear/userCar.oCarTypeData.gearNum)+(2-userCar.oCarTypeData.revRate))/2),userRevTween=oRaceProgress.userGear<userCar.oCarTypeData.gearNum?TweenLite.to(oRaceProgress,oRaceProgress.userGearAccuracy/1+.5+4*(oRaceProgress.userGear/userCar.oCarTypeData.gearNum+oRaceProgress.userGear/userCar.oCarTypeData.gearNum)+(2-userCar.oCarTypeData.revRate),{userRevs:.95,ease:"Quad.easeInOut"}):TweenLite.to(oRaceProgress,oRaceProgress.userGearAccuracy/1+2.5+4*(oRaceProgress.userGear/userCar.oCarTypeData.gearNum+oRaceProgress.userGear/userCar.oCarTypeData.gearNum)+(2-userCar.oCarTypeData.revRate),{userRevs:.95,ease:"Quad.easeInOut"}),oRaceProgress.userAccState=1}function enemyRevEvent(){if(enemyRevTween&&enemyRevTween.kill(),oRaceProgress.enemyWheelSpin>0){var a=(.1+(1-enemyCar.oCarTypeData.grip))*Math.max(0,1-(oRaceProgress.enemyGear-1)/(enemyCar.oCarTypeData.gearNum/1.5));a*=oRaceProgress.enemyGearAccuracy,enemyRevTween=TweenLite.to(oRaceProgress,a,{enemyWheelSpin:0,ease:"Quad.easeIn",onComplete:enemyRevEvent})}else enemyCar.revRock(-2,(.5+3*(oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum+oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum)+(2-enemyCar.oCarTypeData.revRate))/2),enemyRevTween=oRaceProgress.enemyGear<enemyCar.oCarTypeData.gearNum?TweenLite.to(oRaceProgress,oRaceProgress.enemyGearAccuracy/1+.5+4*(oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum+oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum)+(2-enemyCar.oCarTypeData.revRate),{enemyRevs:.95,ease:"Quad.easeInOut"}):TweenLite.to(oRaceProgress,oRaceProgress.enemyGearAccuracy/1+2.5+4*(oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum+oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum)+(2-enemyCar.oCarTypeData.revRate),{enemyRevs:.95,ease:"Quad.easeInOut"}),oRaceProgress.enemyAccState=1}function userChangeGear(){if(hud.gearPosY=20,TweenLite.to(hud,.5,{gearPosY:0,ease:"Back.easeOut"}),playSound("changeGear"+Math.floor(4*Math.random())),playSound("engineHum"),oRaceProgress.userGear++,addExhaust(userCar),addSmoke(userCar),oRaceProgress.userGearAccuracy=Math.min(2,30*Math.abs(oRaceProgress.userRevs-userCar.oCarTypeData.revMeterRot)),oRaceProgress.gearsShifted++,oRaceProgress.gearShiftMultiplierTotal+=2-oRaceProgress.userGearAccuracy,TweenLite.to(userCar.oCarTypeData,.3,{revMeterRot:userCar.oCarTypeData.aGearRatios[oRaceProgress.userGear],ease:"Quad.easeInOut"}),userCar.revRock(.5,2),oRaceProgress.userGear==userCar.oCarTypeData.gearNum&&(userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),TweenLite.to(hud,.5,{gearPosY:200,ease:"Back.easeIn"})),oRaceProgress.userGearAccuracy<.4){hud.addMessage("perfect"),oGearChanges.perfect++,playSound("perfectGear");for(var a=0;5>a;a++)addFirework(600*Math.random()+50,100*Math.random()+60,1*Math.random()+1)}else if(oRaceProgress.userGearAccuracy<.6){hud.addMessage("good"),oGearChanges.good++,playSound("goodGear");for(var a=0;2>a;a++)addFirework(600*Math.random()+50,100*Math.random()+60,1*Math.random()+1)}else oGearChanges.regular++;oRaceProgress.userAccState=0,oRaceProgress.userWheelSpin=1-oRaceProgress.userGear/userCar.oCarTypeData.gearNum/2,userRevTween=TweenLite.to(oRaceProgress,(1-userCar.oCarTypeData.gearBox)/2+.2,{userRevs:.2+oRaceProgress.userGear/userCar.oCarTypeData.gearNum/4-oRaceProgress.userGearAccuracy/10,ease:"Quad.easeOut",onComplete:userRevEvent})}function enemyChangeGear(){oRaceProgress.enemyGear++,playSound("engineHum"),addExhaust(enemyCar),addSmoke(enemyCar),oRaceProgress.enemyGearAccuracy=Math.min(2,30*Math.abs(oRaceProgress.enemyRevs-enemyCar.oCarTypeData.revMeterRot)),TweenLite.to(enemyCar.oCarTypeData,.3,{revMeterRot:enemyCar.oCarTypeData.aGearRatios[oRaceProgress.enemyGear],ease:"Quad.easeInOut"}),enemyCar.revRock(.5,2),oRaceProgress.enemyAccState=0,oRaceProgress.enemyWheelSpin=1-oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum/2,enemyRevTween=TweenLite.to(oRaceProgress,(1-enemyCar.oCarTypeData.gearBox)/2+.2,{enemyRevs:.2+oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum/4-oRaceProgress.enemyGearAccuracy/10,ease:"Quad.easeOut",onComplete:enemyRevEvent})}function userRaceComplete(){oRaceProgress.userAccState=2,userInput.removeHitArea("pause"),0==oRaceProgress.gearsShifted?oRaceProgress.gearShiftMultiplier=1:oRaceProgress.gearShiftMultiplier=Math.max(1,Math.round(oRaceProgress.gearShiftMultiplierTotal/oRaceProgress.gearsShifted*9)/10),
userRevTween&&userRevTween.kill(),oRaceProgress.userFinishTime=oRaceProgress.time,2==oRaceProgress.enemyAccState?(hud.addMessage("endLose"),playSound("endLose")):(hud.addMessage("endWin"),playSound("endWin")),userRevTween=TweenLite.to(oRaceProgress,3,{userRevs:.2,ease:"Quad.easeInOut"})}function enemyRaceComplete(){oRaceProgress.enemyAccState=2,enemyRevTween&&enemyRevTween.kill(),oRaceProgress.enemyFinishTime=oRaceProgress.time,2==oRaceProgress.userAccState&&(userInput.removeHitArea("pause"),hud.removeMessageAtEnd(hud)),enemyRevTween=TweenLite.to(oRaceProgress,3,{enemyRevs:.2,ease:"Quad.easeInOut"})}function getMaxRaces(a){return"undefined"==typeof a&&(a=oUserCareerData),a.careerStage<=3?3:a.careerStage<=7?5:7}function getRaceNumInStage(a){return 3>=a?3:7>=a?5:7}function getRaceData(){var a,b;return"career"==raceType||"prevCareer"==raceType?(Math.seedrandom(oPrevCareerData.careerStage+oPrevCareerData.careerRace+oPrevCareerData.posId),a=30+Math.round(oPrevCareerData.careerStage/1.3*100)+Math.round(getRating(getEnemy())/2),b=250+250*Math.round(Math.random()*Math.min(5,oPrevCareerData.careerStage/3))):"quickRaceEasy"==raceType?(a=75*(aUserGarageData[oUserCareerData.curCarId].body+1),b=250):"quickRaceMedium"==raceType?(a=100*(aUserGarageData[oUserCareerData.curCarId].body+1),b=500):"quickRaceHard"==raceType&&(a=150*(aUserGarageData[oUserCareerData.curCarId].body+1),b=750),{reward:a,rating:getRating(getEnemy()),distance:b,background:Math.floor(3*Math.random()),difficulty:Math.floor((getRating(getEnemy())-150)/100)}}function getPrevEnemy(a){var b,c;Math.seedrandom(a.careerStage+a.careerRace+a.posId),c=0;var d=a.careerStage-1+a.careerRace/10;if(1==a.careerStage&&1==a.careerRace||(c=Math.min(.85,Math.floor(Math.random()*a.careerStage*7.5)/100)),1==a.careerStage&&1==a.careerRace&&"career"==raceType)return{body:0,colour:1,rims:2,gearNum:aCarBaseData[0].gearNum,shadow:3,engine:Math.min(.99,.25+.063*d),gearBox:Math.min(.99,.15+.073*d),grip:Math.min(.99,.2+.068*d),nitro:c,weight:Math.max(.15,.59-.033*d)};var b=Math.max(0,Math.min(11,Math.round(.5*(a.careerStage-1))+Math.round(3*Math.random()-1)));return{body:b,colour:Math.floor(4*Math.random()),rims:Math.floor(15*Math.random()),gearNum:aCarBaseData[b].gearNum,shadow:Math.floor(5*Math.random()),engine:Math.min(.99,.25+.063*d+.1*Math.random()-.05),gearBox:Math.min(.99,.15+.073*d+.1*Math.random()-.05),grip:Math.min(.99,.2+.068*d+.1*Math.random()-.05),nitro:c,weight:Math.max(.15,.59-.033*d+.1*Math.random()-.05)}}function getEnemy(){var a,b;if("prevCareer"==raceType||"career"==raceType){Math.seedrandom(oPrevCareerData.careerStage+oPrevCareerData.careerRace+oPrevCareerData.posId),b=0;var c=oPrevCareerData.careerStage-1+oPrevCareerData.careerRace/10;if(1==oPrevCareerData.careerStage&&1==oPrevCareerData.careerRace||(b=Math.min(.85,Math.floor(Math.random()*oPrevCareerData.careerStage*7.5)/100)),1==oUserCareerData.careerStage&&1==oUserCareerData.careerRace&&"career"==raceType)return{body:0,colour:1,rims:2,gearNum:aCarBaseData[0].gearNum,shadow:3,engine:Math.min(.99,.25+.063*c),gearBox:Math.min(.99,.15+.073*c),grip:Math.min(.99,.2+.068*c),nitro:b,weight:Math.max(.15,.59-.033*c)};var a=Math.max(0,Math.min(11,Math.round(.5*(oPrevCareerData.careerStage-1))+Math.round(3*Math.random()-1)));return{body:a,colour:Math.floor(5*Math.random()),rims:Math.floor(20*Math.random()),gearNum:aCarBaseData[a].gearNum,shadow:Math.floor(5*Math.random()),engine:Math.min(.99,.25+.063*c+.1*Math.random()-.05),gearBox:Math.min(.99,.15+.073*c+.1*Math.random()-.05),grip:Math.min(.99,.2+.068*c+.1*Math.random()-.05),nitro:b,weight:Math.max(.15,.59-.033*c+.1*Math.random()-.05)}}return Math.seedrandom(oUserCareerData.cash),"quickRaceEasy"==raceType?(a=Math.max(0,Math.min(11,aUserGarageData[oUserCareerData.curCarId].body+Math.round(-2*Math.random()))),{body:a,colour:Math.floor(5*Math.random()),rims:Math.floor(20*Math.random()),gearNum:aCarBaseData[a].gearNum,shadow:Math.floor(5*Math.random()),engine:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine+.08*Math.random()-.04,gearBox:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox+.08*Math.random()-.04,grip:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip+.08*Math.random()-.04,nitro:Math.max(0,aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].nitro+Math.round(.2*Math.random()-.1)),weight:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight+.08*Math.random()-.04}):"quickRaceMedium"==raceType?(a=Math.max(0,Math.min(11,aUserGarageData[oUserCareerData.curCarId].body+Math.round(2*Math.random()-1))),{body:a,colour:Math.floor(5*Math.random()),rims:Math.floor(20*Math.random()),gearNum:aCarBaseData[a].gearNum,shadow:Math.floor(5*Math.random()),engine:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine+.5*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine)+.08*Math.random()-.04,gearBox:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox+.5*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox)+.08*Math.random()-.04,grip:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip+.5*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip)+.08*Math.random()-.04,nitro:Math.max(0,.5*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].nitro.maxUpgradeLevel+.08*Math.random()-.04),weight:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight+.5*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].weight.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight)+.08*Math.random()-.04}):"quickRaceHard"==raceType?(a=Math.max(0,Math.min(11,aUserGarageData[oUserCareerData.curCarId].body+Math.round(2*Math.random()))),{body:a,colour:Math.floor(5*Math.random()),rims:Math.floor(20*Math.random()),gearNum:aCarBaseData[a].gearNum,shadow:Math.floor(5*Math.random()),engine:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine+1*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine)+.08*Math.random()-.04,gearBox:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox+1*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox)+.08*Math.random()-.04,grip:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip+1*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip)+.08*Math.random()-.04,nitro:Math.max(0,1*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].nitro.maxUpgradeLevel+.08*Math.random()-.04),weight:aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight+1*(aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].weight.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight)+.08*Math.random()-.04}):void 0}function getRating(a){return Math.round(200*a.engine+150*a.gearBox+150*a.grip+150*(1-a.weight)+100*a.nitro)}function getSellCost(){var a=.75*aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].cost;return a+=aUserGarageData[oUserCareerData.curCarId].engineUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount,a+=aUserGarageData[oUserCareerData.curCarId].accUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount,a+=aUserGarageData[oUserCareerData.curCarId].wheelsUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount,a+=aUserGarageData[oUserCareerData.curCarId].weightUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount,a+=aUserGarageData[oUserCareerData.curCarId].nitroUpgrade*aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.increaseAmount,Math.round(a)}function getCutomBonus(){var a=0;return a+=(aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length-1)*(10*(aUserGarageData[oUserCareerData.curCarId].body/2+1)),a+=(aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length-1)*(10*(aUserGarageData[oUserCareerData.curCarId].body/2+1)),a+=(aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length-1)*(10*(aUserGarageData[oUserCareerData.curCarId].body/2+1)),Math.round(a)}function updateRaceEvent(){if(!manualPause&&!rotatePause&&"race"==gameState){delta=getDelta(),scrollGround.update(),scrollGround.render(),oRaceProgress.enemyProgress>oRaceProgress.enemyNitroBoostTime&&!oRaceProgress.enemyBoostTriggered&&(oRaceProgress.enemyBoostTriggered=!0,enemyNitroTween=TweenLite.to(oRaceProgress,8*enemyCar.oCarTypeData.nitro,{enemyNitroBoost:1,ease:"Cubic.easeOut",onComplete:enemyNitroEndEvent}),addSmoke(enemyCar)),0==oRaceProgress.time?accPedalIsDown?(oRaceProgress.userWheelSpin=(oRaceProgress.userRevs-userCar.oCarTypeData.revMeterRot)/(.95-userCar.oCarTypeData.revMeterRot)*1,oRaceProgress.userRevs=Math.min(1,oRaceProgress.userRevs+(1.5-oRaceProgress.userRevs)*(1+1.5*userCar.oCarTypeData.engine)*delta)):oRaceProgress.userRevs=Math.max(0,oRaceProgress.userRevs-(1.5-oRaceProgress.userRevs)*(1+.5*userCar.oCarTypeData.engine)*delta):(oRaceProgress.userReverseRevs=oRaceProgress.enemyReverseRevs=0,oRaceProgress.userRevs>userCar.oCarTypeData.revMeterRot-.1&&1==oRaceProgress.userAccState&&(oRaceProgress.userReverseRevs=(oRaceProgress.userRevs-(userCar.oCarTypeData.revMeterRot-.1))/.12*oRaceProgress.userRevs,oRaceProgress.userRevs>userCar.oCarTypeData.revMeterRot&&(oRaceProgress.userWheelSpin=(oRaceProgress.userRevs-userCar.oCarTypeData.revMeterRot)/(.95-userCar.oCarTypeData.revMeterRot)*1)),oRaceProgress.enemyRevs>enemyCar.oCarTypeData.revMeterRot-.1&&1==oRaceProgress.enemyAccState&&(oRaceProgress.enemyReverseRevs=(oRaceProgress.enemyRevs-(enemyCar.oCarTypeData.revMeterRot-.1))/.12*oRaceProgress.enemyRevs,oRaceProgress.enemyRevs>enemyCar.oCarTypeData.revMeterRot&&(oRaceProgress.enemyWheelSpin=(oRaceProgress.enemyRevs-enemyCar.oCarTypeData.revMeterRot)/(.95-enemyCar.oCarTypeData.revMeterRot)*1)),2!=oRaceProgress.userAccState?oRaceProgress.userSpeed+=Math.max(0,oRaceProgress.userRevs-oRaceProgress.userReverseRevs+oRaceProgress.userNitroBoost*(2*oRaceProgress.userProgress))*delta*(userCar.oCarTypeData.speedMultiplier*(1.2-oRaceProgress.userGear/userCar.oCarTypeData.gearNum)):(oRaceProgress.userWheelSpin=0,oRaceProgress.userSpeed=Math.max(0,oRaceProgress.userSpeed-Math.max(0,oRaceProgress.userRevs-oRaceProgress.userReverseRevs)*delta*(userCar.oCarTypeData.speedMultiplier*(1.2-oRaceProgress.userGear/userCar.oCarTypeData.gearNum))),(2!=oRaceProgress.enemyAccState||oRaceProgress.enemyFinishTime>oRaceProgress.userFinishTime)&&Math.random()<.1&&(playSound("firework"),addFirework(600*Math.random()+50,350*Math.random()+50,1*Math.random()+2))),2!=oRaceProgress.enemyAccState?oRaceProgress.enemySpeed+=Math.max(0,oRaceProgress.enemyRevs-oRaceProgress.enemyReverseRevs+oRaceProgress.enemyNitroBoost*(2*oRaceProgress.enemyProgress))*delta*(enemyCar.oCarTypeData.speedMultiplier*(1.2-oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum)):(oRaceProgress.enemyWheelSpin=0,oRaceProgress.enemySpeed=Math.max(0,oRaceProgress.enemySpeed-Math.max(0,oRaceProgress.enemyRevs-oRaceProgress.enemyReverseRevs)*delta*(enemyCar.oCarTypeData.speedMultiplier*(1.2-oRaceProgress.enemyGear/enemyCar.oCarTypeData.gearNum)))),1==oRaceProgress.enemyAccState&&oRaceProgress.enemyRevs>=enemyCar.oCarTypeData.revMeterRot+enemyCar.aEnemyGearOffset[oRaceProgress.enemyGear]&&oRaceProgress.enemyGear<enemyCar.oCarTypeData.gearNum&&enemyChangeGear(),scrollGround.scrollX+=oRaceProgress.userSpeed*delta*20);for(var a=0;a<aEffects.length;a++)aEffects[a].update(),aEffects[a].render(ctx),aEffects[a].removeMe&&(aEffects.splice(a,1),a-=1);userCar.update(),enemyCar.update(),enemyCar.render(),userCar.render(),1==oRaceProgress.userProgress&&2!=oRaceProgress.userAccState&&userRaceComplete(),1==oRaceProgress.enemyProgress&&2!=oRaceProgress.enemyAccState&&enemyRaceComplete(),hud.update(),hud.render();for(var a=0;a<aFireworks.length;a++)aFireworks[a].update(),aFireworks[a].render(ctx),aFireworks[a].removeMe&&(aFireworks.splice(a,1),a-=1);renderMuteBut(),requestAnimFrame(updateRaceEvent)}}function updateCreditsScreenEvent(){rotatePause||"credits"!=gameState||(delta=getDelta(),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateCreditsScreenEvent))}function updateStatsScreenEvent(){rotatePause||"stats"!=gameState||(delta=getDelta(),background.render(ctx),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateStatsScreenEvent))}function updateRaceSelectEvent(){rotatePause||"raceSelect"!=gameState||(delta=getDelta(),background.render(ctx),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateRaceSelectEvent))}function updateRacePreviewEvent(){rotatePause||"racePreview"!=gameState||(delta=getDelta(),scrollGround.update(),scrollGround.render(),swayX+=.75*delta,scrollGround.scrollX=50*Math.sin(swayX),userCar.x=canvas.width/2-2*scrollGround.scrollX-100,enemyCar.x=canvas.width/2-1.5*scrollGround.scrollX-75,enemyCar.render(),userCar.render(),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateRacePreviewEvent))}function updateGarageEvent(){if(!rotatePause&&"garage"==gameState){delta=getDelta(),background.render(ctx),userCar.scale=1,userCar.y=375,userCar.x=320,userCar.render(),panel.update(delta),panel.render(ctx);for(var a=0;a<aFireworks.length;a++)aFireworks[a].update(),aFireworks[a].render(ctx),aFireworks[a].removeMe&&(aFireworks.splice(a,1),a-=1);renderMuteBut(),requestAnimFrame(updateGarageEvent)}}function updateShopEvent(){if(!rotatePause&&"shop"==gameState){delta=getDelta(),background.render(ctx),userCar.scale=1,userCar.y=375,userCar.x=320,userCar.render(),panel.update(delta),panel.render(ctx);for(var a=0;a<aFireworks.length;a++)aFireworks[a].update(),aFireworks[a].render(ctx),aFireworks[a].removeMe&&(aFireworks.splice(a,1),a-=1);renderMuteBut(),requestAnimFrame(updateShopEvent)}}function updateUpgradeEvent(){if(!rotatePause&&"upgrade"==gameState){delta=getDelta(),background.render(ctx),panel.update(delta),panel.render(ctx);for(var a=0;a<aFireworks.length;a++)aFireworks[a].update(),aFireworks[a].render(ctx),aFireworks[a].removeMe&&(aFireworks.splice(a,1),a-=1);renderMuteBut(),requestAnimFrame(updateUpgradeEvent)}}function updateCustomiseEvent(){rotatePause||"customise"!=gameState||(delta=getDelta(),background.render(ctx),userCar.scale=1,userCar.y=375,userCar.x=320,userCar.render(),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateCustomiseEvent))}function updateRaceCompleteEvent(){rotatePause||"raceComplete"!=gameState||(delta=getDelta(),background.render(ctx),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateRaceCompleteEvent))}function updateStartScreenEvent(){rotatePause||"start"!=gameState||(delta=getDelta(),background.render(ctx),panel.update(delta),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateStartScreenEvent))}function getDelta(){var a=(new Date).getTime(),b=(a-previousTime)/1e3;return previousTime=a,b>.5&&(b=0),b}function checkSpriteCollision(a,b){var c=a.x,d=a.y,e=b.x,f=b.y,g=(c-e)*(c-e)+(d-f)*(d-f),h=a.radius*b.radius;return h>g?!0:!1}function getScaleImageToMax(a,b){var c;return c=a.isSpriteSheet?b[0]/a.oData.spriteWidth<b[1]/a.oData.spriteHeight?Math.min(b[0]/a.oData.spriteWidth,1):Math.min(b[1]/a.oData.spriteHeight,1):b[0]/a.img.width<b[1]/a.img.height?Math.min(b[0]/a.img.width,1):Math.min(b[1]/a.img.height,1)}function getCentreFromTopLeft(a,b,c){var d=new Array;return d.push(a[0]+b.oData.spriteWidth/2*c),d.push(a[1]+b.oData.spriteHeight/2*c),d}function loadPreAssets(){if(aLangs.length>1){for(var a=new Array,b=0;b<aLangs.length;b++)a.push({id:"lang"+aLangs[b],file:"images/lang"+aLangs[b]+".png"});preAssetLib=new Utils.AssetLoader(curLang,a,ctx,canvas.width,canvas.height,!1),preAssetLib.onReady(initLangSelect)}else curLang=aLangs[0],preAssetLib=new Utils.AssetLoader(curLang,[{id:"preloadImage",file:"images/"+curLang+"/preloadImage.jpg"}],ctx,canvas.width,canvas.height,!1),preAssetLib.onReady(initLoadAssets)}function initLangSelect(){for(var a,b,c,d=10,e=0,f=0,g=1,h=0;h<aLangs.length&&(a=preAssetLib.getData("lang"+aLangs[h]),(h+1)*(a.img.width*g)+(h+2)*d<canvas.width);h++)e++;f=Math.ceil(aLangs.length/e);for(var h=0;h<aLangs.length;h++){a=preAssetLib.getData("lang"+aLangs[h]),b=canvas.width/2-e/2*(a.img.width*g)-(e-1)/2*d,b+=h%e*(a.img.width*g+d),c=canvas.height/2-f/2*(a.img.height*g)-(f-1)/2*d,c+=Math.floor(h/e)%f*(a.img.height*g+d),ctx.drawImage(a.img,0,0,a.img.width,a.img.height,b,c,a.img.width*g,a.img.height*g);var i={oImgData:a,aPos:[b+a.img.width*g/2,c+a.img.height*g/2],scale:g,id:"none",noMove:!0};userInput.addHitArea("langSelect",butEventHandler,{lang:aLangs[h]},"image",i)}}function initLoadAssets(){var a=preAssetLib.getData("preloadImage");ctx.drawImage(a.img,0,0),loadAssets()}function loadAssets(){com.funtomic.GameOps.KiziAPI_preloaderStarted(),assetLib=new Utils.AssetLoader(curLang,[{id:"garage",file:"images/garageBg.jpg"},{id:"mapBg",file:"images/mapBg.jpg"},{id:"raceSelectBg",file:"images/raceSelectBg.jpg"},{id:"road",file:"images/road.jpg"},{id:"topFlare",file:"images/topFlare.png"},{id:"rotateDeviceMessage",file:"images/rotateDeviceMessage.jpg"},{id:"splash",file:"images/splashScreen.jpg"},{id:"hud",file:"images/"+curLang+"/hud.png"},{id:"uiButs",file:"images/"+curLang+"/uiButs.png",oAtlasData:{id0:{x:480,y:246,width:130,height:56},id1:{x:555,y:705,width:130,height:56},id10:{x:0,y:0,width:218,height:99},id11:{x:280,y:721,width:138,height:51},id12:{x:340,y:312,width:138,height:51},id13:{x:318,y:586,width:138,height:51},id14:{x:327,y:377,width:138,height:51},id15:{x:140,y:725,width:138,height:51},id16:{x:318,y:639,width:138,height:51},id17:{x:340,y:259,width:138,height:51},id18:{x:0,y:725,width:138,height:51},id19:{x:458,y:586,width:133,height:59},id2:{x:0,y:261,width:168,height:56},id20:{x:455,y:61,width:133,height:59},id21:{x:459,y:430,width:133,height:59},id22:{x:454,y:185,width:133,height:59},id23:{x:454,y:124,width:133,height:59},id24:{x:420,y:692,width:133,height:59},id25:{x:455,y:0,width:133,height:59},id26:{x:459,y:491,width:133,height:59},id27:{x:313,y:124,width:139,height:133},id28:{x:170,y:456,width:146,height:133},id29:{x:318,y:456,width:139,height:128},id3:{x:313,y:0,width:140,height:122},id30:{x:170,y:591,width:146,height:128},id31:{x:612,y:312,width:84,height:93},id32:{x:612,y:217,width:84,height:93},id33:{x:594,y:423,width:84,height:93},id34:{x:684,y:89,width:78,height:87},id35:{x:680,y:407,width:78,height:87},id36:{x:679,y:0,width:78,height:87},id37:{x:0,y:319,width:168,height:56},id38:{x:589,y:122,width:93,height:93},id39:{x:590,y:0,width:87,height:87},id4:{x:170,y:319,width:168,height:56},id40:{x:170,y:377,width:155,height:77},id41:{x:170,y:261,width:168,height:56},id42:{x:480,y:304,width:130,height:56},id43:{x:0,y:609,width:168,height:56},id44:{x:0,y:181,width:169,height:78},id45:{x:171,y:101,width:140,height:127},id46:{x:555,y:647,width:130,height:56},id47:{x:0,y:377,width:168,height:56},id48:{x:0,y:551,width:168,height:56},id49:{x:0,y:493,width:168,height:56},id5:{x:0,y:667,width:168,height:56},id50:{x:593,y:552,width:93,height:93},id51:{x:220,y:0,width:87,height:87},id52:{x:0,y:101,width:169,height:78},id6:{x:0,y:435,width:168,height:56},id7:{x:687,y:647,width:46,height:74},id8:{x:688,y:496,width:46,height:74},id9:{x:467,y:365,width:130,height:56}}},{id:"uiElements",file:"images/"+curLang+"/uiElements.png",oAtlasData:{id0:{x:0,y:918,width:150,height:22},id1:{x:740,y:713,width:50,height:30},id10:{x:307,y:259,width:85,height:25},id11:{x:624,y:894,width:84,height:25},id12:{x:565,y:798,width:147,height:94},id13:{x:572,y:424,width:144,height:94},id14:{x:408,y:798,width:155,height:94},id15:{x:619,y:96,width:137,height:94},id16:{x:619,y:0,width:138,height:94},id17:{x:421,y:232,width:153,height:94},id18:{x:464,y:139,width:145,height:68},id19:{x:714,y:847,width:123,height:94},id2:{x:467,y:0,width:150,height:137},id20:{x:575,y:328,width:144,height:68},id21:{x:206,y:619,width:156,height:68},id22:{x:324,y:894,width:151,height:43},id23:{x:307,y:187,width:155,height:43},id24:{x:307,y:142,width:155,height:43},id25:{x:166,y:879,width:156,height:43},id26:{x:307,y:97,width:155,height:43},id27:{x:598,y:565,width:140,height:43},id28:{x:598,y:520,width:140,height:43},id29:{x:598,y:610,width:140,height:43},id3:{x:740,y:494,width:98,height:137},id30:{x:220,y:538,width:155,height:43},id31:{x:598,y:655,width:140,height:94},id32:{x:714,y:751,width:127,height:94},id33:{x:718,y:398,width:111,height:94},id34:{x:421,y:328,width:152,height:94},id35:{x:421,y:463,width:149,height:68},id36:{x:576,y:209,width:143,height:94},id37:{x:220,y:286,width:199,height:250},id38:{x:410,y:538,width:186,height:258},id39:{x:205,y:703,width:203,height:86},id4:{x:721,y:192,width:98,height:137},id40:{x:0,y:619,width:204,height:57},id41:{x:205,y:791,width:201,height:82},id42:{x:0,y:387,width:218,height:114},id43:{x:220,y:583,width:116,height:32},id44:{x:477,y:894,width:145,height:37},id45:{x:421,y:424,width:149,height:37},id46:{x:721,y:331,width:56,height:57},id47:{x:0,y:879,width:164,height:37},id48:{x:0,y:678,width:204,height:23},id49:{x:0,y:160,width:305,height:61},id5:{x:759,y:0,width:98,height:137},id50:{x:0,y:223,width:305,height:61},id51:{x:0,y:97,width:305,height:61},id52:{x:0,y:703,width:203,height:86},id53:{x:0,y:791,width:203,height:86},id54:{x:831,y:383,width:77,height:104},id55:{x:843,y:738,width:59,height:78},id56:{x:839,y:847,width:77,height:103},id57:{x:821,y:278,width:77,height:103},id58:{x:821,y:633,width:77,height:103},id59:{x:840,y:489,width:77,height:103},id6:{x:821,y:139,width:98,height:137},id60:{x:904,y:746,width:51,height:74},id61:{x:904,y:670,width:51,height:74},id62:{x:900,y:594,width:51,height:74},id63:{x:900,y:278,width:51,height:74},id64:{x:859,y:0,width:74,height:110},id65:{x:338,y:583,width:63,height:32},id66:{x:740,y:633,width:79,height:78},id67:{x:266,y:924,width:52,height:25},id68:{x:152,y:924,width:112,height:25},id69:{x:0,y:0,width:465,height:95},id7:{x:624,y:921,width:81,height:25},id70:{x:364,y:617,width:38,height:35},id71:{x:0,y:503,width:218,height:114},id72:{x:0,y:286,width:218,height:99},id8:{x:598,y:751,width:84,height:25},id9:{x:307,y:232,width:85,height:25}}},{id:"colours",file:"images/colours.png",oAtlasData:{id0:{x:198,y:330,width:64,height:64},id1:{x:462,y:132,width:64,height:64},id10:{x:396,y:66,width:64,height:64},id11:{x:396,y:0,width:64,height:64},id12:{x:330,y:462,width:64,height:64},id13:{x:330,y:396,width:64,height:64},id14:{x:330,y:330,width:64,height:64},id15:{x:330,y:264,width:64,height:64},id16:{x:330,y:198,width:64,height:64},id17:{x:330,y:132,width:64,height:64},id18:{x:330,y:66,width:64,height:64},id19:{x:330,y:0,width:64,height:64},id2:{x:462,y:66,width:64,height:64},id20:{x:264,y:462,width:64,height:64},id21:{x:264,y:396,width:64,height:64},id22:{x:264,y:330,width:64,height:64},id23:{x:264,y:264,width:64,height:64},id24:{x:264,y:198,width:64,height:64},id25:{x:264,y:132,width:64,height:64},id26:{x:264,y:66,width:64,height:64},id27:{x:264,y:0,width:64,height:64},id28:{x:198,y:462,width:64,height:64},id29:{x:198,y:396,width:64,height:64},id3:{x:462,y:0,width:64,height:64},id30:{x:462,y:198,width:64,height:64},id31:{x:198,y:264,width:64,height:64},id32:{x:198,y:198,width:64,height:64},id33:{x:198,y:132,width:64,height:64},id34:{x:198,y:66,width:64,height:64},id35:{x:198,y:0,width:64,height:64},id36:{x:132,y:462,width:64,height:64},id37:{x:132,y:396,width:64,height:64},id38:{x:132,y:330,width:64,height:64},id39:{x:132,y:264,width:64,height:64},id4:{x:396,y:462,width:64,height:64},id40:{x:132,y:198,width:64,height:64},id41:{x:132,y:132,width:64,height:64},id42:{x:132,y:66,width:64,height:64},id43:{x:132,y:0,width:64,height:64},id44:{x:66,y:462,width:64,height:64},id45:{x:66,y:396,width:64,height:64},id46:{x:66,y:330,width:64,height:64},id47:{x:66,y:264,width:64,height:64},id48:{x:66,y:198,width:64,height:64},id49:{x:66,y:132,width:64,height:64},id5:{x:396,y:396,width:64,height:64},id50:{x:66,y:66,width:64,height:64},id51:{x:66,y:0,width:64,height:64},id52:{x:0,y:462,width:64,height:64},id53:{x:0,y:396,width:64,height:64},id54:{x:0,y:330,width:64,height:64},id55:{x:0,y:264,width:64,height:64},id56:{x:0,y:198,width:64,height:64},id57:{x:0,y:132,width:64,height:64},id58:{x:0,y:66,width:64,height:64},id59:{x:0,y:0,width:64,height:64},id6:{x:396,y:330,width:64,height:64},id7:{x:396,y:264,width:64,height:64},id8:{x:396,y:198,width:64,height:64},id9:{x:396,y:132,width:64,height:64}}},{id:"wheels",file:"images/wheels.png",oAtlasData:{id0:{x:74,y:296,width:72,height:72},id1:{x:222,y:296,width:71,height:72},id10:{x:222,y:222,width:72,height:72},id11:{x:74,y:222,width:72,height:72},id12:{x:74,y:148,width:72,height:72},id13:{x:74,y:74,width:72,height:72},id14:{x:74,y:0,width:72,height:72},id15:{x:0,y:296,width:72,height:72},id16:{x:0,y:222,width:72,height:72},id17:{x:0,y:148,width:72,height:72},id18:{x:0,y:74,width:72,height:72},id19:{x:0,y:0,width:72,height:72},id2:{x:222,y:148,width:72,height:72},id3:{x:222,y:74,width:72,height:72},id4:{x:222,y:0,width:72,height:72},id5:{x:148,y:296,width:72,height:72},id6:{x:148,y:222,width:72,height:72},id7:{x:148,y:148,width:72,height:72},id8:{x:148,y:74,width:72,height:72},id9:{x:148,y:0,width:72,height:72}}},{id:"hudElements",file:"images/"+curLang+"/hudElements.png",oAtlasData:{id0:{x:468,y:825,width:450,height:22},id1:{x:1015,y:562,width:122,height:163},id10:{x:1015,y:727,width:112,height:81},id11:{x:0,y:660,width:577,height:163},id12:{x:0,y:263,width:577,height:227},id13:{x:0,y:604,width:577,height:54},id14:{x:0,y:548,width:577,height:54},id15:{x:814,y:946,width:204,height:165},id16:{x:579,y:635,width:216,height:136},id17:{x:811,y:429,width:216,height:131},id18:{x:468,y:946,width:344,height:70},id19:{x:0,y:492,width:577,height:54},id2:{x:1025,y:96,width:106,height:165},id20:{x:811,y:291,width:216,height:136},id21:{x:0,y:825,width:466,height:95},id22:{x:579,y:194,width:304,height:95},id23:{x:0,y:1037,width:466,height:95},id24:{x:579,y:97,width:304,height:95},id25:{x:885,y:96,width:138,height:171},id26:{x:0,y:0,width:577,height:261},id27:{x:579,y:0,width:304,height:95},id28:{x:884,y:849,width:176,height:94},id29:{x:885,y:0,width:175,height:94},id3:{x:1029,y:263,width:105,height:104},id30:{x:468,y:1018,width:324,height:95},id31:{x:468,y:849,width:414,height:95},id32:{x:797,y:635,width:216,height:136},id33:{x:0,y:922,width:466,height:113},id4:{x:468,y:1115,width:128,height:12},id5:{x:1020,y:945,width:112,height:95},id6:{x:579,y:549,width:230,height:84},id7:{x:579,y:377,width:230,height:84},id8:{x:579,y:291,width:230,height:84},id9:{x:579,y:463,width:230,height:84}}},{id:"car0",file:"images/car0.png",oAtlasData:{id0:{x:0,y:126,width:351,height:112},id1:{x:0,y:354,width:351,height:112},id10:{x:0,y:0,width:430,height:20},id2:{x:0,y:468,width:351,height:112},id3:{x:0,y:582,width:351,height:112},id4:{x:0,y:240,width:351,height:112},id5:{x:353,y:126,width:314,height:78},id6:{x:0,y:88,width:401,height:36},id7:{x:0,y:22,width:430,height:20},id8:{x:0,y:44,width:430,height:20},id9:{x:0,y:66,width:430,height:20}}},{id:"car1",file:"images/car1.png",oAtlasData:{id0:{x:0,y:126,width:404,height:113},id1:{x:0,y:356,width:404,height:113},id10:{x:0,y:0,width:455,height:20},id2:{x:0,y:471,width:404,height:113},id3:{x:0,y:586,width:404,height:113},id4:{x:0,y:241,width:404,height:113},id5:{x:406,y:126,width:333,height:76},id6:{x:0,y:88,width:431,height:36},id7:{x:0,y:22,width:455,height:20},id8:{x:0,y:44,width:455,height:20},id9:{x:0,y:66,width:455,height:20}}},{id:"car2",file:"images/car2.png",oAtlasData:{id0:{x:0,y:244,width:425,height:116},id1:{x:0,y:362,width:425,height:116},id10:{x:0,y:0,width:455,height:20},id2:{x:0,y:480,width:425,height:116},id3:{x:0,y:598,width:425,height:116},id4:{x:0,y:126,width:426,height:116},id5:{x:427,y:244,width:328,height:76},id6:{x:0,y:88,width:441,height:36},id7:{x:0,y:22,width:455,height:20},id8:{x:0,y:44,width:455,height:20},id9:{x:0,y:66,width:455,height:20}}},{id:"car3",file:"images/car3.png",oAtlasData:{id0:{x:0,y:125,width:398,height:116},id1:{x:0,y:361,width:398,height:116},id10:{x:0,y:0,width:428,height:20},id2:{x:0,y:479,width:398,height:116},id3:{x:0,y:597,width:398,height:116},id4:{x:0,y:243,width:398,height:116},id5:{x:400,y:125,width:351,height:73},id6:{x:0,y:88,width:401,height:35},id7:{x:0,y:22,width:428,height:20},id8:{x:0,y:44,width:428,height:20},id9:{x:0,y:66,width:428,height:20}}},{id:"car4",file:"images/car4.png",oAtlasData:{id0:{x:0,y:133,width:400,height:94},id1:{x:0,y:325,width:400,height:94},id10:{x:0,y:0,width:450,height:22},id2:{x:0,y:421,width:400,height:94},id3:{x:0,y:517,width:400,height:94},id4:{x:0,y:229,width:400,height:94},id5:{x:0,y:613,width:338,height:69},id6:{x:0,y:96,width:433,height:35},id7:{x:0,y:24,width:450,height:22},id8:{x:0,y:48,width:450,height:22},id9:{x:0,y:72,width:450,height:22}}},{id:"car5",file:"images/car5.png",oAtlasData:{id0:{x:0,y:157,width:429,height:96},id1:{x:0,y:353,width:429,height:96},id10:{x:0,y:0,width:474,height:28},id2:{x:0,y:451,width:429,height:96},id3:{x:0,y:549,width:429,height:96},id4:{x:0,y:255,width:429,height:96},id5:{x:0,y:647,width:364,height:64},id6:{x:0,y:120,width:461,height:35},id7:{x:0,y:30,width:474,height:28},id8:{x:0,y:60,width:474,height:28},id9:{x:0,y:90,width:474,height:28}}},{id:"car6",file:"images/car6.png",oAtlasData:{id0:{x:0,y:149,width:400,height:96},id1:{x:0,y:345,width:400,height:96},id10:{x:0,y:0,width:463,height:26},id2:{x:0,y:443,width:400,height:96},id3:{x:0,y:541,width:400,height:96},id4:{x:0,y:247,width:400,height:96},id5:{x:0,y:639,width:349,height:63},id6:{x:0,y:112,width:452,height:35},id7:{x:0,y:28,width:463,height:26},id8:{x:0,y:56,width:463,height:26},id9:{x:0,y:84,width:463,height:26}}},{id:"car7",file:"images/car7.png",oAtlasData:{id0:{x:0,y:149,width:420,height:90},id1:{x:0,y:333,width:420,height:90},id10:{x:0,y:0,width:463,height:26},id2:{x:0,y:425,width:420,height:90},id3:{x:0,y:517,width:420,height:90},id4:{x:0,y:241,width:420,height:90},id5:{x:0,y:609,width:353,height:64},id6:{x:0,y:112,width:457,height:35},id7:{x:0,y:28,width:463,height:26},id8:{x:0,y:56,width:463,height:26},id9:{x:0,y:84,width:463,height:26}}},{id:"car8",file:"images/car8.png",oAtlasData:{id0:{x:0,y:149,width:440,height:98},id1:{x:0,y:349,width:440,height:98},id10:{x:0,y:0,width:463,height:26},id2:{x:0,y:449,width:440,height:98},id3:{x:0,y:549,width:440,height:98},id4:{x:0,y:249,width:440,height:98},id5:{x:0,y:649,width:353,height:68},id6:{x:0,y:112,width:456,height:35},id7:{x:0,y:28,width:463,height:26},id8:{x:0,y:56,width:463,height:26},id9:{x:0,y:84,width:463,height:26}}},{id:"car9",file:"images/car9.png",oAtlasData:{id0:{x:0,y:149,width:402,height:98},id1:{x:0,y:349,width:402,height:98},id10:{x:0,y:0,width:446,height:26},id2:{x:0,y:449,width:402,height:98},id3:{x:0,y:549,width:402,height:98},id4:{x:0,y:249,width:402,height:98},id5:{x:0,y:649,width:356,height:61},id6:{x:0,y:112,width:438,height:35},id7:{x:0,y:28,width:446,height:26},id8:{x:0,y:56,width:446,height:26},id9:{x:0,y:84,width:446,height:26}}},{id:"car10",file:"images/car10.png",oAtlasData:{id0:{x:0,y:149,width:424,height:104},id1:{x:0,y:361,width:424,height:104},id10:{x:0,y:0,width:463,height:26},id2:{x:0,y:467,width:424,height:104},id3:{x:0,y:573,width:424,height:104},id4:{x:0,y:255,width:424,height:104},id5:{x:0,y:679,width:349,height:62},id6:{x:0,y:112,width:449,height:35},id7:{x:0,y:28,width:463,height:26},id8:{x:0,y:56,width:463,height:26},id9:{x:0,
y:84,width:463,height:26}}},{id:"car11",file:"images/car11.png",oAtlasData:{id0:{x:0,y:149,width:444,height:104},id1:{x:0,y:361,width:444,height:104},id10:{x:0,y:0,width:480,height:26},id2:{x:0,y:467,width:444,height:104},id3:{x:0,y:573,width:444,height:104},id4:{x:0,y:255,width:444,height:104},id5:{x:0,y:679,width:338,height:64},id6:{x:0,y:112,width:461,height:35},id7:{x:0,y:28,width:480,height:26},id8:{x:0,y:56,width:480,height:26},id9:{x:0,y:84,width:480,height:26}}},{id:"carLogos",file:"images/carLogos.png",oAtlasData:{id0:{x:466,y:0,width:163,height:145},id1:{x:257,y:0,width:207,height:156},id10:{x:465,y:158,width:181,height:155},id11:{x:0,y:398,width:230,height:130},id2:{x:0,y:142,width:248,height:100},id3:{x:463,y:537,width:161,height:134},id4:{x:0,y:546,width:193,height:118},id5:{x:463,y:391,width:198,height:144},id6:{x:232,y:398,width:229,height:146},id7:{x:0,y:0,width:255,height:140},id8:{x:0,y:244,width:242,height:152},id9:{x:244,y:244,width:219,height:145}}},{id:"panels1",file:"images/"+curLang+"/panels1_700x450.png"},{id:"panels2",file:"images/"+curLang+"/panels2_700x450.png"},{id:"numbers1",file:"images/numbers1_26x38.png"},{id:"numbers2",file:"images/numbers2_29x55.png"},{id:"roadBg0",file:"images/roadBg0.jpg"},{id:"roadBg1",file:"images/roadBg1.jpg"},{id:"roadBg2",file:"images/roadBg2.jpg"},{id:"muteBut",file:"images/mute_59x59.png"},{id:"exhaust",file:"images/exhaust_111x40.png",oAnims:{exploding:[0,1,2,3,4,5,6,7,8,9,10]}},{id:"smoke",file:"images/smoke_81x83.png",oAnims:{exploding:[0,1,2,3,4,5,6,7,8,9,10,11,12]}},{id:"firework",file:"images/firework_145x131.png",oAnims:{exploding:[0,1,2,3,4,5,6,7,8,9,10,11,12]}},{id:"endRaceVideoPrompt",file:"images/"+curLang+"/endRaceVideoPrompt_199x107.png"}],ctx,canvas.width,canvas.height),oImageIds.distBar="id0",oImageIds.accPedal="id1",oImageIds.gearChange="id2",oImageIds.boostBut="id3",oImageIds.revNeedle="id4",oImageIds.revMeter="id5",oImageIds.startLights0="id6",oImageIds.startLights1="id7",oImageIds.startLights2="id8",oImageIds.startLights3="id9",oImageIds.startRevMeter="id10",oImageIds.endLoseMessage="id11",oImageIds.endWinMessage="id12",oImageIds.perfectMessage="id13",oImageIds.greatStartMessage="id14",oImageIds.revTip="id15",oImageIds.gearTip1="id16",oImageIds.nitroTip="id17",oImageIds.upgradeTip="id18",oImageIds.goodMessage="id19",oImageIds.gearTip2="id20",oImageIds.raceSelectTip="id21",oImageIds.firstLoseTip="id22",oImageIds.firstWinTip="id23",oImageIds.firstWinResultTip="id24",oImageIds.gearHighlight="id25",oImageIds.newLocationMessage="id26",oImageIds.newLocationTip="id27",oImageIds.distBehindMarker="id28",oImageIds.distInFrontMarker="id29",oImageIds.customiseNewCarTip="id30",oImageIds.sellOldCarTip="id31",oImageIds.gearTip1Keyboard="id32",oImageIds.raceEndVideoTip="id33",oImageIds.fillBar="id0",oImageIds.stageBar="id1",oImageIds.accIcon="id2",oImageIds.engineIcon="id3",oImageIds.nitroIcon="id4",oImageIds.weightIcon="id5",oImageIds.wheelsIcon="id6",oImageIds.stage1Text="id7",oImageIds.stage2Text="id8",oImageIds.stage3Text="id9",oImageIds.stage4Text="id10",oImageIds.stage5Text="id11",oImageIds.engine1Text="id12",oImageIds.engine2Text="id13",oImageIds.engine3Text="id14",oImageIds.engine4Text="id15",oImageIds.engine5Text="id16",oImageIds.acc1Text="id17",oImageIds.acc2Text="id18",oImageIds.acc3Text="id19",oImageIds.acc4Text="id20",oImageIds.acc5Text="id21",oImageIds.nitro1Text="id22",oImageIds.nitro2Text="id23",oImageIds.nitro3Text="id24",oImageIds.nitro4Text="id25",oImageIds.nitro5Text="id26",oImageIds.weight1Text="id27",oImageIds.weight2Text="id28",oImageIds.weight3Text="id29",oImageIds.weight4Text="id30",oImageIds.weight5Text="id31",oImageIds.wheels1Text="id32",oImageIds.wheels2Text="id33",oImageIds.wheels3Text="id34",oImageIds.wheels4Text="id35",oImageIds.wheels5Text="id36",oImageIds.careerInfo="id37",oImageIds.quickRaceInfo="id38",oImageIds.careerPreview0="id39",oImageIds.licenseRequired="id40",oImageIds.boughtOverlay="id41",oImageIds.lockedOverlay="id42",oImageIds.upgradePreviewBar="id43",oImageIds.raceLostTitle="id44",oImageIds.raceWonTitle="id45",oImageIds.newLevelBadge="id46",oImageIds.stageWonTitle="id47",oImageIds.nitroJet="id48",oImageIds.upgradeScreenTip="id49",oImageIds.customiseScreenTip="id50",oImageIds.shopScreenTip="id51",oImageIds.careerPreview1="id52",oImageIds.careerPreview2="id53",oImageIds.quickRacePin="id54",oImageIds.lockedRacePin="id55",oImageIds.careerRacePin0="id56",oImageIds.careerRacePin1="id57",oImageIds.careerRacePin2="id58",oImageIds.careerRacePin3="id59",oImageIds.careerRaceWonPin0="id60",oImageIds.careerRaceWonPin1="id61",oImageIds.careerRaceWonPin2="id62",oImageIds.careerRaceWonPin3="id63",oImageIds.finger="id64",oImageIds.newPinText="id65",oImageIds.boughtMarker="id66",oImageIds.previewStageText="id67",oImageIds.previewStageReplayText="id68",oImageIds.videoBoostTip="id69",oImageIds.videoIcon="id70",oImageIds.videoLockedOverlay="id71",oImageIds.videoBuyOverlay="id72",oImageIds.colour0="id0",oImageIds.colour1="id1",oImageIds.colour2="id2",oImageIds.colour3="id3",oImageIds.colour4="id4",oImageIds.brakes="id5",oImageIds.shadow0="id6",oImageIds.shadow1="id7",oImageIds.shadow2="id8",oImageIds.shadow3="id9",oImageIds.shadow4="id10",oImageIds.creditsBut="id0",oImageIds.moreGamesBut="id1",oImageIds.garageBut="id2",oImageIds.raceBut="id3",oImageIds.shopBut="id4",oImageIds.upgradeBut="id5",oImageIds.customiseBut="id6",oImageIds.leftBut="id7",oImageIds.rightBut="id8",oImageIds.backBut="id9",oImageIds.buyBut="id10",oImageIds.upgradeTabOff0="id11",oImageIds.upgradeTabOff1="id12",oImageIds.upgradeTabOff2="id13",oImageIds.upgradeTabOff3="id14",oImageIds.upgradeTabOff4="id15",oImageIds.customiseTabOff0="id16",oImageIds.customiseTabOff1="id17",oImageIds.customiseTabOff2="id18",oImageIds.upgradeTabOn0="id19",oImageIds.upgradeTabOn1="id20",oImageIds.upgradeTabOn2="id21",oImageIds.upgradeTabOn3="id22",oImageIds.upgradeTabOn4="id23",oImageIds.customiseTabOn0="id24",oImageIds.customiseTabOn1="id25",oImageIds.customiseTabOn2="id26",oImageIds.careerOffBut="id27",oImageIds.careerOnBut="id28",oImageIds.quickRaceOffBut="id29",oImageIds.quickRaceOnBut="id30",oImageIds.easyOnBut="id31",oImageIds.mediumOnBut="id32",oImageIds.hardOnBut="id33",oImageIds.easyOffBut="id34",oImageIds.mediumOffBut="id35",oImageIds.hardOffBut="id36",oImageIds.clearDataBut="id37",oImageIds.customiseButOn="id38",oImageIds.customiseButOff="id39",oImageIds.sellBut="id40",oImageIds.restartBut="id41",oImageIds.quitBut="id42",oImageIds.continueBut="id43",oImageIds.autoUpgradeBut="id44",oImageIds.mapBut="id45",oImageIds.statsBut="id46",oImageIds.getBoostBut="id47",oImageIds.noThanksBut="id48",oImageIds.readyToRaceBut="id49",oImageIds.customiseVideoButOn="id50",oImageIds.customiseVideoButOff="id51",oImageIds.upgradeVideoBoostBut="id52",assetLib.onReady(initSplash)}function resizeCanvas(){var a=window.innerWidth,b=window.innerHeight;a>480&&(a-=1,b-=1),window.innerWidth<window.innerHeight&&isMobile?("loading"!=gameState&&rotatePauseOn(),canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):isMobile?(rotatePause&&rotatePauseOff(),a/canvas.width<b/canvas.height?(canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):(canvas.style.width=b/canvas.height*canvas.width+"px",canvas.style.height=b+"px",canvasX=(a-b/canvas.height*canvas.width)/2,canvasY=0,canvasScaleX=canvasScaleY=canvas.height/b,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px")):(rotatePause&&rotatePauseOff(),a/canvas.width<b/canvas.height?(canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):(canvas.style.width=b/canvas.height*canvas.width+"px",canvas.style.height=b+"px",canvasX=(a-b/canvas.height*canvas.width)/2,canvasY=0,canvasScaleX=canvasScaleY=canvas.height/b,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px")),userInput.setCanvas(canvasX,canvasY,canvasScaleX,canvasScaleY)}function playSound(a,b){"undefined"==typeof b&&(b=1),1==audioType&&(sound.play(a),sound.volume(b))}function toggleMute(){muted=!muted,1==audioType?muted?Howler.mute():Howler.unmute():2==audioType&&(muted?music.pause():music.play()),renderMuteBut()}function renderMuteBut(){if(0!=audioType){var a=assetLib.getData("muteBut"),b=0;muted&&(b=1);var c=b*a.oData.spriteWidth%a.img.width,d=Math.floor(b/(a.img.width/a.oData.spriteWidth))*a.oData.spriteHeight;ctx.drawImage(a.img,c,d,a.oData.spriteWidth,a.oData.spriteHeight,638,5,a.oData.spriteWidth,a.oData.spriteHeight)}}function toggleManualPause(){if(manualPause)manualPause=!1,userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("moreGamesPause"),userInput.removeHitArea("restartFromPause"),userInput.removeHitArea("clearData"),pauseCoreOff();else{manualPause=!0,pauseCoreOn();var a={oImgData:assetLib.getData("uiButs"),aPos:[81,414],id:oImageIds.quitBut},b={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2+85,canvas.height/2],id:oImageIds.continueBut},c={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2-85,canvas.height/2],id:oImageIds.restartBut},d=new Array(a,b,c);userInput.addHitArea("quitFromPause",butEventHandler,null,"image",a),userInput.addHitArea("resumeFromPause",butEventHandler,null,"image",b),userInput.addHitArea("restartFromPause",butEventHandler,null,"image",c),panel=new Elements.Panel("pause",d),panel.render(ctx),userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,60,58]},!0)}}function rotatePauseOn(){rotatePause=!0,ctx.drawImage(assetLib.getImg("rotateDeviceMessage"),0,0),userInput.pauseIsOn=!0,pauseCoreOn()}function rotatePauseOff(){rotatePause=!1,userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("moreGamesPause"),pauseCoreOff()}function pauseCoreOn(){switch(1==audioType?Howler.mute():2==audioType&&music.pause(),gameState){case"start":break;case"help":break;case"race":userRevTween&&userRevTween.pause(),enemyRevTween&&enemyRevTween.pause(),userNitroTween&&userNitroTween.pause(),enemyNitroTween&&enemyNitroTween.pause(),userInput.removeHitArea("accPedal"),userInput.removeHitArea("gearChange"),userInput.removeKey("gearChange"),userInput.removeHitArea("nitroBoost");break;case"end":}}function pauseCoreOff(){switch(1==audioType?muted||Howler.unmute():2==audioType&&(muted||music.play()),previousTime=(new Date).getTime(),userInput.pauseIsOn=!1,gameState){case"raceSelect":initRaceSelect();break;case"garage":initGarage();break;case"racePreview":initRacePreview();break;case"shop":initShop("shop");break;case"customise":initCustomise();break;case"upgrade":initUpgrade("garage");break;case"race":manualPause?(manualPause=!1,updateRaceEvent(),toggleManualPause()):(userRevTween&&userRevTween.play(),enemyRevTween&&enemyRevTween.play(),userNitroTween&&userNitroTween.play(),enemyNitroTween&&enemyNitroTween.play(),userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,68,68]},!0),0==oRaceProgress.time?userInput.addHitArea("accPedal",butEventHandler,{multiTouch:!0},"rect",{aRect:[558,126,684,290]},!0):(userInput.addHitArea("gearChange",butEventHandler,null,"rect",{aRect:[524,324,680,canvas.height]},!0),userInput.addKey("gearChange",butEventHandler,null,32)),!oRaceProgress.userBoostTriggered&&userCar.oCarTypeData.nitro>0&&userInput.addHitArea("nitroBoost",butEventHandler,null,"rect",{aRect:[58,341,148,433]},!0),updateRaceEvent());break;case"raceComplete":initRaceCompleteDisplay()}}var Utils;!function(a){var b=function(){function a(a,b,c,d,e,f){"undefined"==typeof f&&(f=!0),this.oAssetData={},this.assetsLoaded=0,this.totalAssets=b.length,this.ctx=c,this.canvasWidth=d,this.canvasHeight=e,this.showBar=f,this.topLeftX=this.canvasWidth/2-d/4,this.topLeftY=360,this.showBar&&(ctx.strokeStyle="#C24901",ctx.lineWidth=2,ctx.fillStyle="#FF9A00",ctx.moveTo(this.topLeftX,this.topLeftY),ctx.lineTo(this.topLeftX+d/2,this.topLeftY+0),ctx.lineTo(this.topLeftX+d/2,this.topLeftY+20),ctx.lineTo(this.topLeftX+0,this.topLeftY+20),ctx.lineTo(this.topLeftX+0,this.topLeftY+0),ctx.stroke());for(var g=0;g<b.length;g++)this.loadImage(b[g])}return a.prototype.loadImage=function(a){var b=this,c=new Image;c.onload=function(){b.oAssetData[a.id]={},b.oAssetData[a.id].img=c,b.oAssetData[a.id].oData={};var d=b.getSpriteSize(a.file);0!=d[0]?(b.oAssetData[a.id].oData.spriteWidth=d[0],b.oAssetData[a.id].oData.spriteHeight=d[1]):(b.oAssetData[a.id].oData.spriteWidth=b.oAssetData[a.id].img.width,b.oAssetData[a.id].oData.spriteHeight=b.oAssetData[a.id].img.height),a.oAnims&&(b.oAssetData[a.id].oData.oAnims=a.oAnims),a.oAtlasData?b.oAssetData[a.id].oData.oAtlasData=a.oAtlasData:b.oAssetData[a.id].oData.oAtlasData={none:{x:0,y:0,width:b.oAssetData[a.id].oData.spriteWidth,height:b.oAssetData[a.id].oData.spriteHeight}},++b.assetsLoaded,b.showBar&&ctx.fillRect(b.topLeftX+2,b.topLeftY+2,(b.canvasWidth/2-4)/b.totalAssets*b.assetsLoaded,16),b.checkLoadComplete()},c.src=a.file},a.prototype.getSpriteSize=function(a){for(var b=new Array,c="",d="",e=0,f=a.lastIndexOf("."),g=!0;g;)f--,0==e&&this.isNumber(a.charAt(f))?c=a.charAt(f)+c:0==e&&c.length>0&&"x"==a.charAt(f)?(f--,e=1,d=a.charAt(f)+d):1==e&&this.isNumber(a.charAt(f))?d=a.charAt(f)+d:1==e&&d.length>0&&"_"==a.charAt(f)?(g=!1,b=[parseInt(d),parseInt(c)]):(g=!1,b=[0,0]);return b},a.prototype.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.prototype.checkLoadComplete=function(){this.assetsLoaded==this.totalAssets&&this.loadedCallback()},a.prototype.onReady=function(a){this.loadedCallback=a},a.prototype.getImg=function(a){return this.oAssetData[a].img},a.prototype.getData=function(a){return this.oAssetData[a]},a}();a.AssetLoader=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b,c,d){this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.frameInc=0,this.animType="loop",this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.oImgData=a,this.oAnims=this.oImgData.oData.oAnims,this.fps=b,this.radius=c,this.animId=d,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2)}return a.prototype.updateAnimation=function(a){this.frameInc+=this.fps*a},a.prototype.changeImgData=function(a,b){this.oImgData=a,this.oAnims=this.oImgData.oData.oAnims,this.animId=b,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2),this.resetAnim()},a.prototype.resetAnim=function(){this.frameInc=0},a.prototype.setFrame=function(a){this.fixedFrame=a},a.prototype.setAnimType=function(a,b,c){switch("undefined"==typeof c&&(c=!0),this.animId=b,this.animType=a,c&&this.resetAnim(),a){case"loop":break;case"once":this.maxIdx=this.oAnims[this.animId].length-1}},a.prototype.render=function(a){if(a.save(),a.translate(this.x,this.y),a.rotate(this.rotation),a.scale(this.scaleX,this.scaleY),a.globalAlpha=this.alpha,null!=this.animId){var b=this.oAnims[this.animId].length,c=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][c%b];var d=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&c>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][b-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var d=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var d=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;a.drawImage(this.oImgData.img,d,e,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.centreX+this.offsetX,-this.centreY+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),a.restore()},a.prototype.renderSimple=function(a){if(null!=this.animId){var b=this.oAnims[this.animId].length,c=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][c%b];var d=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&c>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][b-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var d=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var d=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,e=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;a.drawImage(this.oImgData.img,d,e,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,this.x-(this.centreX-this.offsetX)*this.scaleX,this.y-(this.centreY-this.offsetY)*this.scaleY,this.oImgData.oData.spriteWidth*this.scaleX,this.oImgData.oData.spriteHeight*this.scaleY)},a}();a.AnimSprite=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b,c){"undefined"==typeof c&&(c=0),this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.oImgData=a,this.radius=b,this.setFrame(c)}return a.prototype.setFrame=function(a){this.frameNum=a},a.prototype.render=function(a){a.save(),a.translate(this.x,this.y),a.rotate(this.rotation),a.scale(this.scaleX,this.scaleY);var b=this.frameNum*this.oImgData.oData.spriteWidth%this.oImgData.img.width,c=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;a.drawImage(this.oImgData.img,b,c,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),a.restore()},a}();a.BasicSprite=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b){var c=this;this.canvasX=0,this.canvasY=0,this.canvasScaleX=1,this.canvasScaleY=1,this.prevHitTime=0,this.pauseIsOn=!1,this.isDown=!1,this.isDetectingKeys=!1,this.isBugBrowser=b,a.addEventListener("touchstart",function(a){for(var b=0;b<a.changedTouches.length;b++)c.hitDown(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier)},!1),a.addEventListener("touchend",function(a){for(var b=0;b<a.changedTouches.length;b++)c.hitUp(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier)},!1),a.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++)c.move(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier,!0)},!1),a.addEventListener("mousedown",function(a){c.isDown=!0,c.hitDown(a,a.pageX,a.pageY,1)},!1),a.addEventListener("mouseup",function(a){c.isDown=!1,c.hitUp(a,a.pageX,a.pageY,1)},!1),a.addEventListener("mousemove",function(a){c.move(a,a.pageX,a.pageY,1,c.isDown)},!1),this.aHitAreas=new Array,this.aKeys=new Array}return a.prototype.setCanvas=function(a,b,c,d){this.canvasX=a,this.canvasY=b,this.canvasScaleX=c,this.canvasScaleY=d},a.prototype.hitDown=function(a,b,c,d){if(a.preventDefault(),a.stopPropagation(),!this.pauseIsOn){var e=(new Date).getTime();b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var f=0;f<this.aHitAreas.length;f++)if(this.aHitAreas[f].rect&&b>this.aHitAreas[f].area[0]&&c>this.aHitAreas[f].area[1]&&b<this.aHitAreas[f].area[2]&&c<this.aHitAreas[f].area[3]){if(this.aHitAreas[f].aTouchIdentifiers.push(d),this.aHitAreas[f].oData.hasLeft=!1,!this.aHitAreas[f].oData.isDown){if(this.aHitAreas[f].oData.isDown=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,e-this.prevHitTime<500&&("game"!=gameState||"pause"==this.aHitAreas[f].id)&&isBugBrowser)return;this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData)}break}this.prevHitTime=e}},a.prototype.hitUp=function(a,b,c,d){if(ios9FirstTouch||(playSound("silence"),ios9FirstTouch=!0),!this.pauseIsOn){a.preventDefault(),a.stopPropagation(),b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var e=0;e<this.aHitAreas.length;e++)if(this.aHitAreas[e].rect&&b>this.aHitAreas[e].area[0]&&c>this.aHitAreas[e].area[1]&&b<this.aHitAreas[e].area[2]&&c<this.aHitAreas[e].area[3]){for(var f=0;f<this.aHitAreas[e].aTouchIdentifiers.length;f++)this.aHitAreas[e].aTouchIdentifiers[f]==d&&(this.aHitAreas[e].aTouchIdentifiers.splice(f,1),f-=1);0==this.aHitAreas[e].aTouchIdentifiers.length&&(this.aHitAreas[e].oData.isDown=!1,this.aHitAreas[e].oData.multiTouch&&(this.aHitAreas[e].oData.x=b,this.aHitAreas[e].oData.y=c,this.aHitAreas[e].callback(this.aHitAreas[e].id,this.aHitAreas[e].oData)));break}}},a.prototype.move=function(a,b,c,d,e){if(!this.pauseIsOn&&e){b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var f=0;f<this.aHitAreas.length;f++)if(this.aHitAreas[f].rect)if(b>this.aHitAreas[f].area[0]&&c>this.aHitAreas[f].area[1]&&b<this.aHitAreas[f].area[2]&&c<this.aHitAreas[f].area[3])this.aHitAreas[f].oData.hasLeft=!1,this.aHitAreas[f].oData.isDown||(this.aHitAreas[f].oData.isDown=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,this.aHitAreas[f].aTouchIdentifiers.push(d),this.aHitAreas[f].oData.multiTouch&&this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData)),this.aHitAreas[f].oData.isDraggable&&(this.aHitAreas[f].oData.isBeingDragged=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData),this.aHitAreas[f].oData.isBeingDragged=!1);else if(this.aHitAreas[f].oData.isDown&&!this.aHitAreas[f].oData.hasLeft){for(var g=0;g<this.aHitAreas[f].aTouchIdentifiers.length;g++)this.aHitAreas[f].aTouchIdentifiers[g]==d&&(this.aHitAreas[f].aTouchIdentifiers.splice(g,1),g-=1);0==this.aHitAreas[f].aTouchIdentifiers.length&&(this.aHitAreas[f].oData.hasLeft=!0,this.aHitAreas[f].oData.isBeingDragged||(this.aHitAreas[f].oData.isDown=!1),this.aHitAreas[f].oData.multiTouch&&this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData))}}},a.prototype.keyDown=function(a){for(var b=0;b<this.aKeys.length;b++)a.keyCode==this.aKeys[b].keyCode&&(this.aKeys[b].oData.isDown=!0,this.aKeys[b].callback(this.aKeys[b].id,this.aKeys[b].oData))},a.prototype.keyUp=function(a){for(var b=0;b<this.aKeys.length;b++)a.keyCode==this.aKeys[b].keyCode&&(this.aKeys[b].oData.isDown=!1,this.aKeys[b].callback(this.aKeys[b].id,this.aKeys[b].oData))},a.prototype.addKey=function(a,b,c,d){var e=this;this.isDetectingKeys||(window.focus(),window.addEventListener("keydown",function(a){e.keyDown(a)},!1),window.addEventListener("keyup",function(a){e.keyUp(a)},!1),this.isDetectingKeys=!0),null==c&&(c=new Object),this.aKeys.push({id:a,callback:b,oData:c,keyCode:d})},a.prototype.removeKey=function(a){for(var b=0;b<this.aKeys.length;b++)this.aKeys[b].id==a&&(this.aKeys.splice(b,1),b-=1)},a.prototype.addHitArea=function(a,b,c,d,e,f){"undefined"==typeof f&&(f=!1),null==c&&(c=new Object),f&&this.removeHitArea(a),e.scale||(e.scale=1);var g=new Array;switch(d){case"image":var h;h=new Array(e.aPos[0]-e.oImgData.oData.oAtlasData[e.id].width/2*e.scale,e.aPos[1]-e.oImgData.oData.oAtlasData[e.id].height/2*e.scale,e.aPos[0]+e.oImgData.oData.oAtlasData[e.id].width/2*e.scale,e.aPos[1]+e.oImgData.oData.oAtlasData[e.id].height/2*e.scale),this.aHitAreas.push({id:a,aTouchIdentifiers:g,callback:b,oData:c,rect:!0,area:h});break;case"rect":this.aHitAreas.push({id:a,aTouchIdentifiers:g,callback:b,oData:c,rect:!0,area:e.aRect})}},a.prototype.removeHitArea=function(a){for(var b=0;b<this.aHitAreas.length;b++)this.aHitAreas[b].id==a&&(this.aHitAreas.splice(b,1),b-=1)},a.prototype.resetAll=function(){for(var a=0;a<this.aHitAreas.length;a++)this.aHitAreas[a].oData.isDown=!1,this.aHitAreas[a].oData.isBeingDragged=!1,this.aHitAreas[a].aTouchIdentifiers=new Array;this.isDown=!1},a}();a.UserInput=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a){this.updateFreq=10,this.updateInc=0,this.frameAverage=0,this.display=1,this.log="",this.render=function(a){this.frameAverage+=this.delta/this.updateFreq,++this.updateInc>=this.updateFreq&&(this.updateInc=0,this.display=this.frameAverage,this.frameAverage=0),a.textAlign="left",ctx.font="10px Helvetica",a.fillStyle="#333333",a.beginPath(),a.rect(0,this.canvasHeight-15,40,15),a.closePath(),a.fill(),a.fillStyle="#ffffff",a.fillText(Math.round(1e3/(1e3*this.display))+" fps "+this.log,5,this.canvasHeight-5)},this.canvasHeight=a}return a.prototype.update=function(a){this.delta=a},a}();a.FpsMeter=b}(Utils||(Utils={}));var Elements;!function(a){var b=function(){function a(a){this.x=0,this.y=0,this.targY=0,this.incY=0,this.renderState="none",this.oImgData=assetLib.getData(a)}return a.prototype.setMapPos=function(){switch(Math.seedrandom(pinPage),pinPage%4){case 0:this.oMapPosData={leftX:Math.random()*(this.oImgData.img.width-canvas.width),leftY:Math.random()*(this.oImgData.img.height-canvas.height),scaleX:1,scaleY:1,rightX:0,rightY:0};break;case 1:this.oMapPosData={leftX:Math.random()*(this.oImgData.img.width-canvas.width),leftY:Math.random()*(this.oImgData.img.height-canvas.height),scaleX:-1,scaleY:1,rightX:-canvas.width,rightY:0};break;case 2:this.oMapPosData={leftX:Math.random()*(this.oImgData.img.width-canvas.width),leftY:Math.random()*(this.oImgData.img.height-canvas.height),scaleX:1,scaleY:-1,rightX:0,rightY:-canvas.height};break;case 3:this.oMapPosData={leftX:Math.random()*(this.oImgData.img.width-canvas.width),leftY:Math.random()*(this.oImgData.img.height-canvas.height),scaleX:-1,scaleY:-1,rightX:-canvas.width,rightY:-canvas.height}}},a.prototype.update=function(a){switch(this.renderState){case"menuScroll":this.incY+=5*a,this.x=this.x-50*Math.sin(this.incY/10)*a,this.y=this.y-50*a;break;case"none":}},a.prototype.render=function(a){switch(this.renderState){case"menuScroll":this.x=this.x%canvas.width,this.y=this.y%canvas.height,this.x<0&&(this.x+=canvas.width),this.y<0&&(this.y+=canvas.height),a.drawImage(this.oImgData.img,this.x,this.y,canvas.width,canvas.height,0,0,canvas.width,canvas.height);break;case"none":a.drawImage(this.oImgData.img,0,0);break;case"map":ctx.save(),ctx.scale(this.oMapPosData.scaleX,this.oMapPosData.scaleY),a.drawImage(this.oImgData.img,this.oMapPosData.leftX,this.oMapPosData.leftY,canvas.width,canvas.height,this.oMapPosData.rightX,this.oMapPosData.rightY,canvas.width,canvas.height),ctx.restore()}},a}();a.Background=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c){this.inc=0,this.oSplashScreenImgData=a,this.canvasWidth=b,this.canvasHeight=c,this.posY=-this.canvasHeight,TweenLite.to(this,.5,{posY:0})}return a.prototype.render=function(a,b){this.inc+=5*b,a.drawImage(this.oSplashScreenImgData.img,0,0-this.posY)},a}();a.Splash=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function b(a,b){this.number1Space=18,this.timer=.3,this.endTime=0,this.posY=0,this.numberSpace=17,this.incY=0,this.flareRot=0,this.messageX=1400,this.oPanels1ImgData=assetLib.getData("panels1"),this.oPanels2ImgData=assetLib.getData("panels2"),this.oNumbers1ImgData=assetLib.getData("numbers1"),this.oTopFlareImgData=assetLib.getData("topFlare"),this.oUiElementsImgData=assetLib.getData("uiElements"),this.oUiButsImgData=assetLib.getData("uiButs"),this.oCarLogosImgData=assetLib.getData("carLogos"),this.oColoursImgData=assetLib.getData("colours"),this.oHudElementsImgData=assetLib.getData("hudElements"),this.oWheelImgData=assetLib.getData("wheels"),this.oEndRaceVideoPromptImgData=assetLib.getData("endRaceVideoPrompt"),this.panelType=a,this.aButs=b}return b.prototype.update=function(a){this.incY+=10*a},b.prototype.startTween1=function(){this.posY=550,TweenLite.to(this,.5,{posY:0,ease:"Quint.easeOut"})},b.prototype.startTween2=function(){this.posY=550,TweenLite.to(this,.5,{posY:0,ease:"Quint.easeOut"})},b.prototype.newMapMessage=function(){this.messageX=1400,this.messageTween=TweenLite.to(this,.3,{messageX:canvas.width/2,ease:"Cubic.easeOut",onComplete:this.removeMessageAtEnd,onCompleteParams:[this]})},b.prototype.removeMessageAtEnd=function(a){a.messageTween=TweenLite.to(a,.3,{messageX:-700,ease:"Cubic.easeIn",delay:2})},b.prototype.garageScrollEvent=function(b){"left"==b&&oUserCareerData.curCarId>0?(oUserCareerData.curCarId--,userCar=new a.Car(!0,aUserGarageData[oUserCareerData.curCarId])):"right"==b&&oUserCareerData.curCarId<aUserGarageData.length-1&&(oUserCareerData.curCarId++,userCar=new a.Car(!0,aUserGarageData[oUserCareerData.curCarId]))},b.prototype.shopScrollEvent=function(b){"left"==b&&curShopCarId>0?(curShopCarId--,userCar=new a.Car(!0,aCarBaseData[curShopCarId])):"right"==b&&curShopCarId<aCarBaseData.length-1&&(curShopCarId++,userCar=new a.Car(!0,aCarBaseData[curShopCarId]))},b.prototype.customiseScrollEvent=function(a){"left"==a&&curRimScroll>0?curRimScroll--:"right"==a&&14>curRimScroll&&curRimScroll++},b.prototype.render=function(a,b){switch("undefined"==typeof b&&(b=!0),b||this.addButs(a),this.flareRot+=delta/10,this.panelType){case"credits":var c=0,d=c*this.oPanels1ImgData.oData.spriteWidth%this.oPanels1ImgData.img.width,e=Math.floor(c/(this.oPanels1ImgData.img.width/this.oPanels1ImgData.oData.spriteWidth))*this.oPanels1ImgData.oData.spriteHeight;a.drawImage(this.oPanels1ImgData.img,d,e,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight,0,0+this.posY,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight);break;case"stats":this.renderTopFlare();var c=4,d=c*this.oPanels1ImgData.oData.spriteWidth%this.oPanels1ImgData.img.width,e=Math.floor(c/(this.oPanels1ImgData.img.width/this.oPanels1ImgData.oData.spriteWidth))*this.oPanels1ImgData.oData.spriteHeight;a.drawImage(this.oPanels1ImgData.img,d,e,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight,0,0+this.posY,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.racesWon.toString().length;f++){c=parseFloat(oUserCareerData.racesWon.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,380+f*this.number1Space*.55,170+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<oUserCareerData.totalWinnings.toString().length;f++){c=parseFloat(oUserCareerData.totalWinnings.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,380+f*this.number1Space*.55,198+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<oUserCareerData.totalDistance.toString().length;f++){
c=parseFloat(oUserCareerData.totalDistance.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,380+f*this.number1Space*.55,226+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}c=11;var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,380+oUserCareerData.totalDistance.toString().length*this.number1Space*.55,226+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.carsOwned.toString().length;f++){c=parseFloat(oUserCareerData.carsOwned.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,380+f*this.number1Space*.55,254+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}break;case"racePreview":var c=3,d=c*this.oPanels1ImgData.oData.spriteWidth%this.oPanels1ImgData.img.width,e=Math.floor(c/(this.oPanels1ImgData.img.width/this.oPanels1ImgData.oData.spriteWidth))*this.oPanels1ImgData.oData.spriteHeight;if(a.drawImage(this.oPanels1ImgData.img,d,e,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight,0,0+this.posY,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight),"career"==raceType||"prevCareer"==raceType){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds["careerPreview"+this.oRaceData.background]].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds["careerPreview"+this.oRaceData.background]].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds["careerPreview"+this.oRaceData.background]].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds["careerPreview"+this.oRaceData.background]].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,495,127+this.posY,i,j);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.careerInfo].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.careerInfo].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.careerInfo].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.careerInfo].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,493,61+this.posY,i,j);for(var k=oUserCareerData.careerRace,f=0;f<oUserCareerData.careerStage-1;f++)k+=getRaceNumInStage(f+1);if("career"==raceType){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageText].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageText].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageText].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageText].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,507,133.5+this.posY,i,j);for(var f=0;f<k.toString().length;f++){c=parseFloat(k.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,560+f*this.number1Space*.55,135.5+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}}else if("prevCareer"==raceType){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageReplayText].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageReplayText].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageReplayText].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.previewStageReplayText].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,507,133.5+this.posY,i,j)}this.showRaceData();var l=Math.sin(60*this.flareRot)/20+.37;ctx.save(),ctx.globalAlpha=1,ctx.translate(614,380+this.posY),ctx.scale(l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(614,380+this.posY),ctx.scale(l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}else{var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.quickRaceInfo].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.quickRaceInfo].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.quickRaceInfo].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.quickRaceInfo].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,495,53+this.posY,i,j),this.showRaceData()}break;case"raceSelect":a.fillStyle=aMapColours[pinPage%aMapColours.length]+(Math.sin(50*this.flareRot)/15+.25)+")",a.fillRect(0,0,canvas.width,canvas.height);var c=1,d=c*this.oPanels1ImgData.oData.spriteWidth%this.oPanels1ImgData.img.width,e=Math.floor(c/(this.oPanels1ImgData.img.width/this.oPanels1ImgData.oData.spriteWidth))*this.oPanels1ImgData.oData.spriteHeight;a.drawImage(this.oPanels1ImgData.img,d,e,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight,0,0+this.posY,this.oPanels1ImgData.oData.spriteWidth,this.oPanels1ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;if(ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j),this.showPins(),firstRun){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceSelectTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceSelectTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceSelectTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceSelectTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,10,349+this.posY,i,j)}else if(!firstRun&&2==oUserCareerData.careerRace&&1==oUserCareerData.careerStage){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,10,292+this.posY,i,j)}if(this.messageX>-700){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationMessage].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationMessage].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationMessage].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationMessage].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,this.messageX-i/2,207-j/2,i,j)}break;case"garage":if(this.renderTopFlare(),newCarBought){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.customiseNewCarTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.customiseNewCarTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.customiseNewCarTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.customiseNewCarTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,20,288+this.posY,i,j);var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(440,408+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(440,408+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}else if(aUserGarageData.length>1&&oUserCareerData.cash<getAutoUpgradeCost()){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.sellOldCarTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.sellOldCarTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.sellOldCarTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.sellOldCarTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,20,288+this.posY,i,j)}var c=0,d=c*this.oPanels2ImgData.oData.spriteWidth%this.oPanels2ImgData.img.width,e=Math.floor(c/(this.oPanels2ImgData.img.width/this.oPanels2ImgData.oData.spriteWidth))*this.oPanels2ImgData.oData.spriteHeight;a.drawImage(this.oPanels2ImgData.img,d,e+1,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight-2,0,0+this.posY,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;if(ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j),aUserGarageData.length>1){var g=this.oUiButsImgData.oData.oAtlasData[oImageIds.sellBut].x,h=this.oUiButsImgData.oData.oAtlasData[oImageIds.sellBut].y,i=this.oUiButsImgData.oData.oAtlasData[oImageIds.sellBut].width,j=this.oUiButsImgData.oData.oAtlasData[oImageIds.sellBut].height;ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,515-i/2,249-j/2+this.posY,i,j);for(var n=getSellCost(),f=0;f<n.toString().length;f++){c=parseFloat(n.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,478+f*this.number1Space*.55,250+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}}var o=3*Math.sin(200*this.flareRot),g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,86+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].engine,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,111+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].gearBox,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,136+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].grip,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,161+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].weight,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,186+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].nitro,j+o);for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].engine).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].engine).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,86+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].gearBox).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].gearBox).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,111+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].grip).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].grip).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,136+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].weight).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].weight).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,161+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].nitro).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].nitro).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,186+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<getRating(aUserGarageData[oUserCareerData.curCarId]).toString().length;f++){c=parseFloat(getRating(aUserGarageData[oUserCareerData.curCarId]).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,436+f*this.number1Space*.55,212+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}var g=this.oCarLogosImgData.oData.oAtlasData["id"+aUserGarageData[oUserCareerData.curCarId].body].x,h=this.oCarLogosImgData.oData.oAtlasData["id"+aUserGarageData[oUserCareerData.curCarId].body].y,i=this.oCarLogosImgData.oData.oAtlasData["id"+aUserGarageData[oUserCareerData.curCarId].body].width,j=this.oCarLogosImgData.oData.oAtlasData["id"+aUserGarageData[oUserCareerData.curCarId].body].height;ctx.drawImage(this.oCarLogosImgData.img,g,h,i,j,190-i/2,92+this.posY,i,j);break;case"shop":this.renderTopFlare();for(var p=!1,f=0;f<aUserGarageData.length;f++)aUserGarageData[f].body==aCarBaseData[curShopCarId].body&&(p=!0);if(!p&&aCarBaseData[curShopCarId].cost<oUserCareerData.cash){var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}var c=1,d=c*this.oPanels2ImgData.oData.spriteWidth%this.oPanels2ImgData.img.width,e=Math.floor(c/(this.oPanels2ImgData.img.width/this.oPanels2ImgData.oData.spriteWidth))*this.oPanels2ImgData.oData.spriteHeight;a.drawImage(this.oPanels2ImgData.img,d,e+1,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight-2,0,0+this.posY,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j);var o=3*Math.sin(200*this.flareRot),g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,86+this.posY-o/2,147*aCarBaseData[curShopCarId].engine,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,111+this.posY-o/2,147*aCarBaseData[curShopCarId].gearBox,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,136+this.posY-o/2,147*aCarBaseData[curShopCarId].grip,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,161+this.posY-o/2,147*aCarBaseData[curShopCarId].weight,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,444,186+this.posY-o/2,147*aCarBaseData[curShopCarId].nitro,j+o);for(var f=0;f<(1e3*aCarBaseData[curShopCarId].engine).toString().length;f++){c=parseFloat((1e3*aCarBaseData[curShopCarId].engine).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,86+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aCarBaseData[curShopCarId].gearBox).toString().length;f++){c=parseFloat((1e3*aCarBaseData[curShopCarId].gearBox).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,111+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aCarBaseData[curShopCarId].grip).toString().length;f++){c=parseFloat((1e3*aCarBaseData[curShopCarId].grip).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,136+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aCarBaseData[curShopCarId].weight).toString().length;f++){c=parseFloat((1e3*aCarBaseData[curShopCarId].weight).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,161+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aCarBaseData[curShopCarId].nitro).toString().length;f++){c=parseFloat((1e3*aCarBaseData[curShopCarId].nitro).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,594+f*this.number1Space*.55,186+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<getRating(aCarBaseData[curShopCarId]).toString().length;f++){c=parseFloat(getRating(aCarBaseData[curShopCarId]).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,436+f*this.number1Space*.55,212+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}var g=this.oCarLogosImgData.oData.oAtlasData["id"+aCarBaseData[curShopCarId].body].x,h=this.oCarLogosImgData.oData.oAtlasData["id"+aCarBaseData[curShopCarId].body].y,i=this.oCarLogosImgData.oData.oAtlasData["id"+aCarBaseData[curShopCarId].body].width,j=this.oCarLogosImgData.oData.oAtlasData["id"+aCarBaseData[curShopCarId].body].height;ctx.drawImage(this.oCarLogosImgData.img,g,h,i,j,190-i/2,92+this.posY,i,j);for(var f=0;f<aCarBaseData[curShopCarId].cost.toString().length;f++){c=parseFloat(aCarBaseData[curShopCarId].cost.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,522+f*this.number1Space,389+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}if(p){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,477,351+this.posY,i,j)}else if(aCarBaseData[curShopCarId].cost>oUserCareerData.cash){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,469,328+this.posY,i,j)}break;case"upgrade":this.renderTopFlare();var p=!1;if(5==aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]&&(p=!0,u=0),!p&&curUpgradeCost<=oUserCareerData.cash){var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}var q=getAutoUpgradeCost(),c=2,d=c*this.oPanels2ImgData.oData.spriteWidth%this.oPanels2ImgData.img.width,e=Math.floor(c/(this.oPanels2ImgData.img.width/this.oPanels2ImgData.oData.spriteWidth))*this.oPanels2ImgData.oData.spriteHeight;a.drawImage(this.oPanels2ImgData.img,d,e+1,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight-2,0,0+this.posY,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;
ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j);var o=3*Math.sin(200*this.flareRot),g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464,152+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].engine,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464,177+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].gearBox,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464,202+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].grip,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464,227+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].weight,j+o);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464,252+this.posY-o/2,147*aUserGarageData[oUserCareerData.curCarId].nitro,j+o);for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].engine).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].engine).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,614+f*this.number1Space*.55,152+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].gearBox).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].gearBox).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,614+f*this.number1Space*.55,177+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].grip).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].grip).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,614+f*this.number1Space*.55,202+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].weight).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].weight).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,614+f*this.number1Space*.55,227+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<(1e3*aUserGarageData[oUserCareerData.curCarId].nitro).toString().length;f++){c=parseFloat((1e3*aUserGarageData[oUserCareerData.curCarId].nitro).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,614+f*this.number1Space*.55,252+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<getRating(aUserGarageData[oUserCareerData.curCarId]).toString().length;f++){c=parseFloat(getRating(aUserGarageData[oUserCareerData.curCarId]).toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,456+f*this.number1Space*.55,278+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<curUpgradeCost.toString().length;f++){c=parseFloat(curUpgradeCost.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,522+f*this.number1Space,389+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var r,s,t,u,f=0;5>f;f++){switch(r=oImageIds["upgradeTabOff"+f],upgradeTab){case"engine":0==f&&(r=oImageIds["upgradeTabOn"+f]),u=Math.round(100*((aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].engine.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].engine)/5))/100,t=aUserGarageData[oUserCareerData.curCarId].engine,s=0;break;case"acc":1==f&&(r=oImageIds["upgradeTabOn"+f]),u=Math.round(100*((aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].acc.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].gearBox)/5))/100,t=aUserGarageData[oUserCareerData.curCarId].gearBox,s=1;break;case"wheels":2==f&&(r=oImageIds["upgradeTabOn"+f]),u=Math.round(100*((aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].wheels.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].grip)/5))/100,t=aUserGarageData[oUserCareerData.curCarId].grip,s=2;break;case"weight":3==f&&(r=oImageIds["upgradeTabOn"+f]),u=Math.round(100*((aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].weight.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].weight)/5))/100,t=aUserGarageData[oUserCareerData.curCarId].weight,s=3;break;case"nitro":4==f&&(r=oImageIds["upgradeTabOn"+f]),u=Math.round(100*((aUpgradeData[aUserGarageData[oUserCareerData.curCarId].body].nitro.maxUpgradeLevel-aCarBaseData[aUserGarageData[oUserCareerData.curCarId].body].nitro)/5))/100,t=aUserGarageData[oUserCareerData.curCarId].nitro,s=4}var g=this.oUiButsImgData.oData.oAtlasData[r].x,h=this.oUiButsImgData.oData.oAtlasData[r].y,i=this.oUiButsImgData.oData.oAtlasData[r].width,j=this.oUiButsImgData.oData.oAtlasData[r].height;ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,23+130*f,125-j+this.posY,i,j)}if(q<oUserCareerData.cash&&0!=q){var g=this.oUiButsImgData.oData.oAtlasData[oImageIds.autoUpgradeBut].x,h=this.oUiButsImgData.oData.oAtlasData[oImageIds.autoUpgradeBut].y,i=this.oUiButsImgData.oData.oAtlasData[oImageIds.autoUpgradeBut].width,j=this.oUiButsImgData.oData.oAtlasData[oImageIds.autoUpgradeBut].height;ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,350-i/2,401-j/2+this.posY,i,j);for(var f=0;f<q.toString().length;f++){c=parseFloat(q.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,307+f*(.75*this.number1Space),398+this.posY,.75*this.oNumbers1ImgData.oData.spriteWidth,.75*this.oNumbers1ImgData.oData.spriteHeight)}}else if(canShowVideo&&0!=q){var g=this.oUiButsImgData.oData.oAtlasData[oImageIds.upgradeVideoBoostBut].x,h=this.oUiButsImgData.oData.oAtlasData[oImageIds.upgradeVideoBoostBut].y,i=this.oUiButsImgData.oData.oAtlasData[oImageIds.upgradeVideoBoostBut].width,j=this.oUiButsImgData.oData.oAtlasData[oImageIds.upgradeVideoBoostBut].height;ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,350-i/2,401-j/2+this.posY,i,j)}if(p){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,477,351+this.posY,i,j)}else if(curUpgradeCost>oUserCareerData.cash){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,469,328+this.posY,i,j)}var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+"Icon"]].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+"Icon"]].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+"Icon"]].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+"Icon"]].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,57,145+this.posY,i,j);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds["stage"+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds["stage"+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds["stage"+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds["stage"+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,248,150+this.posY,i,j);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds[upgradeTab+Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]+1)+"Text"]].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,166,184+this.posY,i,j);for(var f=0;f<curUpgradeCost.toString().length;f++){c=parseFloat(curUpgradeCost.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,83+f*this.number1Space*.55,331+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var f=0;f<Math.min(5,aUserGarageData[oUserCareerData.curCarId][upgradeTab+"Upgrade"]);f++){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.stageBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.stageBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.stageBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.stageBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,56+44.5*f,295+this.posY-o/2,i,j+o)}var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradePreviewBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradePreviewBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradePreviewBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradePreviewBar].height;if("weight"==upgradeTab?ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464+147*t-5*t+147*u,148+25*s+this.posY,-147*u,j):ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,464+147*t-5*t,148+25*s+this.posY,147*u,j),1==aUserGarageData.length&&getUpgradeTotal()<5&&q>oUserCareerData.cash){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradeScreenTip].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradeScreenTip].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradeScreenTip].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.upgradeScreenTip].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,156,383+this.posY,i,j)}break;case"customise":this.renderTopFlare();var p=!1;switch(customiseTab){case"colour":for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length;v++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aColoursOwned[v]){p=!0;break}break;case"rims":for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length;v++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aRimsOwned[v]){p=!0;break}break;case"shadow":for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length;v++)if(curCustomiseButHighlight==aUserGarageData[oUserCareerData.curCarId].aNeonOwned[v]){p=!0;break}}if(!p&&(curCustomiseCost<=oUserCareerData.cash||isVideoCustomise(curCustomiseButHighlight))&&(isVideoCustomise(curCustomiseButHighlight)&&canShowVideo||!isVideoCustomise(curCustomiseButHighlight))){var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(579,394+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}var c=3,d=c*this.oPanels2ImgData.oData.spriteWidth%this.oPanels2ImgData.img.width,e=Math.floor(c/(this.oPanels2ImgData.img.width/this.oPanels2ImgData.oData.spriteWidth))*this.oPanels2ImgData.oData.spriteHeight;a.drawImage(this.oPanels2ImgData.img,d,e+1,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight-2,0,0+this.posY,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight);for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j);for(var r,f=0;3>f;f++){switch(r=oImageIds["customiseTabOff"+f],customiseTab){case"colour":0==f&&(r=oImageIds["customiseTabOn"+f]);break;case"rims":1==f&&(r=oImageIds["customiseTabOn"+f]);break;case"shadow":2==f&&(r=oImageIds["customiseTabOn"+f])}var g=this.oUiButsImgData.oData.oAtlasData[r].x,h=this.oUiButsImgData.oData.oAtlasData[r].y,i=this.oUiButsImgData.oData.oAtlasData[r].width,j=this.oUiButsImgData.oData.oAtlasData[r].height;ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,148+130*f,125-j+this.posY,i,j)}var w=5;"rims"==customiseTab?w=6:"shadow"==customiseTab&&(w=6);for(var f=0;w>f;f++){r=oImageIds.customiseButOff,isVideoCustomise(f+curRimScroll)&&(r=oImageIds.customiseVideoButOff),curCustomiseButHighlight==f+curRimScroll&&(r=oImageIds.customiseButOn,isVideoCustomise(f+curRimScroll)&&(r=oImageIds.customiseVideoButOn));var g=this.oUiButsImgData.oData.oAtlasData[r].x,h=this.oUiButsImgData.oData.oAtlasData[r].y,i=this.oUiButsImgData.oData.oAtlasData[r].width,j=this.oUiButsImgData.oData.oAtlasData[r].height;if(ctx.drawImage(this.oUiButsImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j),"colour"==customiseTab){var g=this.oColoursImgData.oData.oAtlasData["id"+(5*aUserGarageData[oUserCareerData.curCarId].body+f)].x,h=this.oColoursImgData.oData.oAtlasData["id"+(5*aUserGarageData[oUserCareerData.curCarId].body+f)].y,i=this.oColoursImgData.oData.oAtlasData["id"+(5*aUserGarageData[oUserCareerData.curCarId].body+f)].width,j=this.oColoursImgData.oData.oAtlasData["id"+(5*aUserGarageData[oUserCareerData.curCarId].body+f)].height;ctx.drawImage(this.oColoursImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j);for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aColoursOwned.length;v++)if(f==aUserGarageData[oUserCareerData.curCarId].aColoursOwned[v]){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j);break}}else if("rims"==customiseTab){var g=this.oWheelImgData.oData.oAtlasData["id"+(f+curRimScroll)].x,h=this.oWheelImgData.oData.oAtlasData["id"+(f+curRimScroll)].y,i=this.oWheelImgData.oData.oAtlasData["id"+(f+curRimScroll)].width,j=this.oWheelImgData.oData.oAtlasData["id"+(f+curRimScroll)].height;ctx.drawImage(this.oWheelImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j);for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aRimsOwned.length;v++)if(f+curRimScroll==aUserGarageData[oUserCareerData.curCarId].aRimsOwned[v]){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j);break}}else{c=f+1;var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,118-this.oNumbers1ImgData.oData.spriteWidth/2+93*f,180-this.oNumbers1ImgData.oData.spriteHeight/2+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight);for(var v=0;v<aUserGarageData[oUserCareerData.curCarId].aNeonOwned.length;v++)if(f==aUserGarageData[oUserCareerData.curCarId].aNeonOwned[v]){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtMarker].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,118-i/2+93*f,180-j/2+this.posY,i,j);break}}if(isVideoCustomise(f+curRimScroll)){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoIcon].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoIcon].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoIcon].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoIcon].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,100-i/2+93*f,160-j/2+this.posY,i,j)}}if(isVideoCustomise(curCustomiseButHighlight))if(canShowVideo||p){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBuyOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBuyOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBuyOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBuyOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,471,343+this.posY,i,j)}else{var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoLockedOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoLockedOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoLockedOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoLockedOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,469,328+this.posY,i,j)}else for(var f=0;f<curCustomiseCost.toString().length;f++){c=parseFloat(curCustomiseCost.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,522+f*this.number1Space,389+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}if(p){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.boughtOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,477,351+this.posY,i,j)}else if(curCustomiseCost>oUserCareerData.cash&&!isVideoCustomise(curCustomiseButHighlight)){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.lockedOverlay].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,469,328+this.posY,i,j)}if(1==aUserGarageData.length&&getCutomBonus()<30){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.customiseScreenTip].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.customiseScreenTip].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.customiseScreenTip].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.customiseScreenTip].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,156,383+this.posY,i,j)}break;case"raceComplete":if(this.renderTopFlare(),shouldShowUpgradeTip()){var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(440,408+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(440,408+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}var c=2,d=c*this.oPanels1ImgData.oData.spriteWidth%this.oPanels1ImgData.img.width,e=Math.floor(c/(this.oPanels1ImgData.img.width/this.oPanels1ImgData.oData.spriteWidth))*this.oPanels1ImgData.oData.spriteHeight;if(a.drawImage(this.oPanels1ImgData.img,d,e+1,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight-2,0,0+this.posY,this.oPanels2ImgData.oData.spriteWidth,this.oPanels2ImgData.oData.spriteHeight),canShowRaceEndVideoBonusPrompt()&&!videoRaceEndShown){var l=Math.sin(60*this.flareRot)/20+.3;ctx.save(),ctx.globalAlpha=1,ctx.translate(470,279+this.posY),ctx.scale(2*l,l),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(470,279+this.posY),ctx.scale(2*l,l),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}for(var f=0;f<oUserCareerData.cash.toString().length;f++){c=parseFloat(oUserCareerData.cash.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,44+f*this.number1Space,11+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}for(var m=Math.floor(oUserCareerData.levelNum/100),f=0;f<m.toString().length;f++){c=parseFloat(m.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,587+f*this.number1Space*.55,9+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}m=(oUserCareerData.levelNum-100*m)/100;var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.fillBar].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,545,31.5+this.posY,81*(m+.01),j),this.renderTime(oRaceProgress.userFinishTime,258,128.5),this.renderTime(oRaceProgress.enemyFinishTime,478,128.5);var r=oImageIds.raceWonTitle;oRaceProgress.userFinishTime>oRaceProgress.enemyFinishTime?r=oImageIds.raceLostTitle:1==oUserCareerData.careerRace&&(r=oImageIds.stageWonTitle);var g=this.oUiElementsImgData.oData.oAtlasData[r].x,h=this.oUiElementsImgData.oData.oAtlasData[r].y,i=this.oUiElementsImgData.oData.oAtlasData[r].width,j=this.oUiElementsImgData.oData.oAtlasData[r].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,canvas.width/2-i/2,75+this.posY,i,j),this.renderTime(oRaceProgress.userFinishTime,258,128.5),this.renderTime(oRaceProgress.enemyFinishTime,478,128.5);for(var f=0;f<oRaceProgress.reward.toString().length;f++){c=parseFloat(oRaceProgress.reward.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,292+f*this.number1Space*.55,175+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var x=oRaceProgress.timeBonus.toString(),f=0;f<x.length;f++){c=parseFloat(x.charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,513+f*this.number1Space*.55,175+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var x=getCutomBonus().toString(),f=0;f<x.length;f++){c=parseFloat(x.charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,292+f*this.number1Space*.55,205+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var x=(50*Math.floor(oUserCareerData.levelNum/100)).toString(),f=0;f<x.length;f++){c=parseFloat(x.charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,513+f*this.number1Space*.55,205+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}x=(10*oRaceProgress.startMultiplier).toString(),1==x.length&&(x+="0");for(var f=0;f<x.length;f++){c=parseFloat(x.charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,308+f*(this.number1Space+8)*.55,235+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}x=(10*oRaceProgress.gearShiftMultiplier).toString(),1==x.length&&(x+="0");for(var f=0;f<x.length;f++){c=parseFloat(x.charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,308+f*(this.number1Space+8)*.55,265+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight);
}for(var f=0;f<oRaceProgress.totalReward.toString().length;f++){c=parseFloat(oRaceProgress.totalReward.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,236+f*this.number1Space,303+this.posY,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}if(canShowRaceEndVideoBonusPrompt())if(videoRaceEndShown){var c=5,d=c*this.oEndRaceVideoPromptImgData.oData.spriteWidth%this.oEndRaceVideoPromptImgData.img.width,e=Math.floor(c/(this.oEndRaceVideoPromptImgData.img.width/this.oEndRaceVideoPromptImgData.oData.spriteWidth))*this.oEndRaceVideoPromptImgData.oData.spriteHeight;ctx.drawImage(this.oEndRaceVideoPromptImgData.img,d,e,this.oEndRaceVideoPromptImgData.oData.spriteWidth,this.oEndRaceVideoPromptImgData.oData.spriteHeight,370,234+this.posY,this.oEndRaceVideoPromptImgData.oData.spriteWidth,this.oEndRaceVideoPromptImgData.oData.spriteHeight);for(var y=getRaceEndVideoBonus(),f=0;f<y.toString().length;f++){c=parseFloat(y.toString().charAt(f));var d=c*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(c/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,509+f*this.number1Space*.55,276+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}}else{var d=raceEndBonusId*this.oEndRaceVideoPromptImgData.oData.spriteWidth%this.oEndRaceVideoPromptImgData.img.width,e=Math.floor(raceEndBonusId/(this.oEndRaceVideoPromptImgData.img.width/this.oEndRaceVideoPromptImgData.oData.spriteWidth))*this.oEndRaceVideoPromptImgData.oData.spriteHeight;ctx.drawImage(this.oEndRaceVideoPromptImgData.img,d,e,this.oEndRaceVideoPromptImgData.oData.spriteWidth,this.oEndRaceVideoPromptImgData.oData.spriteHeight,370,234+this.posY,this.oEndRaceVideoPromptImgData.oData.spriteWidth,this.oEndRaceVideoPromptImgData.oData.spriteHeight)}if(oRaceProgress.newLevel){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newLevelBadge].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newLevelBadge].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newLevelBadge].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newLevelBadge].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,512-i/2,31-j/2+this.posY,i,j)}if(shouldShowUpgradeTip()){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.upgradeTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.upgradeTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.upgradeTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.upgradeTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,180-i/2,405-j/2+this.posY,i,j)}if(firstRun||1!=oUserCareerData.careerRace||1!=oUserCareerData.careerStage){if(!firstRun&&2==oUserCareerData.careerRace&&1==oUserCareerData.careerStage&&oRaceProgress.userFinishTime<oRaceProgress.enemyFinishTime)if(canShowRaceEndVideoBonusPrompt()){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceEndVideoTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceEndVideoTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceEndVideoTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.raceEndVideoTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,68,332+this.posY,i,j)}else{var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinResultTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinResultTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinResultTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstWinResultTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,222,349+this.posY,i,j)}else if(newPinPage){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.newLocationTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,222,349+this.posY,i,j)}}else{var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstLoseTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstLoseTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstLoseTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.firstLoseTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,222,349+this.posY,i,j)}break;case"pause":a.fillStyle="rgba(0, 0, 0, 0.75)",a.fillRect(0,0,canvas.width,canvas.height);break;case"videoBoostOffer":a.fillStyle="rgba(0, 0, 0, 1)",a.fillRect(0,0,canvas.width,canvas.height);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBoostTip].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBoostTip].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBoostTip].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.videoBoostTip].height;ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,canvas.width/2-i/2,118,i,j)}b&&this.addButs(a)},b.prototype.renderTime=function(a,b,c){a=Math.round(a);var d=Math.floor(a/6e3).toString(),e=Math.floor((a-6e3*Math.floor(a/6e3))/100).toString();e.length<2&&(e="0"+e);var f=a.toString().charAt(a.toString().length-2)+a.toString().charAt(a.toString().length-1);f.length<2&&(f="0"+f);for(var g=0;2>g;g++){var h=parseFloat(d.charAt(g));if(d.length<2){if(0==g)continue;h=parseFloat(d.charAt(0))}var i=h*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,j=Math.floor(h/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,i,j,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,b,c+this.posY,Math.round(.75*this.oNumbers1ImgData.oData.spriteWidth),Math.round(.75*this.oNumbers1ImgData.oData.spriteHeight))}for(var g=0;2>g;g++){var h=parseFloat(e.charAt(g)),i=h*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,j=Math.floor(h/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,i,j,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,b+23+g*this.number1Space*.75,c+this.posY,.75*this.oNumbers1ImgData.oData.spriteWidth,.75*this.oNumbers1ImgData.oData.spriteHeight)}for(var g=0;2>g;g++){var h=parseFloat(f.charAt(g)),i=h*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,j=Math.floor(h/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,i,j,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,b+58+g*this.number1Space*.5,c+2+this.posY,.5*this.oNumbers1ImgData.oData.spriteWidth,.5*this.oNumbers1ImgData.oData.spriteHeight)}},b.prototype.showRaceData=function(){for(var a=0;a<this.oRaceData.reward.toString().length;a++){var b=parseFloat(this.oRaceData.reward.toString().charAt(a)),c=b*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,d=Math.floor(b/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,c,d,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,609+a*this.number1Space*.55,229+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var a=0;a<this.oRaceData.rating.toString().length;a++){b=parseFloat(this.oRaceData.rating.toString().charAt(a));var c=b*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,d=Math.floor(b/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,c,d,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,609+a*this.number1Space*.55,260.5+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}for(var a=0;a<this.oRaceData.distance.toString().length;a++){b=parseFloat(this.oRaceData.distance.toString().charAt(a));var c=b*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,d=Math.floor(b/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,c,d,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,609+a*this.number1Space*.55,292+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)}b=11;var c=b*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,d=Math.floor(b/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,c,d,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,609+this.oRaceData.distance.toString().length*this.number1Space*.55,292+this.posY,.55*this.oNumbers1ImgData.oData.spriteWidth,.55*this.oNumbers1ImgData.oData.spriteHeight)},b.prototype.showPins=function(){for(var a=pinPage*pinsPerMap;pinPage*pinsPerMap+pinsPerMap>a&&!(a>=aPinDisplay.length);a++){var b,c=0,d=0;switch(aPinDisplay[a].state){case 0:b=oImageIds.lockedRacePin;break;case 1:case 2:b=oImageIds["careerRacePin"+getDifficulty(aPinDisplay[a])],c=-Math.max(this.posY,0),d=3*Math.sin(this.incY+45*a);break;case 3:b=oImageIds.quickRacePin,c=-Math.max(this.posY,0),d=3*Math.sin(this.incY+45*a);break;case 4:b=oImageIds["careerRaceWonPin"+getDifficulty(aPinDisplay[a])]}if(1==aPinDisplay[a].state||2==aPinDisplay[a].state){var e=Math.sin(60*this.flareRot)/30+.2;ctx.save(),ctx.globalAlpha=1,ctx.translate(aPinPos[aPinDisplay[a].posId].x,aPinPos[aPinDisplay[a].posId].y-20+c),ctx.scale(e,e),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=1,ctx.translate(aPinPos[aPinDisplay[a].posId].x,aPinPos[aPinDisplay[a].posId].y-20+c),ctx.scale(e,e),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()}var f=this.oUiElementsImgData.oData.oAtlasData[b].x,g=this.oUiElementsImgData.oData.oAtlasData[b].y,h=this.oUiElementsImgData.oData.oAtlasData[b].width,i=this.oUiElementsImgData.oData.oAtlasData[b].height;if(ctx.drawImage(this.oUiElementsImgData.img,f,g,h,i,aPinPos[aPinDisplay[a].posId].x-h/2-d/2,aPinPos[aPinDisplay[a].posId].y-i/2+c+d,h+d,i-d),1==aPinDisplay[a].state){var f=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newPinText].x,g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newPinText].y,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newPinText].width,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.newPinText].height;ctx.drawImage(this.oUiElementsImgData.img,f,g,h,i,aPinPos[aPinDisplay[a].posId].x-h/2-d/2,aPinPos[aPinDisplay[a].posId].y+15-i/2+c+d,h+d,i-d)}if(firstRun&&1==aPinDisplay[a].state){var f=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].x,g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].y,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].width,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].height;ctx.drawImage(this.oUiElementsImgData.img,f,g,h,i,aPinPos[aPinDisplay[a].posId].x-h/2,aPinPos[aPinDisplay[a].posId].y+15-i/2+c-4*d-100,h,i)}}},b.prototype.renderTopFlare=function(){var a=1;ctx.save(),ctx.globalAlpha=.6,ctx.translate(canvas.width/2,-50),ctx.scale(3*a,1.5*a),ctx.rotate(this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore(),ctx.save(),ctx.globalAlpha=.6,ctx.translate(canvas.width/2,-50),ctx.scale(3*a,1.5*a),ctx.rotate(-this.flareRot),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()},b.prototype.addButs=function(a){for(var b=0;b<this.aButs.length;b++){if("garage"==this.panelType){if(this.aButs[b].id==oImageIds.leftBut&&oUserCareerData.curCarId<1)continue;if(this.aButs[b].id==oImageIds.rightBut&&oUserCareerData.curCarId>aUserGarageData.length-2)continue}else if("shop"==this.panelType){if(this.aButs[b].id==oImageIds.leftBut&&1>curShopCarId)continue;if(this.aButs[b].id==oImageIds.rightBut&&curShopCarId>aCarBaseData.length-2)continue}else if("customise"==this.panelType){if("rims"==customiseTab&&this.aButs[b].id==oImageIds.leftBut&&1>curRimScroll)continue;if("rims"==customiseTab&&this.aButs[b].id==oImageIds.rightBut&&curRimScroll>13)continue;if("rims"!=customiseTab&&(this.aButs[b].id==oImageIds.rightBut||this.aButs[b].id==oImageIds.leftBut))continue}var c=this.posY,d=0;0==this.incY||this.aButs[b].noMove||(d=3*Math.sin(this.incY+45*b)),this.aButs[b].scale||(this.aButs[b].scale=1);var e=this.aButs[b].oImgData.oData.oAtlasData[this.aButs[b].id].x,f=this.aButs[b].oImgData.oData.oAtlasData[this.aButs[b].id].y,g=this.aButs[b].oImgData.oData.oAtlasData[this.aButs[b].id].width,h=this.aButs[b].oImgData.oData.oAtlasData[this.aButs[b].id].height;a.drawImage(this.aButs[b].oImgData.img,e,f,g,h,this.aButs[b].aPos[0]-g/2+c-d/2,this.aButs[b].aPos[1]-h/2+d/2,g+d,h-d)}},b}();a.Panel=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(){this.number1Space=18,this.number2Space=17,this.startLightState=0,this.startTimerInc=0,this.clockIsOn=!1,this.gearPosY=200,this.wheelSpinInc=0,this.messageX=-700,this.messageY=0,this.messageType="greatStart",this.startTimerX=canvas.width/2,this.nitroPosY=200,this.pauseStartTimer=!1,this.accPedalHeight=1,this.accPedalY=120,this.incY=0,this.oHudImgData=assetLib.getData("hud"),this.oHudElementsImgData=assetLib.getData("hudElements"),this.oUiElementsImgData=assetLib.getData("uiElements"),this.oNumbers1ImgData=assetLib.getData("numbers1"),this.oNumbers2ImgData=assetLib.getData("numbers2")}return a.prototype.addMessage=function(a){switch(this.messageTween&&this.messageTween.kill(),this.messageType=a,this.messageX=1400,this.messageType){case"greatStart":case"perfect":case"good":this.messageY=98,this.messageTween=TweenLite.to(this,.3,{messageX:canvas.width/2,ease:"Cubic.easeOut",onComplete:this.removeMessageMidRace,onCompleteParams:[this]});break;case"endLose":this.messageY=100,this.messageTween=TweenLite.to(this,.3,{messageX:canvas.width/2,ease:"Cubic.easeOut",onComplete:this.removeMessageAtEnd,onCompleteParams:[this]});break;case"endWin":this.messageY=120,this.messageTween=TweenLite.to(this,.3,{messageX:canvas.width/2,ease:"Cubic.easeOut"})}},a.prototype.removeMessageMidRace=function(a){a.messageTween=TweenLite.to(a,.3,{messageX:-700,ease:"Cubic.easeIn",delay:1})},a.prototype.removeMessageAtEnd=function(a){a.messageTween=TweenLite.to(a,.3,{messageX:-700,ease:"Cubic.easeIn",delay:2,onComplete:initRaceComplete})},a.prototype.update=function(){this.clockIsOn&&(oRaceProgress.time+=100*delta),this.wheelSpinInc+=delta},a.prototype.render=function(){ctx.drawImage(this.oHudImgData.img,0,0);for(var a,b=Math.round(oRaceProgress.userSpeed),c=0;c<=b.toString().length;c++){a=parseFloat(b.toString().charAt(c));var d=a*this.oNumbers2ImgData.oData.spriteWidth%this.oNumbers2ImgData.img.width,e=Math.floor(a/(this.oNumbers2ImgData.img.width/this.oNumbers2ImgData.oData.spriteWidth))*this.oNumbers2ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers2ImgData.img,d,e,this.oNumbers2ImgData.oData.spriteWidth,this.oNumbers2ImgData.oData.spriteHeight,195+c*this.number2Space-this.number2Space*(b.toString().length+1)/2,389,this.oNumbers2ImgData.oData.spriteWidth,this.oNumbers2ImgData.oData.spriteHeight)}a=oRaceProgress.userGear,0==a&&(a=10);var d=a*this.oNumbers2ImgData.oData.spriteWidth%this.oNumbers2ImgData.img.width,e=Math.floor(a/(this.oNumbers2ImgData.img.width/this.oNumbers2ImgData.oData.spriteWidth))*this.oNumbers2ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers2ImgData.img,d,e,this.oNumbers2ImgData.oData.spriteWidth,this.oNumbers2ImgData.oData.spriteHeight,494,389,this.oNumbers2ImgData.oData.spriteWidth,this.oNumbers2ImgData.oData.spriteHeight);var f=0;oRaceProgress.enemyNitroBoost>0&&(f=Math.random()*oRaceProgress.enemyNitroBoost*4-2*oRaceProgress.enemyNitroBoost),userNitroShake=oRaceProgress.userNitroBoost>0?Math.random()*oRaceProgress.userNitroBoost*4-2*oRaceProgress.userNitroBoost:Math.random()*Math.min(Math.floor(b/100),3);var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,73,7.5+f,i*oRaceProgress.enemyProgress,j);var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBar].height;if(ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,73,23.5+userNitroShake,i*oRaceProgress.userProgress,j),0==oRaceProgress.time){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.accPedal].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.accPedal].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.accPedal].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.accPedal].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,570,this.accPedalY,i,j*this.accPedalHeight),ctx.save(),ctx.translate(canvas.width/2,438),ctx.rotate((180*userCar.oCarTypeData.revMeterRot-180)*radian);var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.startRevMeter].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.startRevMeter].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.startRevMeter].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.startRevMeter].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,0,-j/2,i,j),ctx.restore()}else if(oRaceProgress.userGear<userCar.oCarTypeData.gearNum&&oRaceProgress.userAccState<2){ctx.save(),ctx.translate(canvas.width/2,438),ctx.rotate((180*userCar.oCarTypeData.revMeterRot-180)*radian);var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revMeter].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revMeter].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revMeter].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revMeter].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,0,-j/2,i,j),ctx.restore()}ctx.save(),ctx.translate(canvas.width/2,440),ctx.rotate((180*oRaceProgress.userRevs-180+Math.sin(50*this.wheelSpinInc)*(1*oRaceProgress.userWheelSpin))*radian);var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revNeedle].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revNeedle].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revNeedle].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revNeedle].height;if(ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,-17,-j/2,i,j),ctx.restore(),userCar.oCarTypeData.nitro>0){this.incY+=10*delta;var k=5*Math.sin(this.incY+c),g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.boostBut].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.boostBut].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.boostBut].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.boostBut].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,50-k/2,338+this.nitroPosY+k/2,i+k,j-k)}var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearChange].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearChange].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearChange].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearChange].height;if(ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,540,330+this.gearPosY,i,j),oRaceProgress.userRevs>userCar.oCarTypeData.revMeterRot-.04&&2!=oRaceProgress.userAccState){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearHighlight].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearHighlight].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearHighlight].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearHighlight].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,516,303+this.gearPosY,i,j)}if(this.startTimerX>-700){this.pauseStartTimer||(this.startTimerInc+=delta),0==this.startLightState&&this.startTimerInc>2?(playSound("timer0"),this.startLightState=1):1==this.startLightState&&this.startTimerInc>3?(playSound("timer0"),this.startLightState=2):2==this.startLightState&&this.startTimerInc>4&&(playSound("timer1"),this.startLightState=3,raceStarted());var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds["startLights"+this.startLightState]].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds["startLights"+this.startLightState]].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds["startLights"+this.startLightState]].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds["startLights"+this.startLightState]].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,this.startTimerX-i/2,60,i,j)}if(2!=oRaceProgress.userAccState?this.renderTime(oRaceProgress.time):this.renderTime(oRaceProgress.userFinishTime),userCar.x-enemyCar.x>500){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBehindMarker].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBehindMarker].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBehindMarker].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distBehindMarker].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,10,220-j/2,i,j);for(var l=Math.round((userCar.x-enemyCar.x)/100),c=0;c<l.toString().length;c++){a=parseFloat(l.toString().charAt(c));var d=a*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(a/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,75+c*this.number1Space,202,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}a=11;var d=a*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(a/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,75+l.toString().length*this.number1Space,202,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}else if(userCar.x-enemyCar.x<-500){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distInFrontMarker].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distInFrontMarker].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distInFrontMarker].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.distInFrontMarker].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,521,220-j/2,i,j);for(var l=Math.round((enemyCar.x-userCar.x)/100),c=0;c<l.toString().length;c++){a=parseFloat(l.toString().charAt(c));var d=a*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(a/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,555+c*this.number1Space,202,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}a=11;var d=a*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,e=Math.floor(a/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,d,e,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,555+l.toString().length*this.number1Space,202,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight)}if(this.messageX>-700){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds[this.messageType+"Message"]].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds[this.messageType+"Message"]].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds[this.messageType+"Message"]].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds[this.messageType+"Message"]].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,this.messageX-i/2,this.messageY-j/2,i,j)}if(firstRun){if(0==oRaceProgress.time){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.revTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,587-i/2,354-j/2,i,j);var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].height;this.incY+=10*delta,ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,630-i/2,130-j/2-12*Math.sin(this.incY+45*c),i,j)}else if(oRaceProgress.userGear<=2)if(isMobile){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,579-i/2,250-j/2-150*(userCar.oCarTypeData.revMeterRot-oRaceProgress.userRevs),i,j)}else{var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1Keyboard].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1Keyboard].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1Keyboard].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip1Keyboard].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,579-i/2,250-j/2-150*(userCar.oCarTypeData.revMeterRot-oRaceProgress.userRevs),i,j)}else if(oRaceProgress.userGear<=3){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip2].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip2].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip2].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.gearTip2].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,574-i/2,236-j/2-150*(userCar.oCarTypeData.revMeterRot-oRaceProgress.userRevs),i,j)}}else if(this.startTimerInc>1&&0==oRaceProgress.time&&0==oRaceProgress.userRevs){var g=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].x,h=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].y,i=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].width,j=this.oUiElementsImgData.oData.oAtlasData[oImageIds.finger].height;this.incY+=10*delta,ctx.drawImage(this.oUiElementsImgData.img,g,h,i,j,630-i/2,130-j/2-12*Math.sin(this.incY+45*c),i,j)}if(oRaceProgress.time>0&&oRaceProgress.userGear<3&&1==firstNitroStage&&!oRaceProgress.userBoostTriggered){var g=this.oHudElementsImgData.oData.oAtlasData[oImageIds.nitroTip].x,h=this.oHudElementsImgData.oData.oAtlasData[oImageIds.nitroTip].y,i=this.oHudElementsImgData.oData.oAtlasData[oImageIds.nitroTip].width,j=this.oHudElementsImgData.oData.oAtlasData[oImageIds.nitroTip].height;ctx.drawImage(this.oHudElementsImgData.img,g,h,i,j,118-i/2,255-j/2,i,j)}},a.prototype.renderTime=function(a){a=Math.round(a);var b=Math.floor(a/6e3).toString(),c=Math.floor((a-6e3*Math.floor(a/6e3))/100).toString();c.length<2&&(c="0"+c);var d=a.toString().charAt(a.toString().length-2)+a.toString().charAt(a.toString().length-1);d.length<2&&(d="0"+d);for(var e=0;2>e;e++){var f=parseFloat(b.charAt(e));if(b.length<2){if(0==e)continue;f=parseFloat(b.charAt(0))}var g=f*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,h=Math.floor(f/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,g,h,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,544,11,Math.round(.75*this.oNumbers1ImgData.oData.spriteWidth),Math.round(.75*this.oNumbers1ImgData.oData.spriteHeight))}for(var e=0;2>e;e++){var f=parseFloat(c.charAt(e)),g=f*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,h=Math.floor(f/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,g,h,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,567+e*this.number1Space*.75,11,.75*this.oNumbers1ImgData.oData.spriteWidth,.75*this.oNumbers1ImgData.oData.spriteHeight)}for(var e=0;2>e;e++){var f=parseFloat(d.charAt(e)),g=f*this.oNumbers1ImgData.oData.spriteWidth%this.oNumbers1ImgData.img.width,h=Math.floor(f/(this.oNumbers1ImgData.img.width/this.oNumbers1ImgData.oData.spriteWidth))*this.oNumbers1ImgData.oData.spriteHeight;ctx.drawImage(this.oNumbers1ImgData.img,g,h,this.oNumbers1ImgData.oData.spriteWidth,this.oNumbers1ImgData.oData.spriteHeight,602+e*this.number1Space*.5,13,.5*this.oNumbers1ImgData.oData.spriteWidth,.5*this.oNumbers1ImgData.oData.spriteHeight)}},a}();a.Hud=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(){this.segNum=25,this.aRowData=new Array,this.horizon=180,this.scrollY=0,this.scrollX=0,this.targScrollSpeed=0,this.scrollSpeed=0,this.maxFlySpeed=500,this.roadHeight=300,this.flyInc=300,this.lineRate=1,this.scaleFactor=450,this.maxSteer=350,this.oRoadImgData=assetLib.getData("road"),"race"==gameState?this.oBgImgData=assetLib.getData(["roadBg"+oRaceProgress.background]):this.oBgImgData=assetLib.getData(["roadBg"+panel.oRaceData.background]);for(var a=0;a<this.segNum;a++)this.aRowData.push({y:0,scale:0})}return a.prototype.update=function(){this.scrollX+=this.scrollSpeed*delta},a.prototype.render=function(){var a=this.scrollX/1%800;0>a&&(a+=800),ctx.drawImage(this.oBgImgData.img,a,0,800,203,0,this.horizon-203+2*userNitroShake,800,203);for(var b=1e3/this.segNum,c=0,d=0;d<this.segNum;d++)if(this.tempInc=d,this.easeInc=-1*(Math.sqrt(1-(this.tempInc/=this.segNum)*this.tempInc)-1)+0,this.nextRow=d+1,this.segHeightAfter=-1*(Math.sqrt(1-(this.nextRow/=this.segNum)*this.nextRow)-1)+0-this.easeInc,this.aRowData[d].y=this.horizon+this.easeInc*this.roadHeight,this.aRowData[d].scale=2*(this.easeInc+this.segHeightAfter)*this.scaleFactor,0==c&&(this.rowId=d),c+=this.segHeightAfter*this.roadHeight,c>this.lineRate){var a=(d/this.segNum*(this.scaleFactor/2)+this.scrollX)%700;0>a&&(a+=700),ctx.drawImage(this.oRoadImgData.img,a,this.rowId*b+this.scrollY,700-d/this.segNum*this.scaleFactor,b,0,this.aRowData[this.rowId].y+2*userNitroShake,700,c+1),c=0}},a}();a.ScrollGround=b}(Elements||(Elements={}));var Utils;!function(a){var b=function(){function a(a){this.dataGroupNum=2,this.saveDataId=a;var b="test",c=window.sessionStorage;try{c.setItem(b,"1"),c.removeItem(b),this.canStore=!0}catch(d){this.canStore=!1;
}this.clearData(),this.setInitialData()}return a.prototype.clearData=function(){this.aLevelStore=new Array,this.aLevelStore.push("0"),this.aLevelStore.push("100"),this.aLevelStore.push("11"),this.aLevelStore.push("0"),this.aLevelStore.push("0"),this.aLevelStore.push("0"),this.aLevelStore.push("0"),this.aLevelStore.push("1"),this.aLevelStore.push("0311,1,1,.1800,1,2,.1600,1,2,.1300,1,2,.0500,1,2,."),this.aLevelStore.push("000000000000000000.0.0.0")},a.prototype.resetData=function(){this.clearData(),this.saveData()},a.prototype.setInitialData=function(){this.canStore&&"undefined"!=typeof Storage&&(null!=localStorage.getItem(this.saveDataId)&&""!=localStorage.getItem(this.saveDataId)?this.aLevelStore=localStorage.getItem(this.saveDataId).split("|"):this.saveData())},a.prototype.setCareerData=function(){this.aLevelStore[0]=oUserCareerData.cash,this.aLevelStore[1]=oUserCareerData.levelNum,this.aLevelStore[2]=10*oUserCareerData.careerStage+oUserCareerData.careerRace,this.aLevelStore[3]=oUserCareerData.curCarId,this.aLevelStore[4]=oUserCareerData.racesWon,this.aLevelStore[5]=oUserCareerData.totalWinnings,this.aLevelStore[6]=oUserCareerData.totalDistance,this.aLevelStore[7]=oUserCareerData.carsOwned},a.prototype.setPinData=function(){for(var b="",c=0;c<aPinDisplay.length;c++)aPinDisplay[c].posId.toString().length<2&&(b+="0"),b+=aPinDisplay[c].posId,b+=aPinDisplay[c].state,b+=aPinDisplay[c].selected?"1":"0",b+=",",b+=aPinDisplay[c].careerStage,b+=",",b+=aPinDisplay[c].careerRace,b+=",",b+=".";this.aLevelStore[8]=b},a.prototype.setGarageData=function(){this.aLevelStore.splice(9,this.aLevelStore.length-9);for(var b=0;b<aUserGarageData.length;b++){var c="";aUserGarageData[b].body.toString().length<2&&(c+="0"),c+=aUserGarageData[b].body,aUserGarageData[b].colour.toString().length<2&&(c+="0"),c+=aUserGarageData[b].colour,aUserGarageData[b].rims.toString().length<2&&(c+="0"),c+=aUserGarageData[b].rims,aUserGarageData[b].shadow.toString().length<2&&(c+="0"),c+=aUserGarageData[b].shadow,aUserGarageData[b].engineUpgrade.toString().length<2&&(c+="0"),c+=aUserGarageData[b].engineUpgrade,aUserGarageData[b].accUpgrade.toString().length<2&&(c+="0"),c+=aUserGarageData[b].accUpgrade,aUserGarageData[b].wheelsUpgrade.toString().length<2&&(c+="0"),c+=aUserGarageData[b].wheelsUpgrade,aUserGarageData[b].weightUpgrade.toString().length<2&&(c+="0"),c+=aUserGarageData[b].weightUpgrade,aUserGarageData[b].nitroUpgrade.toString().length<2&&(c+="0"),c+=aUserGarageData[b].nitroUpgrade,c+=".";for(var d=0;d<aUserGarageData[b].aColoursOwned.length;d++)c+=aUserGarageData[b].aColoursOwned[d],d<aUserGarageData[b].aColoursOwned.length-1&&(c+=",");c+=".";for(var d=0;d<aUserGarageData[b].aRimsOwned.length;d++)c+=aUserGarageData[b].aRimsOwned[d],d<aUserGarageData[b].aRimsOwned.length-1&&(c+=",");c+=".";for(var d=0;d<aUserGarageData[b].aNeonOwned.length;d++)c+=aUserGarageData[b].aNeonOwned[d],d<aUserGarageData[b].aNeonOwned.length-1&&(c+=",");console.log("saving "+c),this.aLevelStore[9+b]=c}},a.prototype.getCareerData=function(){var a=Math.floor(this.aLevelStore[2]/10);return{cash:parseFloat(this.aLevelStore[0]),levelNum:parseFloat(this.aLevelStore[1]),careerStage:a,careerRace:parseFloat(this.aLevelStore[2])-10*a,curCarId:parseFloat(this.aLevelStore[3]),racesWon:parseFloat(this.aLevelStore[4]),totalWinnings:parseFloat(this.aLevelStore[5]),totalDistance:parseFloat(this.aLevelStore[6]),carsOwned:parseFloat(this.aLevelStore[7])}},a.prototype.getPinData=function(){for(var a=new Array,b=this.aLevelStore[8].toString();b.length>0;)a.push({posId:parseFloat(b.charAt(0)+b.charAt(1)),state:parseFloat(b.charAt(2)),selected:Boolean(parseFloat(b.charAt(3))),careerStage:parseFloat(b.split(",")[1]),careerRace:parseFloat(b.split(",")[2])}),b=b.slice(b.indexOf(".")+1);return a},a.prototype.getGarageData=function(){for(var a=new Array,b=9;b<this.aLevelStore.length;b++){var c=this.aLevelStore[b].toString(),d=c.split(".")[1].split(",");for(var e in d)d[e]=parseFloat(d[e]);var f=c.split(".")[2].split(",");for(var e in f)f[e]=parseFloat(f[e]);var g=c.split(".")[3].split(",");for(var e in g)g[e]=parseFloat(g[e]);a.push({body:parseFloat(c.charAt(0)+c.charAt(1)),colour:parseFloat(c.charAt(2)+c.charAt(3)),rims:parseFloat(c.charAt(4)+c.charAt(5)),shadow:parseFloat(c.charAt(6)+c.charAt(7)),engineUpgrade:parseFloat(c.charAt(8)+c.charAt(9)),accUpgrade:parseFloat(c.charAt(10)+c.charAt(11)),wheelsUpgrade:parseFloat(c.charAt(12)+c.charAt(13)),weightUpgrade:parseFloat(c.charAt(14)+c.charAt(15)),nitroUpgrade:parseFloat(c.charAt(16)+c.charAt(17)),gearNum:aCarBaseData[parseFloat(c.charAt(0)+c.charAt(1))].gearNum,engine:0,gearBox:0,grip:0,nitro:0,aColoursOwned:d,aRimsOwned:f,aNeonOwned:g})}return this.updateStats(a),a},a.prototype.updateStats=function(a){for(var b=0;b<a.length;b++)a[b].engine=Math.round(100*(aCarBaseData[a[b].body].engine+(aUpgradeData[a[b].body].engine.maxUpgradeLevel-aCarBaseData[a[b].body].engine)/5*a[b].engineUpgrade))/100,a[b].gearBox=Math.round(100*(aCarBaseData[a[b].body].gearBox+(aUpgradeData[a[b].body].acc.maxUpgradeLevel-aCarBaseData[a[b].body].gearBox)/5*a[b].accUpgrade))/100,a[b].grip=Math.round(100*(aCarBaseData[a[b].body].grip+(aUpgradeData[a[b].body].wheels.maxUpgradeLevel-aCarBaseData[a[b].body].grip)/5*a[b].wheelsUpgrade))/100,a[b].weight=Math.round(100*(aCarBaseData[a[b].body].weight+(aUpgradeData[a[b].body].weight.maxUpgradeLevel-aCarBaseData[a[b].body].weight)/5*a[b].weightUpgrade))/100,a[b].nitro=Math.round(100*(aCarBaseData[a[b].body].nitro+(aUpgradeData[a[b].body].nitro.maxUpgradeLevel-aCarBaseData[a[b].body].nitro)/5*a[b].nitroUpgrade))/100},a.prototype.saveData=function(){if(this.canStore&&"undefined"!=typeof Storage){for(var a="",b=0;b<this.aLevelStore.length;b++)a+=this.aLevelStore[b],b<this.aLevelStore.length-1&&(a+="|");localStorage.setItem(this.saveDataId,a)}},a}();a.SaveDataHandler=b}(Utils||(Utils={}));var Elements;!function(a){var b=function(){function a(a,b){this.bodyRot=0,this.bodyRotTarg=0,this.wheelRot=0,this.timerInc=0,this.enemyOffsetX=0,this.overtakeOffset=0,this.shadowFlash=0,this.ranShadowId=Math.ceil(4*Math.random()),this.ranShadowWidth=.5*Math.random()+.5,this.aPartsPosData=new Array({xExhaust:-176,yExhaust:39,yGround:-70,xBrakes:-11,yBrakes:23,yWheels:42,xLeftWheel:-134,xRightWheel:92,xShadow:-9,yShadow:61,wheelScale:.83},{xExhaust:-205,yExhaust:37,yGround:-69,xBrakes:0,yBrakes:21,yWheels:39,xLeftWheel:-135,xRightWheel:114,xShadow:-10,yShadow:60,wheelScale:.87},{xExhaust:-215,yExhaust:40,yGround:-71,xBrakes:0,yBrakes:22,yWheels:40,xLeftWheel:-127,xRightWheel:112,xShadow:0,yShadow:60,wheelScale:.88},{xExhaust:-195,yExhaust:41,yGround:-67,xBrakes:0,yBrakes:20,yWheels:34,xLeftWheel:-142,xRightWheel:123,xShadow:-7,yShadow:57,wheelScale:.93},{xExhaust:-202,yExhaust:27,yGround:-55,xBrakes:-6,yBrakes:10,yWheels:23,xLeftWheel:-135,xRightWheel:111,xShadow:5,yShadow:44,wheelScale:.95},{xExhaust:-211,yExhaust:31,yGround:-57,xBrakes:-18,yBrakes:13,yWheels:24,xLeftWheel:-160,xRightWheel:109,xShadow:2,yShadow:47,wheelScale:.96},{xExhaust:-201,yExhaust:28,yGround:-57,xBrakes:-10,yBrakes:14,yWheels:24,xLeftWheel:-144,xRightWheel:110,xShadow:1,yShadow:47,wheelScale:.95},{xExhaust:-210,yExhaust:25,yGround:-53,xBrakes:-11,yBrakes:14,yWheels:22,xLeftWheel:-156,xRightWheel:107,xShadow:2,yShadow:43,wheelScale:.91},{xExhaust:-220,yExhaust:19,yGround:-56,xBrakes:-7,yBrakes:13,yWheels:23,xLeftWheel:-140,xRightWheel:114,xShadow:2,yShadow:46,wheelScale:.94},{xExhaust:-201,yExhaust:27,yGround:-59,xBrakes:-7,yBrakes:17,yWheels:26,xLeftWheel:-144,xRightWheel:117,xShadow:3,yShadow:49,wheelScale:.96},{xExhaust:-210,yExhaust:28,yGround:-60,xBrakes:-10,yBrakes:18,yWheels:26,xLeftWheel:-145,xRightWheel:115,xShadow:0,yShadow:52,wheelScale:1},{xExhaust:-215,yExhaust:28,yGround:-59,xBrakes:-12,yBrakes:14,yWheels:25,xLeftWheel:-140,xRightWheel:110,xShadow:4,yShadow:49,wheelScale:.96}),this.isUser=a,this.oCarTypeData=b,this.oCarImgData=assetLib.getData("car"+this.oCarTypeData.body),this.oWheelImgData=assetLib.getData("wheels"),this.oUiElementsImgData=assetLib.getData("uiElements"),Math.seedrandom(this.oCarTypeData.body),this.oCarTypeData.aGearRatios=new Array;for(var c=0;c<this.oCarTypeData.gearNum;c++)this.oCarTypeData.aGearRatios.push(.65+.2*Math.random());if(this.oCarTypeData.revMeterRot=this.oCarTypeData.aGearRatios[0],this.oCarTypeData.revRate=this.oCarTypeData.engine+(1-this.oCarTypeData.weight),this.oCarTypeData.speedMultiplier=36*(this.oCarTypeData.engine+(.5-this.oCarTypeData.weight/2)+this.oCarTypeData.gearBox/2),Math.seedrandom(),this.isUser)this.x=canvas.width/2,this.y=283,this.scale=.78;else{this.x=canvas.width/2,this.y=230,this.scale=.655,this.aEnemyGearOffset=new Array;for(var c=0;c<this.oCarTypeData.gearNum;c++)this.aEnemyGearOffset.push(.2*Math.random()-.1)}}return a.prototype.revRock=function(a,b){"undefined"==typeof a&&(a=1),"undefined"==typeof b&&(b=1),this.rotTween&&this.rotTween.kill(),this.bodyRotTarg=a*radian,a>0?this.rotTween=TweenLite.to(this,b,{bodyRotTarg:0,ease:"Back.easeOut"}):this.rotTween=TweenLite.to(this,b,{bodyRotTarg:0,ease:"Quad.easeIn"})},a.prototype.update=function(){this.bodyRot+=5*(this.bodyRotTarg-this.bodyRot)*delta,0==oRaceProgress.time&&(this.x=canvas.width/2+100*this.bodyRot,this.wheelRot=5*this.bodyRot,this.isUser||(this.timerInc-=delta,this.timerInc<0&&(this.revRock(),playSound("rev"+Math.floor(2*Math.random())),addExhaust(this),addSmoke(this),this.timerInc=1*Math.random()))),this.isUser?(this.wheelRot=scrollGround.scrollX/10,oRaceProgress.time>0&&(2!=oRaceProgress.userAccState?this.overtakeOffset+=5*(Math.max(-100,Math.min(100,(enemyCar.x-this.x)/2))-this.overtakeOffset)*delta:this.overtakeOffset+=.5*(Math.max(-100,Math.min(100,0))-this.overtakeOffset)*delta,this.x=canvas.width/2-this.overtakeOffset,oRaceProgress.userProgress=Math.min(1,oRaceProgress.userProgress+oRaceProgress.userSpeed*delta/3500/oRaceProgress.raceLength))):(2!=oRaceProgress.userAccState?this.overtakeOffset+=5*(Math.max(-100,Math.min(100,(this.x-userCar.x)/2))-this.overtakeOffset)*delta:this.overtakeOffset+=.5*(Math.max(-100,Math.min(100,0))-this.overtakeOffset)*delta,this.enemyOffsetX+=oRaceProgress.enemySpeed*delta*20,this.x=canvas.width/2-scrollGround.scrollX+this.enemyOffsetX-this.overtakeOffset,oRaceProgress.enemyProgress=Math.min(1,oRaceProgress.enemyProgress+oRaceProgress.enemySpeed*delta/3500/oRaceProgress.raceLength),this.wheelRot=this.enemyOffsetX/10)},a.prototype.render=function(){var a=this.aPartsPosData[this.oCarTypeData.body].yGround+userNitroShake;if(5==this.oCarTypeData.shadow){this.shadowFlash+=delta,this.shadowFlash>.1&&(this.ranShadowId=Math.ceil(4*Math.random()),this.ranShadowWidth=.5*Math.random()+.5,this.shadowFlash=0);var b=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.ranShadowId]].x,c=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.ranShadowId]].y,d=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.ranShadowId]].width,e=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.ranShadowId]].height;ctx.drawImage(this.oCarImgData.img,b,c,d,e,this.x+(this.aPartsPosData[this.oCarTypeData.body].xShadow-d/2+(1-this.ranShadowWidth)*(d/2))*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yShadow+a-e/2)*this.scale,d*this.scale*this.ranShadowWidth,e*this.scale)}else{var b=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.oCarTypeData.shadow]].x,c=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.oCarTypeData.shadow]].y,d=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.oCarTypeData.shadow]].width,e=this.oCarImgData.oData.oAtlasData[oImageIds["shadow"+this.oCarTypeData.shadow]].height;ctx.drawImage(this.oCarImgData.img,b,c,d,e,this.x+(this.aPartsPosData[this.oCarTypeData.body].xShadow-d/2)*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yShadow+a-e/2)*this.scale,d*this.scale,e*this.scale)}var b=this.oCarImgData.oData.oAtlasData[oImageIds.brakes].x,c=this.oCarImgData.oData.oAtlasData[oImageIds.brakes].y,d=this.oCarImgData.oData.oAtlasData[oImageIds.brakes].width,e=this.oCarImgData.oData.oAtlasData[oImageIds.brakes].height;ctx.drawImage(this.oCarImgData.img,b,c,d,e,this.x+(this.aPartsPosData[this.oCarTypeData.body].xBrakes-d/2)*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yBrakes+a-e/2)*this.scale,d*this.scale,e*this.scale);var b=this.oWheelImgData.oData.oAtlasData["id"+this.oCarTypeData.rims].x,c=this.oWheelImgData.oData.oAtlasData["id"+this.oCarTypeData.rims].y,d=this.oWheelImgData.oData.oAtlasData["id"+this.oCarTypeData.rims].width,e=this.oWheelImgData.oData.oAtlasData["id"+this.oCarTypeData.rims].height;ctx.save(),ctx.translate(this.x+this.aPartsPosData[this.oCarTypeData.body].xLeftWheel*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yWheels+a)*this.scale),ctx.rotate(this.wheelRot),ctx.scale(this.scale*this.aPartsPosData[this.oCarTypeData.body].wheelScale,this.scale*this.aPartsPosData[this.oCarTypeData.body].wheelScale),ctx.drawImage(this.oWheelImgData.img,b,c,d,e,-d/2,-e/2,d,e),ctx.restore(),ctx.save(),ctx.translate(this.x+this.aPartsPosData[this.oCarTypeData.body].xRightWheel*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yWheels+a)*this.scale),ctx.rotate(this.wheelRot),ctx.scale(this.scale*this.aPartsPosData[this.oCarTypeData.body].wheelScale,this.scale*this.aPartsPosData[this.oCarTypeData.body].wheelScale),ctx.drawImage(this.oWheelImgData.img,b,c,d,e,-d/2,-e/2,d,e),ctx.restore(),ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(this.bodyRot),ctx.scale(this.scale,this.scale);var b=this.oCarImgData.oData.oAtlasData[oImageIds["colour"+this.oCarTypeData.colour]].x,c=this.oCarImgData.oData.oAtlasData[oImageIds["colour"+this.oCarTypeData.colour]].y,d=this.oCarImgData.oData.oAtlasData[oImageIds["colour"+this.oCarTypeData.colour]].width,e=this.oCarImgData.oData.oAtlasData[oImageIds["colour"+this.oCarTypeData.colour]].height;if(ctx.drawImage(this.oCarImgData.img,b,c,d,e,-d/2,a-e/2,d,e),ctx.restore(),oRaceProgress&&"race"==gameState){var f=2*oRaceProgress.userNitroBoost;this.isUser||(f=2*oRaceProgress.enemyNitroBoost);var g=3*Math.random()+1,b=this.oUiElementsImgData.oData.oAtlasData[oImageIds.nitroJet].x,c=this.oUiElementsImgData.oData.oAtlasData[oImageIds.nitroJet].y,d=this.oUiElementsImgData.oData.oAtlasData[oImageIds.nitroJet].width,e=this.oUiElementsImgData.oData.oAtlasData[oImageIds.nitroJet].height;ctx.drawImage(this.oUiElementsImgData.img,b,c,d,e,this.x+(this.aPartsPosData[this.oCarTypeData.body].xExhaust-d*f)*this.scale,this.y+(this.aPartsPosData[this.oCarTypeData.body].yExhaust+a-e/2*g)*this.scale,d*f*this.scale,e*g*this.scale)}},a}();a.Car=b}(Elements||(Elements={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c},Elements;!function(a){var b=function(a){function b(b){a.call(this,b,25,45,"exploding"),this.setAnimType("once","exploding"),this.animEndedFunc=function(){this.removeMe=!0}}return __extends(b,a),b.prototype.update=function(){a.prototype.updateAnimation.call(this,delta),this.x-=scrollGround.scrollX/100*delta},b.prototype.render=function(){a.prototype.renderSimple.call(this,ctx)},b}(Utils.AnimSprite);a.Exhaust=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(a){function b(b){a.call(this,b,15,45,"exploding"),this.incY=0,this.setAnimType("once","exploding"),this.animEndedFunc=function(){this.removeMe=!0}}return __extends(b,a),b.prototype.update=function(){a.prototype.updateAnimation.call(this,delta),this.incY+=100*delta,this.x-=scrollGround.scrollX/50*delta,this.y-=this.incY*delta},b.prototype.render=function(){a.prototype.renderSimple.call(this,ctx)},b}(Utils.AnimSprite);a.Smoke=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(a){function b(b){a.call(this,b,20,45,"exploding"),this.setAnimType("once","exploding"),this.animEndedFunc=function(){this.removeMe=!0}}return __extends(b,a),b.prototype.update=function(){a.prototype.updateAnimation.call(this,delta)},b.prototype.render=function(){a.prototype.renderSimple.call(this,ctx)},b}(Utils.AnimSprite);a.Firework=b}(Elements||(Elements={}));var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60,(new Date).getTime())}}(),previousTime,canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");canvas.width=700,canvas.height=450;var canvasX,canvasY,canvasScaleX,canvasScaleY,div=document.getElementById("viewporter"),sound,music,audioType=0,muted=!1,splash,splashTimer=0,assetLib,preAssetLib,rotatePause=!1,manualPause=!1,isMobile=!1,gameState="loading",aLangs=new Array("EN"),curLang="",isBugBrowser=!1,isIE10=!1,delta,radian=Math.PI/180,raceType="career",firstRun=!0,ios9FirstTouch=!1,saveDataHandler=new Utils.SaveDataHandler("mightymotorsv3");navigator.userAgent.match(/MSIE\s([\d]+)/)&&(isIE10=!0);var deviceAgent=navigator.userAgent.toLowerCase();(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i))&&(isMobile=!0,deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)&&(isBugBrowser=!0));var userInput=new Utils.UserInput(canvas,isBugBrowser);resizeCanvas(),window.onresize=function(){setTimeout(function(){resizeCanvas(),viewporter.refresh()},1)},window.addEventListener("load",function(){setTimeout(function(){resizeCanvas()},0),window.addEventListener("orientationchange",function(){setTimeout(function(){resizeCanvas()},500)},!1)}),isIE10||"undefined"==typeof window.AudioContext&&"undefined"==typeof window.webkitAudioContext&&-1!=navigator.userAgent.indexOf("Android")?audioType=0:(audioType=1,sound=new Howl({urls:["audio/sound.ogg","audio/sound.m4a"],sprite:{startSpin0:[0,2e3],startSpin1:[2500,2e3],startSpin2:[5500,1800],buy:[7500,1600],click:[9500,400],nitro:[1e4,1600],perfectGear:[12e3,1200],goodGear:[13500,1300],endLose:[15e3,1300],endWin:[16500,2500],engineStart:[19500,2e3],rev0:[22e3,1600],rev1:[24e3,2e3],driveOff:[26500,5e3],changeGear0:[32e3,3e3],changeGear1:[35500,2500],changeGear2:[38500,2500],changeGear3:[41500,2500],timer0:[44500,700],timer1:[45500,700],engineHum:[46500,6200],firework:[53e3,1600],silence:[31e3,200]}}),music=new Howl({urls:["audio/music.ogg","audio/music.m4a"],volume:.01,loop:!0}));var panel,hud,background,aTutorials=new Array,panelFrame,oLogoData={},oLogoBut,musicTween,oImageIds={},scrollGround,oUserCareerData={},aUserGarageData=new Array,userCar,enemyCar,oRaceProgress,accPedalIsDown=!1,userRevTween,enemyRevTween,userNitroTween,enemyNitroTween,aCarBaseData=new Array({body:0,colour:0,rims:0,gearNum:6,shadow:0,engine:.29,gearBox:.19,grip:.23,nitro:0,weight:.54,cost:1595,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[0],aNeonOwned:[0]},{body:1,colour:0,rims:0,gearNum:6,shadow:0,engine:.33,gearBox:.24,grip:.36,nitro:0,weight:.62,cost:2795,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[0],aNeonOwned:[0]},{body:2,colour:0,rims:0,gearNum:6,shadow:0,engine:.41,gearBox:.32,grip:.38,nitro:0,weight:.74,cost:5995,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[0],aNeonOwned:[0]},{body:3,colour:0,rims:4,gearNum:6,shadow:0,engine:.45,gearBox:.39,grip:.44,nitro:0,weight:.48,cost:9995,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[3],aNeonOwned:[0]},{body:4,colour:0,rims:5,gearNum:6,shadow:0,engine:.52,gearBox:.44,grip:.57,nitro:0,weight:.32,cost:15495,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[4],aNeonOwned:[0]},{body:5,colour:0,rims:2,gearNum:7,shadow:0,engine:.55,gearBox:.58,grip:.53,nitro:0,weight:.54,cost:24e3,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[2],aNeonOwned:[0]},{body:6,colour:0,rims:4,gearNum:7,shadow:0,engine:.59,gearBox:.54,grip:.62,nitro:0,weight:.47,cost:42495,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[3],aNeonOwned:[0]},{body:7,colour:0,rims:8,gearNum:7,shadow:0,engine:.62,gearBox:.68,grip:.69,nitro:0,weight:.5,cost:67e3,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[6],aNeonOwned:[0]},{body:8,colour:0,rims:6,gearNum:7,shadow:0,engine:.64,gearBox:.61,grip:.67,nitro:0,weight:.52,cost:99e3,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[5],aNeonOwned:[0]},{body:9,colour:0,rims:10,gearNum:8,shadow:0,engine:.76,gearBox:.72,grip:.81,nitro:0,weight:.46,cost:15e4,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[8],aNeonOwned:[0]},{body:10,colour:0,rims:12,gearNum:8,shadow:0,engine:.84,gearBox:.74,grip:.56,nitro:0,weight:.61,cost:25e4,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[9],aNeonOwned:[0]},{body:11,colour:0,rims:13,gearNum:8,shadow:0,engine:.82,gearBox:.78,grip:.78,nitro:0,weight:.41,cost:5e5,engineUpgrade:0,accUpgrade:0,wheelsUpgrade:0,weightUpgrade:0,nitroUpgrade:0,aColoursOwned:[0],aRimsOwned:[10],aNeonOwned:[0]}),aUpgradeData=new Array({engine:{startCost:150,increaseAmount:50,maxUpgradeLevel:.34},acc:{startCost:100,increaseAmount:50,maxUpgradeLevel:.26},wheels:{startCost:75,increaseAmount:50,maxUpgradeLevel:.37},weight:{startCost:75,increaseAmount:50,maxUpgradeLevel:.41},nitro:{startCost:150,increaseAmount:50,maxUpgradeLevel:.31}},{engine:{startCost:200,increaseAmount:50,maxUpgradeLevel:.43},acc:{startCost:150,increaseAmount:50,maxUpgradeLevel:.33},wheels:{startCost:100,increaseAmount:50,maxUpgradeLevel:.43},weight:{startCost:100,increaseAmount:50,maxUpgradeLevel:.5},nitro:{startCost:200,increaseAmount:50,maxUpgradeLevel:.37}},{engine:{startCost:275,increaseAmount:75,maxUpgradeLevel:.48},acc:{startCost:200,increaseAmount:75,maxUpgradeLevel:.43},wheels:{startCost:150,increaseAmount:75,maxUpgradeLevel:.49},weight:{startCost:150,increaseAmount:75,maxUpgradeLevel:.6},nitro:{startCost:275,increaseAmount:75,maxUpgradeLevel:.44}},{engine:{startCost:350,increaseAmount:85,maxUpgradeLevel:.54},acc:{startCost:275,increaseAmount:85,maxUpgradeLevel:.5},wheels:{startCost:250,increaseAmount:85,maxUpgradeLevel:.57},weight:{startCost:250,increaseAmount:85,maxUpgradeLevel:.32},nitro:{startCost:350,increaseAmount:85,maxUpgradeLevel:.51}},{engine:{startCost:450,increaseAmount:100,maxUpgradeLevel:.57},acc:{startCost:400,increaseAmount:100,maxUpgradeLevel:.58},wheels:{startCost:350,increaseAmount:100,maxUpgradeLevel:.67},weight:{startCost:350,increaseAmount:100,maxUpgradeLevel:.24},nitro:{startCost:450,increaseAmount:100,maxUpgradeLevel:.59}},{engine:{startCost:550,increaseAmount:125,maxUpgradeLevel:.63},acc:{startCost:500,increaseAmount:125,maxUpgradeLevel:.6},wheels:{startCost:450,increaseAmount:125,maxUpgradeLevel:.64},weight:{startCost:450,increaseAmount:125,maxUpgradeLevel:.46},nitro:{startCost:550,increaseAmount:125,maxUpgradeLevel:.61}},{engine:{startCost:750,increaseAmount:200,maxUpgradeLevel:.65},acc:{startCost:650,increaseAmount:200,maxUpgradeLevel:.71},wheels:{startCost:550,increaseAmount:200,maxUpgradeLevel:.7},weight:{startCost:550,increaseAmount:200,maxUpgradeLevel:.36},nitro:{startCost:750,increaseAmount:200,maxUpgradeLevel:.66}},{engine:{startCost:1e3,increaseAmount:275,maxUpgradeLevel:.7},acc:{startCost:750,increaseAmount:275,maxUpgradeLevel:.74},wheels:{startCost:500,increaseAmount:275,maxUpgradeLevel:.73},weight:{startCost:500,increaseAmount:275,maxUpgradeLevel:.38},nitro:{startCost:1e3,increaseAmount:275,maxUpgradeLevel:.7}},{engine:{startCost:1200,increaseAmount:300,maxUpgradeLevel:.77},acc:{startCost:800,increaseAmount:300,maxUpgradeLevel:.76},wheels:{startCost:600,increaseAmount:300,maxUpgradeLevel:.81},weight:{startCost:600,increaseAmount:300,maxUpgradeLevel:.33},nitro:{startCost:1200,increaseAmount:300,maxUpgradeLevel:.74}},{engine:{startCost:1500,increaseAmount:350,maxUpgradeLevel:.85},acc:{startCost:1e3,increaseAmount:350,maxUpgradeLevel:.81},wheels:{startCost:750,increaseAmount:350,maxUpgradeLevel:.81},weight:{startCost:750,increaseAmount:350,maxUpgradeLevel:.26},nitro:{startCost:1500,increaseAmount:350,maxUpgradeLevel:.79}},{engine:{startCost:2e3,increaseAmount:400,maxUpgradeLevel:.91},acc:{startCost:1500,increaseAmount:400,maxUpgradeLevel:.85},wheels:{startCost:1e3,increaseAmount:400,maxUpgradeLevel:.76},weight:{startCost:1e3,increaseAmount:400,maxUpgradeLevel:.43},nitro:{startCost:2e3,increaseAmount:400,maxUpgradeLevel:.9}},{engine:{startCost:3e3,increaseAmount:500,maxUpgradeLevel:.97},acc:{startCost:2e3,increaseAmount:500,maxUpgradeLevel:.93},wheels:{startCost:1500,increaseAmount:500,maxUpgradeLevel:.92},weight:{startCost:1500,increaseAmount:500,maxUpgradeLevel:.27},nitro:{startCost:3e3,increaseAmount:500,maxUpgradeLevel:.95}}),aPinPos=new Array({x:575,y:214},{x:535,y:317},{x:231,y:223},{x:331,y:250},{x:181,y:291},{x:618,y:301},{x:415,y:313},{x:401,y:214},{x:265,y:322},{x:102,y:325},{x:624,y:131},{x:457,y:152},{x:305,y:158},{x:163,y:133},{x:120,y:223},{x:540,y:121},{x:485,y:241},{x:376,y:121},{x:242,y:103},{x:74,y:117}),aPinDisplay=new Array,curShopCarId=0,upgradeTab="engine",customiseTab="colour",curUpgradeCost,curCustomiseCost,curRimScroll=0,curCustomiseButHighlight=0,oCustomiseSaveData={colour:0,rims:0,shadow:0},firstNitroStage=0,aEffects,aFireworks,curPinSelectedId,oPrevCareerData,swayX=0,pinsPerMap=10,pinPage=0,aMapColours=new Array("rgba(0, 65, 255,","rgba(0, 191, 255,","rgba(0, 255, 107,","rgba(145, 255, 0,","rgba(255, 210, 0,","rgba(255, 98, 0,","rgba(255, 0, 0,","rgba(255, 0, 154,","rgba(159, 0, 255,"),newPinPage=!1,userNitroShake=0,firstTouchAfterLoading=!0,newCarBought=!1,oGearChanges={perfect:0,good:0,regular:0,perfectStart:null},hasVideoBoost=!1,canShowVideo=!1,raceEndBonusId=0,videoRaceEndShown=!1,game_version="1.0.0",game_domain="mighty_motors";com.funtomic.GameOps.init(game_domain,game_version,{},{},null);var callback_start=function(){console.log("ad start")},callback_complete=function(){console.log("ad complete")};com.funtomic.GameOps.KiziAPI_onAdStart(callback_start),com.funtomic.GameOps.KiziAPI_onAdComplete(callback_complete),loadPreAssets();